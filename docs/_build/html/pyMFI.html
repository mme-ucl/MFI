<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pyMFI package &mdash; pyMFI_docs 17/10/23 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="pyMFI_git" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            pyMFI_docs
              <img src="_static/MFI_transparent.gif" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">pyMFI_git</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">pyMFI package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyMFI.MFI">pyMFI.MFI module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyMFI.MFI1D">pyMFI.MFI1D module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyMFI.run_plumed">pyMFI.run_plumed module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pymfi-mfi-functions-module">pyMFI.MFI_functions module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyMFI">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyMFI_docs</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">pyMFI_git</a></li>
      <li class="breadcrumb-item active">pyMFI package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/pyMFI.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pymfi-package">
<h1>pyMFI package<a class="headerlink" href="#pymfi-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-pyMFI.MFI">
<span id="pymfi-mfi-module"></span><h2>pyMFI.MFI module<a class="headerlink" href="#module-pyMFI.MFI" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.FFT_intg_2D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">FFT_intg_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">FX</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([-</span> <span class="pre">3.14159265,</span> <span class="pre">-</span> <span class="pre">3.14159265])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([3.14159265,</span> <span class="pre">3.14159265])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0,</span> <span class="pre">0])</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.FFT_intg_2D" title="Permalink to this definition"></a></dt>
<dd><p>2D integration of force gradient (FX, FY) to find FES using Fast Fourier Transform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>FX</strong> (<em>array of size</em><em> (</em><em>nbins</em><em>[</em><em>1</em><em>]</em><em>, </em><em>nbins</em><em>[</em><em>0</em><em>]</em><em>)</em>) – CV1 component of the Mean Force.</p></li>
<li><p><strong>FY</strong> (<em>array of size</em><em> (</em><em>nbins</em><em>[</em><em>1</em><em>]</em><em>, </em><em>nbins</em><em>[</em><em>0</em><em>]</em><em>)</em>) – CV1 component of the Mean Force.</p></li>
<li><p><strong>min_grid</strong> (<em>array</em><em>, </em><em>optional</em>) – Lower bound of the simulation domain. Defaults to np.array((-np.pi, -np.pi)).</p></li>
<li><p><strong>min_grid</strong> – Upper bound of the simulation domain. Defaults to np.array((np.pi, np.pi)).</p></li>
<li><p><strong>periodic</strong> (<em>list</em><em> or </em><em>array of shape</em><em> (</em><em>2</em><em>,</em><em>)</em><em>)</em>) – Specifies if system is periodic. First entry sepcifies if CV1 is periodic. Second entry sepcifies if CV2 is periodic. value of 0 corresponds to non-periodic CV1. Value of 1 corresponds to periodic CV1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>[X, Y, fes]</p>
<p>X (array of size (nbins[1], nbins[0])): CV1 grid positions</p>
<p>Y (array of size (nbins[1], nbins[0])): CV2 grid positions</p>
<p>fes (array of size (nbins[1], nbins[0])): Free Energy Surface</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.MFI_2D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">MFI_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">HILLS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'HILLS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'position_x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'position_y'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.1,</span> <span class="pre">0.1])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kT</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([-</span> <span class="pre">3.14159265,</span> <span class="pre">-</span> <span class="pre">3.14159265])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([3.14159265,</span> <span class="pre">3.14159265])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([200,</span> <span class="pre">200])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_terms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_corners</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">WellTempered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nhills</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0,</span> <span class="pre">0])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_den_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_den_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_exploration_penalty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_weighted_st_dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_centre_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_centre_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_centre_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_centre_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_centre_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_centre_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F_static_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F_static_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_fes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.]])</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.MFI_2D" title="Permalink to this definition"></a></dt>
<dd><p>Compute a time-independent estimate of the Mean Thermodynamic Force, i.e. the free energy gradient in 2D CV spaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>HILLS</strong> (<em>array</em>) – HILLS array. The colums have format: [time [ps], position_x [nm], position_y [nm], MetaD_sigma_x [nm], MetaD_sigma_y [nm], MetaD_height [nm], MetaD_biasfactor]</p></li>
<li><p><strong>position_x</strong> (<em>array</em>) – CV1 array. Defaults to “position_x”.</p></li>
<li><p><strong>position_y</strong> (<em>array</em>) – CV2 array. Defaults to “position_y”.</p></li>
<li><p><strong>bw</strong> (<em>list</em><em> or </em><em>array of shape</em><em> (</em><em>2</em><em>,</em><em>)</em><em>, </em><em>optional</em>) – Scalar, bandwidth for the construction of the KDE estimate of the biased probability density. First entry is the bandwidth for CV1 and second entry is the bandwidth for CV2. Defaults to np.array((0.1,0.1)).</p></li>
<li><p><strong>kT</strong> (<em>float</em><em>, </em><em>optional</em>) – Boltzmann constant multiplied with temperature (reduced format, 120K -&gt; 1).</p></li>
<li><p><strong>min_grid</strong> (<em>array</em><em>, </em><em>optional</em>) – Lower bound of the force domain. Defaults to np.array((-np.pi, -np.pi)).</p></li>
<li><p><strong>max_grid</strong> (<em>array</em><em>, </em><em>optional</em>) – Upper bound of the force domain. Defaults to np.array((np.pi, np.pi)).</p></li>
<li><p><strong>nbins</strong> (<em>array</em><em>, </em><em>optional</em>) – number of bins in CV1,CV2. First enrty is the number of bins in CV1 and the second entry is the number of bins in CV2! Defaults to np.array((200,200)).</p></li>
<li><p><strong>error_pace</strong> (<em>int</em><em>, </em><em>optional</em>) – Pace for the calculation of the on-the-fly measure of global convergence. Defaults to 1, change it to a higher value if FES_cutoff&gt;0 is used.</p></li>
<li><p><strong>base_terms</strong> (<em>int</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – When set to 0, inactive. When activated, “on the fly” variance is calculated as a patch to base (previous) simulation. To activate, put force terms of base simulation ([Ftot_den, Ftot_den2, Ftot_x, Ftot_y, ofv_x, ofv_y]). Defaults to 0.</p></li>
<li><p><strong>window_corners</strong> (<em>list</em><em>, </em><em>optional</em>) – When set to [], inactive. When activated, error is ALSO calculated for mean force in the window. To activate, put the min and max values of the window ([min_x, max_x, min_y, max_y]). Defaults to [].</p></li>
<li><p><strong>WellTempered</strong> (<em>binary</em><em>, </em><em>optional</em>) – Is the simulation well tempered? 1 for yes and 0 for no. Defaults to 1.</p></li>
<li><p><strong>nhills</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of HILLS to analyse, -1 for the entire HILLS array. Defaults to -1, i.e. the entire dataset.</p></li>
<li><p><strong>periodic</strong> (<em>list</em><em> or </em><em>array of shape</em><em> (</em><em>2</em><em>,</em><em>)</em><em>, </em><em>optional</em>) – Specifies if system is periodic. First entry sepcifies if CV1 is periodic. Second entry sepcifies if CV2 is periodic. value of 0 corresponds to non-periodic CV1. Value of 1 corresponds to periodic CV1. Defaults to np.array((0,0)).</p></li>
<li><p><strong>Ftot_den_limit</strong> (<em>float</em><em>, </em><em>optional</em>) – Truncation of the probability density for numerical reasons, to avaiod devisions by zero (or suare root of negative numbers). If the probability density (Ftot_den) of some CV region is lover than the Ftot_den_limit, it will be set to zero. Default is set to 1E-10.</p></li>
<li><p><strong>FES_cutoff</strong> (<em>float</em><em>, </em><em>optional</em>) – Cutoff applied to error calculation for FES values over the FES_cutoff. If the cutoff applies, the error will be set to zero, otherwise the error will stay the same. Defaults to 0. When FES_cutoff &lt;= 0, no cufoff is applied. Use with care, computing the fes in the loop renders the calculation slow.</p></li>
<li><p><strong>Ftot_den_cutoff</strong> (<em>float</em><em>, </em><em>optional</em>) – Cutoff applied to error calculation for probability density (Ftot_den) values below the Ftot_den_cutoff. If the cutoff applies, the error will be set to zero, otherwise the error will stay the same. Defaults to 0.1. When Ftot_den_cutoff &lt;= 0, no cufoff is applied.</p></li>
<li><p><strong>non_exploration_penalty</strong> (<em>float</em><em>, </em><em>optional</em>) – Turns zero-value error to the non_exploration_penalty value. This should be used in combination with the cutoff. If some part of CV space hasn’t been explored, or has a FES value that is irrelevanlty high, the cutoff will set the error of that region to zero. If the non_exploration_penalty is larger than zero, the error of that region will take the value of the non_exploration_penalty instead of zero. Default is set to 0.</p></li>
<li><p><strong>use_weighted_st_dev</strong> (<em>bool</em><em>, </em><em>optional</em>) – When set to True, the calculated error will be the weighted standard deviation ( var^0.5 ). When set to False, the calculated error will be the standard error ( (var/n_sample)^0.5 ). Defaults to True. (The standard devaition is expected to converge after enough time, while the standard error is expected to decrease as more datapoints are added.)</p></li>
<li><p><strong>hp_centre_x</strong> (<em>float</em><em>, </em><em>optional</em>) – CV1-position of harmonic potential. Defaults to 0.0.</p></li>
<li><p><strong>hp_centre_y</strong> (<em>float</em><em>, </em><em>optional</em>) – CV2-position of harmonic potential. Defaults to 0.0.</p></li>
<li><p><strong>hp_kappa_x</strong> (<em>int</em><em>, </em><em>optional</em>) – CV1-force_constant of harmonic potential. Defaults to 0.</p></li>
<li><p><strong>hp_kappa_y</strong> (<em>int</em><em>, </em><em>optional</em>) – CV2-force_constant of harmonic potential. Defaults to 0.</p></li>
<li><p><strong>lw_centre_x</strong> (<em>float</em><em>, </em><em>optional</em>) – CV1-position of lower wall potential. Defaults to 0.0.</p></li>
<li><p><strong>lw_centre_y</strong> (<em>float</em><em>, </em><em>optional</em>) – CV2-position of lower wall potential. Defaults to 0.0.</p></li>
<li><p><strong>lw_kappa_x</strong> (<em>int</em><em>, </em><em>optional</em>) – CV1-force_constant of lower wall potential. Defaults to 0.</p></li>
<li><p><strong>lw_kappa_y</strong> (<em>int</em><em>, </em><em>optional</em>) – CV2-force_constant of lower wall potential. Defaults to 0.</p></li>
<li><p><strong>uw_centre_x</strong> (<em>float</em><em>, </em><em>optional</em>) – CV1-position of upper wall potential. Defaults to 0.0.</p></li>
<li><p><strong>uw_centre_y</strong> (<em>float</em><em>, </em><em>optional</em>) – CV2-position of upper wall potential. Defaults to 0.0.</p></li>
<li><p><strong>uw_kappa_x</strong> (<em>int</em><em>, </em><em>optional</em>) – CV1-force_constant of upper wall potential. Defaults to 0.</p></li>
<li><p><strong>uw_kappa_y</strong> (<em>int</em><em>, </em><em>optional</em>) – CV2-force_constant of upper wall potential. Defaults to 0.</p></li>
<li><p><strong>F_static</strong> (<em>array</em><em>, </em><em>optional</em>) – Option to provide a starting bias potential that remains constant through the algorithm. This could be a harmonic potential, an previously used MetaD potential or any other bias potential defined on the grid. Defaults to np.zeros((1,1)), which will automatically set F_static to a zero-array with shape=nbins.</p></li>
<li><p><strong>compare_to_reference_FES</strong> (<em>int</em><em>, </em><em>optional</em>) – Do you wanto to compare with a reference FES (dev option). Defaults to 0.</p></li>
<li><p><strong>ref_fes</strong> (<em>array</em><em>, </em><em>optional</em>) – Reference FES (dev options). Defaults to an array of zeros.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>[X, Y, Ftot_den, Ftot_x, Ftot_y, ofv, ofe, cutoff, volume_history, ofe_history, time_history, Ftot_den2, ofv_num_x, ofv_num_y]</p>
<p>X (array of size (nbins[1], nbins[0])): CV1 grid positions</p>
<p>Y (array of size (nbins[1], nbins[0])): CV2 grid positions</p>
<p>Ftot_den (array of size (nbins[1], nbins[0])): Cumulative biased probability density, equivalent to an unbiased histogram of samples in CV space.</p>
<p>Ftot_x (array of size (nbins[1], nbins[0])): CV1 component of the Mean Force.</p>
<p>Ftot_y (array of size (nbins[1], nbins[0])): CV2 component of the Mean Force.</p>
<p>ofv (array of size (nbins[1], nbins[0])): on the fly variance estimate of the local convergence</p>
<p>ofe (array of size (nbins[1], nbins[0])): on the fly error estimate of the local convergence</p>
<p>cutoff (array of size (nbins[1], nbins[0])): Array of ones and zeros. By default array of only ones. When the FES or probablity density (Ftot_den) values are outside their respective cutoff, the corresponding cutoff value will be a zero.</p>
<p>volume_history (list of size (nbins[1], nbins[0])): List of scalars indicating the explored volume, as a percentage of the ones in the cutoff array.</p>
<p>ofe_history (list of size (total_number_of_hills/error_pace,)): Running estimate of the global convergence of the mean force by calculating the statistical error of the mean force. Error calculated and added to list with error_pace.</p>
<p>ofe_history_window (optional)(list of size (total_number_of_hills/error_pace)): running estimate of the ofe within the “window” (specified and activated by using the input window_corners).</p>
<p>time_history (list of size (total_number_of_hills/error_pace,)): time array of volume_history, ofe_history and ofe_history_window if applicable.</p>
<p>Ftot_den2 (array of size (nbins[1], nbins[0])): Cumulative squared biased probability density</p>
<p>ofv_x (array of size (nbins[1], nbins[0])): intermediate component in the calculation of the CV1 “on the fly variance” ( sum of: pb_t * dfds_x ** 2)</p>
<p>ofv_y (array of size (nbins[1], nbins[0])): intermediate component in the calculation of the CV2 “on the fly variance” ( sum of: pb_t * dfds_y ** 2)</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.bootstrap_2D_new">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">bootstrap_2D_new</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Yrow</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bootstrap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([-</span> <span class="pre">3,</span> <span class="pre">-</span> <span class="pre">3])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([3,</span> <span class="pre">3])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0,</span> <span class="pre">0])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_den_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_exploration_penalty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.bootstrap_2D_new" title="Permalink to this definition"></a></dt>
<dd><p>Algorithm to determine bootstrap error. Takes in a collection of force-terms and with each itteration, a random selection of force-terms will be used to calculate a FES. The average and st.dev of all FESes will be calculated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array of size</em><em> (</em><em>nbins</em><em>[</em><em>1</em><em>]</em><em>, </em><em>nbins</em><em>[</em><em>0</em><em>]</em><em>)</em>) – CV1 grid positions</p></li>
<li><p><strong>Y</strong> (<em>array of size</em><em> (</em><em>nbins</em><em>[</em><em>1</em><em>]</em><em>, </em><em>nbins</em><em>[</em><em>0</em><em>]</em><em>)</em>) – CV2 grid positions</p></li>
<li><p><strong>force_array</strong> (<em>list</em>) – collection of force terms (n * [Ftot_den, Ftot_x, Ftot_y])</p></li>
<li><p><strong>n_bootstrap</strong> (<em>int</em>) – bootstrap iterations</p></li>
<li><p><strong>min_grid</strong> (<em>array</em><em>, </em><em>optional</em>) – Lower bound of the force domain. Defaults to np.array((-np.pi, -np.pi)).</p></li>
<li><p><strong>max_grid</strong> (<em>array</em><em>, </em><em>optional</em>) – Upper bound of the force domain. Defaults to np.array((np.pi, np.pi)).</p></li>
<li><p><strong>periodic</strong> (<em>list</em><em> or </em><em>array of shape</em><em> (</em><em>2</em><em>,</em><em>)</em><em>)</em>) – Specifies if system is periodic. First entry sepcifies if CV1 is periodic. Second entry sepcifies if CV2 is periodic. value of 0 corresponds to non-periodic CV1. Value of 1 corresponds to periodic CV1.</p></li>
<li><p><strong>FES_cutoff</strong> (<em>float</em><em>, </em><em>optional</em>) – Cutoff applied to error calculation for FES values over the FES_cutoff. If the cutoff applies, the error will be set to zero, otherwise the error will stay the same. Defaults to 0. When FES_cutoff &lt;= 0, no cufoff is applied. Use with care, computing the fes in the loop renders the calculation slow.</p></li>
<li><p><strong>Ftot_den_cutoff</strong> (<em>float</em><em>, </em><em>optional</em>) – Cutoff applied to error calculation for probability density (Ftot_den) values below the Ftot_den_cutoff. If the cutoff applies, the error will be set to zero, otherwise the error will stay the same. Defaults to 0.1. When Ftot_den_cutoff &lt;= 0, no cufoff is applied.</p></li>
<li><p><strong>non_exploration_penalty</strong> (<em>float</em><em>, </em><em>optional</em>) – Turns zero-value error to the non_exploration_penalty value. This should be used in combination with the cutoff. If some part of CV space hasn’t been explored, or has a FES value that is irrelevanlty high, the cutoff will set the error of that region to zero. If the non_exploration_penalty is larger than zero, the error of that region will take the value of the non_exploration_penalty instead of zero. Default is set to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>[FES_avr, sd_fes, sd_fes_prog ]</p>
<p>FES_avr (array of size (nbins[1], nbins[0])): Average of all FESes generated.</p>
<p>sd_fes (array of size (nbins[1], nbins[0])): Map of standard deviation of all FESes generated.</p>
<p>sd_fes_prog (array of size (n_bootstrap,)): The standard deviation of all FESes generated after each itteration.</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.bootstrap_2D_to_1D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">bootstrap_2D_to_1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">force_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bootstrap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kT</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([-</span> <span class="pre">3,</span> <span class="pre">-</span> <span class="pre">3])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([3,</span> <span class="pre">3])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0,</span> <span class="pre">0])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_den_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_weighted_st_dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.bootstrap_2D_to_1D" title="Permalink to this definition"></a></dt>
<dd><p>Algorithm to determine bootstrap error in x-dimension and the error in y-dimension using force gradients defined in x-y-dimension. Takes in a collection of force-terms and with each itteration, a random selection of force-terms will be used to calculate a FES in both x- and y-dimension. The average and st.dev of all FESes will be calculated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>force_array</strong> (<em>list</em>) – collection of force terms (n * [Ftot_den, Ftot_x, Ftot_y])</p></li>
<li><p><strong>n_bootstrap</strong> (<em>int</em>) – bootstrap iterations</p></li>
<li><p><strong>kT</strong> (<em>float</em><em>, </em><em>optional</em>) – Temperature of the system.</p></li>
<li><p><strong>error_pace</strong> (<em>int</em><em>, </em><em>optional</em>) – Pace at which the error is calculated. Pace of 10 means that the error will be calculated every 10 iterations. Pace of -1 will calculate the error a total of 100 times. Default is set to 0.</p></li>
<li><p><strong>min_grid</strong> (<em>array</em><em>, </em><em>optional</em>) – Lower bound of the force domain. Defaults to np.array((-3, -3)).</p></li>
<li><p><strong>max_grid</strong> (<em>array</em><em>, </em><em>optional</em>) – Upper bound of the force domain. Defaults to np.array((3, 3)).</p></li>
<li><p><strong>periodic</strong> (<em>list</em><em> or </em><em>array of shape</em><em> (</em><em>2</em><em>,</em><em>)</em><em>)</em>) – Specifies if system is periodic. First entry sepcifies if CV1 is periodic. Second entry sepcifies if CV2 is periodic. value of 0 corresponds to non-periodic CV1. Value of 1 corresponds to periodic CV1.</p></li>
<li><p><strong>Ftot_den_cutoff</strong> (<em>float</em><em>, </em><em>optional</em>) – Cutoff applied to error calculation for probability density (Ftot_den) values below the Ftot_den_cutoff. If the cutoff applies, the error will be set to zero, otherwise the error will stay the same. Defaults to 0.1. When Ftot_den_cutoff &lt;= 0, no cufoff is applied.</p></li>
<li><p><strong>use_weighted_st_dev</strong> (<em>bool</em><em>, </em><em>optional</em>) – When set to True, the calculated error will be the weighted standard deviation ( var^0.5 ). When set to False, the calculated error will be the standard error ( (var/n_sample)^0.5 ). Defaults to True. (The standard devaition is expected to converge after enough time, while the standard error is expected to decrease as more datapoints are added.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>[FES_x_avr, error_x, sd_fes_x_prog, FES_y_avr, error_y, sd_fes_y_prog ]</p>
<p>FES_x_avr (array of size (nbins[1], nbins[0])): Average of all FESes generated in x-dimension.</p>
<p>error_x (array of size (nbins[1], nbins[0])): Map of standard deviation of all FESes generated in x-dimension.</p>
<p>sd_fes_x_prog (array of size (n_bootstrap,)): The standard deviation of all FESes generated in x-dimension after each itteration.</p>
<p>FES_y_avr (array of size (nbins[1], nbins[0])): Average of all FESes generated in y-dimension.</p>
<p>error_y (array of size (nbins[1], nbins[0])): Map of standard deviation of all FESes generated in y-dimension.</p>
<p>sd_fes_y_prog (array of size (n_bootstrap,)): The standard deviation of all FESes generated in y-dimension after each itteration.</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.coft">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">coft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">HILLS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'HILLS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'FES'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kT</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">WellTempered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_number_of_hills</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([-</span> <span class="pre">3.14159265,</span> <span class="pre">-</span> <span class="pre">3.14159265])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([3.14159265,</span> <span class="pre">3.14159265])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([200,</span> <span class="pre">200])</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.coft" title="Permalink to this definition"></a></dt>
<dd><p>Compute a time-independent estimate of the Mean Thermodynamic Force, i.e. the free energy gradient in 2D CV spaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>HILLS</strong> (<em>array</em>) – HILLS array. Defaults to “HILLS”.</p></li>
<li><p><strong>FES</strong> (<em>array of size</em><em> (</em><em>nbins</em><em>[</em><em>0</em><em>]</em><em>, </em><em>nbins</em><em>[</em><em>1</em><em>]</em><em>)</em>) – </p></li>
<li><p><strong>kT</strong> (<em>float</em><em>, </em><em>optional</em>) – Boltzmann constant multiplied with temperature (reduced format, 120K -&gt; 1).</p></li>
<li><p><strong>WellTempered</strong> (<em>binary</em><em>, </em><em>optional</em>) – Is the simulation well tempered? 1 or yes and 0 for no. Defaults to 1.</p></li>
<li><p><strong>total_number_of_hills</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of HILLS to analyse. Defaults to 100.</p></li>
<li><p><strong>min_grid</strong> (<em>array</em><em>, </em><em>optional</em>) – Lower bound of the force domain. Defaults to np.array((-np.pi, -np.pi)).</p></li>
<li><p><strong>max_grid</strong> (<em>array</em><em>, </em><em>optional</em>) – Upper bound of the force domain. Defaults to np.array((np.pi, np.pi)).</p></li>
<li><p><strong>nbins</strong> (<em>array</em><em>, </em><em>optional</em>) – number of bins in CV1,CV2. Defaults to np.array((200,200)).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>[c,Bias]</p>
<p>c (array of size (total_numer_of_hills,)): Ensemble average of the bias in the unperturbed ensemble, calculated after the deposition of each metadynamics hill.</p>
<p>Bias (array of size (nbins[0], nbins[1])): Metadynamics Bias reconstructed from HILLS data.</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.find_hp_force">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">find_hp_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hp_centre_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_centre_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.find_hp_force" title="Permalink to this definition"></a></dt>
<dd><p>Find 2D harmonic potential force.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hp_centre_x</strong> (<em>float</em>) – CV1-position of harmonic potential</p></li>
<li><p><strong>hp_centre_y</strong> (<em>float</em>) – CV2-position of harmonic potential</p></li>
<li><p><strong>hp_kappa_x</strong> (<em>float</em>) – CV1-force_constant of harmonic potential</p></li>
<li><p><strong>hp_kappa_y</strong> (<em>float</em>) – CV2-force_constant of harmonic potential</p></li>
<li><p><strong>X</strong> (<em>array</em>) – 2D array of CV1 grid positions</p></li>
<li><p><strong>Y</strong> (<em>array</em>) – 2D array of CV2 grid positions</p></li>
<li><p><strong>min_grid</strong> (<em>list</em>) – list of CV1-minimum value of grid and CV2-minimum value of grid</p></li>
<li><p><strong>max_grid</strong> (<em>list</em>) – list of CV1-maximum value of grid and CV2-maximum value of grid</p></li>
<li><p><strong>grid_space</strong> (<em>list</em>) – list of CV1-grid spacing and CV2-grid spacing</p></li>
<li><p><strong>periodic</strong> (<em>list</em><em> or </em><em>array of shape</em><em> (</em><em>2</em><em>,</em><em>)</em><em>)</em>) – Specifies if system is periodic. First entry sepcifies if CV1 is periodic. Second entry sepcifies if CV2 is periodic. value of 0 corresponds to non-periodic CV1. Value of 1 corresponds to periodic CV1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[F_harmonic_x, F_harmonic_y]
F_harmonic_x
F_harmonic_y</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.find_lw_force">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">find_lw_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lw_centre_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_centre_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.find_lw_force" title="Permalink to this definition"></a></dt>
<dd><p>Find lower half of 2D harmonic potential force equivalent to f = 2 * lw_kappa * (grid - lw_centre) for grid &lt; lw_centre and f = 0 otherwise. This can change for periodic cases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lw_centre_x</strong> (<em>float</em>) – CV1-position of lower wall potential</p></li>
<li><p><strong>lw_centre_y</strong> (<em>float</em>) – CV2-position of lower wall potential</p></li>
<li><p><strong>lw_kappa_x</strong> (<em>float</em>) – CV1-force_constant of lower wall potential</p></li>
<li><p><strong>lw_kappa_y</strong> (<em>float</em>) – CV2-force_constant of lower wall potential</p></li>
<li><p><strong>X</strong> (<em>array</em>) – 2D array of CV1 grid positions</p></li>
<li><p><strong>Y</strong> (<em>array</em>) – 2D array of CV2 grid positions</p></li>
<li><p><strong>min_grid</strong> (<em>list</em>) – list of CV1-minimum value of grid and CV2-minimum value of grid</p></li>
<li><p><strong>max_grid</strong> (<em>list</em>) – list of CV1-maximum value of grid and CV2-maximum value of grid</p></li>
<li><p><strong>grid_space</strong> (<em>list</em>) – list of CV1-grid spacing and CV2-grid spacing</p></li>
<li><p><strong>periodic</strong> (<em>list</em><em> or </em><em>array of shape</em><em> (</em><em>2</em><em>,</em><em>)</em><em>)</em>) – Specifies if system is periodic. First entry sepcifies if CV1 is periodic. Second entry sepcifies if CV2 is periodic. value of 0 corresponds to non-periodic CV1. Value of 1 corresponds to periodic CV1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[F_wall_x, F_wall_y]
F_wall_x
F_wall_y</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.find_periodic_point">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">find_periodic_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_coord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_coord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.find_periodic_point" title="Permalink to this definition"></a></dt>
<dd><p>Finds periodic copies of input coordinates. First checks if systems is periodic. If not, returns input coordinate array. Next, it checks if each coordinate is within the boundary range (grid min/max +/- grid_ext). If it is, periodic copies will be made on the other side of the CV-domain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_coord</strong> (<em>float</em>) – CV1-coordinate</p></li>
<li><p><strong>y_coord</strong> (<em>float</em>) – CV2-coordinate</p></li>
<li><p><strong>min_grid</strong> (<em>list</em>) – list of CV1-minimum value of grid and CV2-minimum value of grid</p></li>
<li><p><strong>max_grid</strong> (<em>list</em>) – list of CV1-maximum value of grid and CV2-maximum value of grid</p></li>
<li><p><strong>periodic</strong> (<em>list</em><em> or </em><em>array of shape</em><em> (</em><em>2</em><em>,</em><em>)</em>) – Specifies if system is periodic. First entry sepcifies if CV1 is periodic. Second entry sepcifies if CV2 is periodic. value of 0 corresponds to non-periodic CV1. Value of 1 corresponds to periodic CV1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of [x-coord, y-coord] pairs (i.e. [[x1,y1], [x2,y2], …, [xn,yn]])</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.find_uw_force">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">find_uw_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uw_centre_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_centre_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.find_uw_force" title="Permalink to this definition"></a></dt>
<dd><p>Find upper half of 2D harmonic potential force equivalent to f = 2 * uw_kappa * (grid - uw_centre) for grid &gt; uw_centre and f = 0 otherwise. This can change for periodic cases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lw_centre_x</strong> (<em>float</em>) – CV1-position of upper wall potential</p></li>
<li><p><strong>lw_centre_y</strong> (<em>float</em>) – CV2-position of upper wall potential</p></li>
<li><p><strong>lw_kappa_x</strong> (<em>float</em>) – CV1-force_constant of upper wall potential</p></li>
<li><p><strong>lw_kappa_y</strong> (<em>float</em>) – CV2-force_constant of upper wall potential</p></li>
<li><p><strong>X</strong> (<em>array</em>) – 2D array of CV1 grid positions</p></li>
<li><p><strong>Y</strong> (<em>array</em>) – 2D array of CV2 grid positions</p></li>
<li><p><strong>min_grid</strong> (<em>list</em>) – list of CV1-minimum value of grid and CV2-minimum value of grid</p></li>
<li><p><strong>max_grid</strong> (<em>list</em>) – list of CV1-maximum value of grid and CV2-maximum value of grid</p></li>
<li><p><strong>grid_space</strong> (<em>list</em>) – list of CV1-grid spacing and CV2-grid spacing</p></li>
<li><p><strong>periodic</strong> (<em>list</em><em> or </em><em>array of shape</em><em> (</em><em>2</em><em>,</em><em>)</em><em>)</em>) – Specifies if system is periodic. First entry sepcifies if CV1 is periodic. Second entry sepcifies if CV2 is periodic. value of 0 corresponds to non-periodic CV1. Value of 1 corresponds to periodic CV1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[F_wall_x, F_wall_y]
F_wall_x
F_wall_y</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.get_cutoff">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">get_cutoff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ftot_den</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_den_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FX</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FY</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.get_cutoff" title="Permalink to this definition"></a></dt>
<dd><p>Finds the cutoff array according to the specifications.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Ftot_den</strong> (<em>np.array</em><em>, </em><em>optional</em>) – If a probability density (Ftot_den) cutoff should be applied, this argument in necessary. Defaults to None.</p></li>
<li><p><strong>Ftot_den_cutoff</strong> (<em>float</em><em>, </em><em>optional</em>) – Specifies the cutoff limit of the probability density. When negative or zero, no probability density cutoff is applied. Defaults to -1.</p></li>
<li><p><strong>FX</strong> (<em>np.array</em><em>, </em><em>optional</em>) – Force gradient of X or CV1. If a free energy surface (FES) cutoff should be applied, this argument in necessary. Defaults to None.</p></li>
<li><p><strong>FY</strong> (<em>np.array</em><em>, </em><em>optional</em>) – Force gradient of Y or CV2. If a free energy surface (FES) cutoff should be applied, this argument in necessary. Defaults to None.</p></li>
<li><p><strong>FES_cutoff</strong> (<em>list</em><em> or </em><em>float</em><em>, </em><em>optional</em>) – Required list: [FES_cutoff_limit, min_grid, max_grid, periodic]. If list is not provided, FES_cutoff will not be applied. Defaults to -1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>cutoff array with the shape of FY. Elements that correspond to the probability density above the Ftot_den_cutoff or the FES below the FES_cutoff will be 1. Elements outside the cutoff will be 0.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.get_cutoff_1D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">get_cutoff_1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ftot_den</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_den_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">23</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.get_cutoff_1D" title="Permalink to this definition"></a></dt>
<dd><p>Finds the cutoff array according to the specifications.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Ftot_den</strong> (<em>np.array</em><em>, </em><em>optional</em>) – If a probability density (Ftot_den) cutoff should be applied, this argument in necessary. Defaults to None.</p></li>
<li><p><strong>Ftot_den_cutoff</strong> (<em>float</em><em>, </em><em>optional</em>) – Specifies the cutoff limit of the probability density. Values below the limit will be cut-off. Will only be applied if Ftot_den is provided. Defaults to 0.1.</p></li>
<li><p><strong>FES</strong> (<em>np.array</em><em>, </em><em>optional</em>) – free energy surfacee. If a free energy surface (FES) cutoff should be applied, this argument in necessary. Defaults to None.</p></li>
<li><p><strong>FES_cutoff</strong> (<em>float</em><em>, </em><em>optional</em>) – Specifies the cutoff limit of the FES. Values above the limit will be cut-off. Will only be applied if FES is provided. Defaults to 23.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>cutoff array with the shape of Ftot_den or FES. Elements that correspond to the probability density above the Ftot_den_cutoff or the FES below the FES_cutoff will be 1. Elements outside the cutoff will be 0.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.index">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_space</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.index" title="Permalink to this definition"></a></dt>
<dd><p>Finds (approximate) index of a position in a grid. Independent of CV-type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>position</strong> (<em>float</em>) – position of interest</p></li>
<li><p><strong>min_grid</strong> (<em>float</em>) – minimum value of grid</p></li>
<li><p><strong>grid_space</strong> (<em>float</em>) – grid spacing</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>index of position</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.intg_2D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">intg_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">FX</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([-</span> <span class="pre">3.14159265,</span> <span class="pre">-</span> <span class="pre">3.14159265])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([3.14159265,</span> <span class="pre">3.14159265])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([200,</span> <span class="pre">200])</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.intg_2D" title="Permalink to this definition"></a></dt>
<dd><p>2D integration of force gradient (FX, FY) to find FES using finite difference method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>FX</strong> (<em>array of size</em><em> (</em><em>nbins</em><em>[</em><em>1</em><em>]</em><em>, </em><em>nbins</em><em>[</em><em>0</em><em>]</em><em>)</em>) – CV1 component of the Mean Force.</p></li>
<li><p><strong>FY</strong> (<em>array of size</em><em> (</em><em>nbins</em><em>[</em><em>1</em><em>]</em><em>, </em><em>nbins</em><em>[</em><em>0</em><em>]</em><em>)</em>) – CV2 component of the Mean Force.</p></li>
<li><p><strong>min_grid</strong> (<em>array</em><em>, </em><em>optional</em>) – Lower bound of the simulation domain. Defaults to np.array((-np.pi, -np.pi)).</p></li>
<li><p><strong>min_grid</strong> – Upper bound of the simulation domain. Defaults to np.array((np.pi, np.pi)).</p></li>
<li><p><strong>nbins</strong> (<em>int</em><em>, </em><em>optional</em>) – number of bins in CV1,CV2. Defaults to np.array((200,200)).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>[X, Y, fes]</p>
<p>X (array of size (nbins[1], nbins[0])): CV1 grid positions</p>
<p>Y (array of size (nbins[1], nbins[0])): CV2 grid positions</p>
<p>fes (array of size (nbins[1], nbins[0])): Free Energy Surface</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.intgrad2">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">intgrad2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([-</span> <span class="pre">2,</span> <span class="pre">-</span> <span class="pre">2])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([2,</span> <span class="pre">2])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0,</span> <span class="pre">0])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intconst</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.intgrad2" title="Permalink to this definition"></a></dt>
<dd><p>This function uses the inverse of the gradient to reconstruct the free energy surface from the mean force components.
[John D’Errico (2022). Inverse (integrated) gradient (<a class="reference external" href="https://www.mathworks.com/matlabcentral/fileexchange/9734-inverse-integrated-gradient">https://www.mathworks.com/matlabcentral/fileexchange/9734-inverse-integrated-gradient</a>), MATLAB Central File Exchange. Retrieved May 17, 2022.]
[Translated from MatLab to Python by Francesco Serse (<a class="reference external" href="https://github.com/Fserse">https://github.com/Fserse</a>)]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fx</strong> (<em>array</em>) – (ny by nx) array. X-gradient to be integrated.</p></li>
<li><p><strong>fy</strong> (<em>array</em>) – (ny by nx) array. X-gradient to be integrated.</p></li>
<li><p><strong>nx</strong> (<em>integer</em>) – nuber of datapoints in x-direction. Default to 0: will copy the shape of the input gradient.</p></li>
<li><p><strong>ny</strong> (<em>integer</em>) – nuber of datapoints in y-direction. Default to 0: will copy the shape of the input gradient.</p></li>
<li><p><strong>intconst</strong> (<em>float</em>) – Minimum value of output FES</p></li>
<li><p><strong>periodic</strong> (<em>list</em><em> or </em><em>array of shape</em><em> (</em><em>2</em><em>,</em><em>)</em><em>)</em>) – Specifies if system is periodic. First entry sepcifies if CV1 is periodic. Second entry sepcifies if CV2 is periodic. value of 0 corresponds to non-periodic CV1. Value of 1 corresponds to periodic CV1.</p></li>
<li><p><strong>min_grid</strong> (<em>list/array of length=2</em>) – list/array of minimum value of [x-grid, y-grid]</p></li>
<li><p><strong>max_grid</strong> (<em>list/array of length=2</em>) – list/array of maximum value of [x-grid, y-grid]</p></li>
<li><p><strong>nbins</strong> (<em>list/array of length=2</em>) – list/array of number of data pointis of [x-grid, y-grid]. Default to 0: will copy the shape of the input gradient.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>[X, Y, fhat]</p>
<p>X (ny by nx array): X-component of meshgrid</p>
<p>Y (ny by nx array): Y-component of meshgrid</p>
<p>fhat (ny by nx array): integrated free energy surface</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.load_HILLS_2D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">load_HILLS_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hills_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'HILLS'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.load_HILLS_2D" title="Permalink to this definition"></a></dt>
<dd><p>Load 2-dimensional hills data (includes time, position_x, position_y, hills_parameters ).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>hills_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of hills file. Defaults to “HILLS”.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>hills data with length equal to the total number of hills. Information: [time [ps], position_x [nm], position_y [nm], MetaD_sigma_x [nm], MetaD_sigma_y [nm], MetaD_height [nm], MetaD_biasfactor]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.load_npy">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">load_npy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.load_npy" title="Permalink to this definition"></a></dt>
<dd><p>Loads np.array of a file with .npy format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<em>string</em>) – Name of file</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>object to be loaded. Must be a numpy array.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.load_pkl">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">load_pkl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.load_pkl" title="Permalink to this definition"></a></dt>
<dd><p>Loads list/array of a file with .pkl format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<em>string</em>) – Name of file</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>object to be loaded</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>any</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.load_position_2D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">load_position_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'position'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.load_position_2D" title="Permalink to this definition"></a></dt>
<dd><p>Load 2-dimensional position/trajectory data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>position_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of position file. Defaults to “position”.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[position_x, position_y]
position_x (np.array of shape (number_of_positions,)): position (or COLVAR) data of x-dimension (or CV1)
position_y (np.array of shape (number_of_positions,)): position (or COLVAR) data of y-dimension (or CV2)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.mean_force_variance">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">mean_force_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ftot_den</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_den2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ofv_num_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ofv_num_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_den_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_weighted_st_dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.mean_force_variance" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the variance of the mean force</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Ftot_den</strong> (<em>array of size</em><em> (</em><em>nbins</em><em>[</em><em>1</em><em>]</em><em>, </em><em>nbins</em><em>[</em><em>0</em><em>]</em><em>)</em>) – Cumulative biased probability density</p></li>
<li><p><strong>25Ftot_den2</strong> (<em>array of size</em><em> (</em><em>nbins</em><em>[</em><em>1</em><em>]</em><em>, </em><em>nbins</em><em>[</em><em>0</em><em>]</em><em>)</em>) – Cumulative squared biased probability density</p></li>
<li><p><strong>Ftot_x</strong> (<em>array of size</em><em> (</em><em>nbins</em><em>[</em><em>1</em><em>]</em><em>, </em><em>nbins</em><em>[</em><em>0</em><em>]</em><em>)</em>) – CV1 component of the Mean Force.</p></li>
<li><p><strong>Ftot_y</strong> (<em>array of size</em><em> (</em><em>nbins</em><em>[</em><em>1</em><em>]</em><em>, </em><em>nbins</em><em>[</em><em>0</em><em>]</em><em>)</em>) – CV2 component of the Mean Force.</p></li>
<li><p><strong>ofv_num_x</strong> (<em>array of size</em><em> (</em><em>nbins</em><em>[</em><em>1</em><em>]</em><em>, </em><em>nbins</em><em>[</em><em>0</em><em>]</em><em>)</em>) – intermediate component in the calculation of the CV1 “on the fly variance” ( sum of: pb_t * dfds_x ** 2)</p></li>
<li><p><strong>ofv_num_y</strong> (<em>array of size</em><em> (</em><em>nbins</em><em>[</em><em>1</em><em>]</em><em>, </em><em>nbins</em><em>[</em><em>0</em><em>]</em><em>)</em>) – intermediate component in the calculation of the CV2 “on the fly variance” ( sum of: pb_t * dfds_y ** 2)</p></li>
<li><p><strong>Ftot_den_limit</strong> (<em>scalar</em>) – threshold in the cumulative biased probability density where data is discarded. Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>[ofv, ofe]</p>
<p>ofv (array of size (nbins[1], nbins[0])): “on the fly variance”</p>
<p>ofe (array of size (nbins[1], nbins[0])): “on the fly error”</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.patch_2D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">patch_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">master_array</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.patch_2D" title="Permalink to this definition"></a></dt>
<dd><p>Takes in a collection of force terms and patches them togehter to return the patched force terms</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>master_array</strong> (<em>list</em>) – collection of force terms (n * [Ftot_den, Ftot_den2, Ftot_x, Ftot_y, ofv_x, ofv_y])</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>[FP, FP2, FX, FY, OFV_X, OFV_Y]</p>
<p>FP(array of size (nbins[1], nbins[0])): Patched probability density</p>
<p>FP2(array of size (nbins[1], nbins[0])): Patched (probability density squared)</p>
<p>FX(array of size (nbins[1], nbins[0])): Patched Froce gradient in x-direction (CV1 direction)</p>
<p>FY(array of size (nbins[1], nbins[0])): Patched Froce gradient in y-direction (CV2 direction)</p>
<blockquote>
<div><p>OFV_X (array of size (nbins[1], nbins[0])): “on the fly variance”-term for the calculation of the variance of the froce gradient in x-direction (CV1 direction)</p>
<p>OFV_Y (array of size (nbins[1], nbins[0])): “on the fly variance”-term for the calculation of the variance of the froce gradient in y-direction (CV2 direction)</p>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.patch_2D_simple">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">patch_2D_simple</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">master_array</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.patch_2D_simple" title="Permalink to this definition"></a></dt>
<dd><p>Takes in a collection of force and patches only the probability density and mean forces</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>master_array</strong> (<em>list</em>) – collection of force terms (n * [Ftot_den, Ftot_x, Ftot_y])</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>[FP, FP2, FX, FY, OFV_X, OFV_Y]</p>
<p>FP (array of size (nbins[1], nbins[0])): Patched probability density</p>
<p>FX (array of size (nbins[1], nbins[0])): Patched Froce gradient in x-direction (CV1 direction)</p>
<p>FY (array of size (nbins[1], nbins[0])): Patched Froce gradient in y-direction (CV2 direction)</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.patch_to_base_variance">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">patch_to_base_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">master0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">master</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_den_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_weighted_st_dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.patch_to_base_variance" title="Permalink to this definition"></a></dt>
<dd><p>Patches force terms of a base simulation (alaysed prior to current simulation) with current simulation to return patched “on the fly variance”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>master0</strong> (<em>list</em>) – Force terms of base simulation (alaysed prior to current simulation) [Ftot_den, Ftot_den2, Ftot_x, Ftot_y, ofv_num_x, ofv_num_y]</p></li>
<li><p><strong>master</strong> (<em>list</em>) – Force terms of current simulation [Ftot_den, Ftot_den2, Ftot_x, Ftot_y, ofv_num_x, ofv_num_y]</p></li>
<li><p><strong>Ftot_den_limit</strong> (<em>int</em>) – Truncates the probability density below Ftot_den_limit. Default set to 10**-10.</p></li>
<li><p><strong>use_weighted_st_dev</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>[PD_patch, FX_patch, FY_patch, OFV, OFE]</p>
<p>PD_patch (array of size (nbins[1], nbins[0])): Patched probability density</p>
<p>FX_patch (array of size (nbins[1], nbins[0])): Patched Froce gradient in x-direction (CV1 direction)</p>
<p>FY_patch (array of size (nbins[1], nbins[0])): Patched Froce gradient in y-direction (CV2 direction)</p>
<blockquote>
<div><p>OFV (array of size (nbins[1], nbins[0])): modulus of patched “on the fly variance”</p>
</div></blockquote>
<p>OFE(array of size (nbins[1], nbins[0])): modulus of patched “on the fly error”</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.plot_bootstrap">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">plot_bootstrap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sd_fes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sd_fes_prog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sd_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES_levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sd_levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.plot_bootstrap" title="Permalink to this definition"></a></dt>
<dd><p>Plots result of bootstrap analysis. 1. Average FES, 2. average varinace, 3. variance progression</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array of size</em><em> (</em><em>nbins</em><em>[</em><em>1</em><em>]</em><em>, </em><em>nbins</em><em>[</em><em>0</em><em>]</em><em>)</em>) – CV1 grid positions</p></li>
<li><p><strong>Y</strong> (<em>array of size</em><em> (</em><em>nbins</em><em>[</em><em>1</em><em>]</em><em>, </em><em>nbins</em><em>[</em><em>0</em><em>]</em><em>)</em>) – CV2 grid positions</p></li>
<li><p><strong>FES</strong> (<em>array of size</em><em> (</em><em>nbins</em><em>[</em><em>1</em><em>]</em><em>, </em><em>nbins</em><em>[</em><em>0</em><em>]</em><em>)</em>) – Free Energy Surface</p></li>
<li><p><strong>sd_fes</strong> (<em>array of size</em><em> (</em><em>nbins</em><em>[</em><em>1</em><em>]</em><em>, </em><em>nbins</em><em>[</em><em>0</em><em>]</em><em>)</em>) – Map of standard deviation of all FESes generated.</p></li>
<li><p><strong>sd_fes_prog</strong> (<em>list / np.array of size</em><em> (</em><em>bootstrap_iterations</em><em>,</em><em>)</em>) – Progression of the standard deviation (of all FESes generated after each bootstrap itteration).</p></li>
<li><p><strong>FES_lim</strong> (<em>int</em><em>, </em><em>optional</em>) – Upper energy limit of FES plot. Defaults to 11.</p></li>
<li><p><strong>sd_lim</strong> (<em>int</em><em>, </em><em>optional</em>) – Upper variance limit of variance plot. Defaults to 11.</p></li>
<li><p><strong>FES_levels</strong> (<em>int</em><em>, </em><em>optional</em>) – Amout of contour levels shown in FES plot. Default is set to None, in which case FES_levels = int(FES_lim + 1).</p></li>
<li><p><strong>ofe_levels</strong> (<em>int</em><em>, </em><em>optional</em>) – Amout of contour levels shown in standard deviation plot. Default is set to None, in which case FES_levels = int(FES_lim + 1).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.plot_bootstrap_2D_to_1D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">plot_bootstrap_2D_to_1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES_2D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.plot_bootstrap_2D_to_1D" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.plot_patch_2D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">plot_patch_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TOTAL_DENSITY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.plot_patch_2D" title="Permalink to this definition"></a></dt>
<dd><p>Plots 1. FES, 2. Cumulative biased probability density</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array of size</em><em> (</em><em>nbins</em><em>[</em><em>1</em><em>]</em><em>, </em><em>nbins</em><em>[</em><em>0</em><em>]</em><em>)</em>) – CV1 grid positions</p></li>
<li><p><strong>Y</strong> (<em>array of size</em><em> (</em><em>nbins</em><em>[</em><em>1</em><em>]</em><em>, </em><em>nbins</em><em>[</em><em>0</em><em>]</em><em>)</em>) – CV2 grid positions</p></li>
<li><p><strong>FES</strong> (<em>array of size</em><em> (</em><em>nbins</em><em>[</em><em>1</em><em>]</em><em>, </em><em>nbins</em><em>[</em><em>0</em><em>]</em><em>)</em>) – Free Energy Surface</p></li>
<li><p><strong>TOTAL_DENSITY</strong> (<em>array of size</em><em> (</em><em>nbins</em><em>[</em><em>1</em><em>]</em><em>, </em><em>nbins</em><em>[</em><em>0</em><em>]</em><em>)</em>) – Cumulative biased probability density</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.plot_recap_2D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">plot_recap_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TOTAL_DENSITY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CONVMAP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CONV_history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CONV_history_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ofe_map_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ofe_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.plot_recap_2D" title="Permalink to this definition"></a></dt>
<dd><p>Plots 1. FES, 2. varinace_map, 3. Cumulative biased probability density, 4. Convergece of variance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array of size</em><em> (</em><em>nbins</em><em>[</em><em>1</em><em>]</em><em>, </em><em>nbins</em><em>[</em><em>0</em><em>]</em><em>)</em>) – CV1 grid positions</p></li>
<li><p><strong>Y</strong> (<em>array of size</em><em> (</em><em>nbins</em><em>[</em><em>1</em><em>]</em><em>, </em><em>nbins</em><em>[</em><em>0</em><em>]</em><em>)</em>) – CV2 grid positions</p></li>
<li><p><strong>FES</strong> (<em>array of size</em><em> (</em><em>nbins</em><em>[</em><em>1</em><em>]</em><em>, </em><em>nbins</em><em>[</em><em>0</em><em>]</em><em>)</em>) – Free Energy Surface</p></li>
<li><p><strong>TOTAL_DENSITY</strong> (<em>array of size</em><em> (</em><em>nbins</em><em>[</em><em>1</em><em>]</em><em>, </em><em>nbins</em><em>[</em><em>0</em><em>]</em><em>)</em>) – Cumulative biased probability density</p></li>
<li><p><strong>CONVMAP</strong> (<em>array of size</em><em> (</em><em>nbins</em><em>[</em><em>1</em><em>]</em><em>, </em><em>nbins</em><em>[</em><em>0</em><em>]</em><em>)</em>) – varinace_map</p></li>
<li><p><strong>CONV_history</strong> (<em>list</em>) – Convergece of variance</p></li>
<li><p><strong>CONV_history_time</strong> (<em>list</em>) – Simulation time corresponding to CONV_history</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.print_progress">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">print_progress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iteration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bar_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'progress</span> <span class="pre">variable'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.print_progress" title="Permalink to this definition"></a></dt>
<dd><p>Function to show a progress bar, that fills up as the iteration number reaches the total. Prints a variable at the end of the progress bar, that can be continiously updated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iteration</strong> (<em>int</em>) – Currrent iteration</p></li>
<li><p><strong>total</strong> (<em>int</em>) – Total iterations</p></li>
<li><p><strong>bar_length</strong> (<em>int</em><em>, </em><em>optional</em>) – Length of the progress bar. Defaults to 50.</p></li>
<li><p><strong>variable_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of variable that is being shown at the end of the progress bar. Defaults to ‘progress variable’.</p></li>
<li><p><strong>variable</strong> (<em>float</em><em>, </em><em>optional</em>) – Variable that is being shown at the end of the progress bar. Defaults to 0.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.reduce_to_window">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">reduce_to_window</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.reduce_to_window" title="Permalink to this definition"></a></dt>
<dd><p>Reduces an 2D input array to a specified range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_array</strong> (<em>array</em>) – 2D array to be reduced</p></li>
<li><p><strong>min_grid</strong> (<em>list</em>) – list of CV1-minimum value of grid and CV2-minimum value of grid</p></li>
<li><p><strong>grid_space</strong> (<em>list</em>) – list of CV1-grid spacing and CV2-grid spacing</p></li>
<li><p><strong>x_min</strong> (<em>float</em><em>, </em><em>optional</em>) – lower CV1-value of output array. Defaults to -0.5.</p></li>
<li><p><strong>x_max</strong> (<em>float</em><em>, </em><em>optional</em>) – upper CV1-value of output array. Defaults to 0.5.</p></li>
<li><p><strong>y_min</strong> (<em>float</em><em>, </em><em>optional</em>) – lower CV2-value of output array. Defaults to -1.5.</p></li>
<li><p><strong>y_max</strong> (<em>float</em><em>, </em><em>optional</em>) – upper CV2-value of output array. Defaults to 1.5.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>reduced array</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.save_npy">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">save_npy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.save_npy" title="Permalink to this definition"></a></dt>
<dd><p>Saves np.array in a file with .npy format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>object</strong> (<em>np.array</em>) – object to be saved. Must be a numpy array.</p></li>
<li><p><strong>file_name</strong> (<em>string</em>) – Name of file</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.save_pkl">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">save_pkl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.save_pkl" title="Permalink to this definition"></a></dt>
<dd><p>Saves a list/array in a file with .pkl format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>object</strong> (<em>any</em>) – object to be saved</p></li>
<li><p><strong>file_name</strong> (<em>string</em>) – Name of file</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.zero_to_nan">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">zero_to_nan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_array</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.zero_to_nan" title="Permalink to this definition"></a></dt>
<dd><p>Function to turn all zero-elements to np.nan. Works for any shapes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_array</strong> (<em>array of arbitrary shape</em>) – non specific array</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>input array with zero-elements turned to np.nan</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyMFI.MFI1D">
<span id="pymfi-mfi1d-module"></span><h2>pyMFI.MFI1D module<a class="headerlink" href="#module-pyMFI.MFI1D" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.MFI_1D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">MFI_1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">HILLS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kT</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">201</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">WellTempered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nhills</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_centre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_centre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_centre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F_static</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_den_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_den_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_exploration_penalty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_intermediate_fes_error_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_weighted_st_dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.MFI_1D" title="Permalink to this definition"></a></dt>
<dd><p>Compute a time-independent estimate of the Mean Thermodynamic Force, i.e. the free energy gradient in 1D CV spaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>HILLS</strong> (<em>array</em>) – HILLS array from HILLS file from metadynamics simulation using PLUMED. Contains number_of_hills * [time, position, metaD_width, metaD_height metaD_biasfactor].</p></li>
<li><p><strong>position</strong> (<em>str</em>) – CV/position array. Defaults to “position”.</p></li>
<li><p><strong>bw</strong> (<em>float</em><em>, </em><em>optional</em>) – bandwidth for the construction of the KDE estimate of the biased probability density. Defaults to 1.</p></li>
<li><p><strong>kT</strong> (<em>float</em><em>, </em><em>optional</em>) – Boltzmann constant multiplied with temperature (reduced format, 120K -&gt; 1).</p></li>
<li><p><strong>min_grid</strong> (<em>float</em><em>, </em><em>optional</em>) – Lower bound of the force domain. Defaults to -2.</p></li>
<li><p><strong>max_grid</strong> (<em>float</em><em>, </em><em>optional</em>) – Upper bound of the force domain. Defaults to 2.</p></li>
<li><p><strong>nbins</strong> (<em>int</em><em>, </em><em>optional</em>) – number of bins in grid. Defaults to 101.</p></li>
<li><p><strong>log_pace</strong> (<em>int</em><em>, </em><em>optional</em>) – Pace for outputting progress and convergence. Defaults to -1. When set to -1, progress will be outputted 5 times in total.</p></li>
<li><p><strong>error_pace</strong> (<em>int</em><em>, </em><em>optional</em>) – Pace for calculating the on-the-fly error for  estimating global convergence. Defaults to -1. When set to -1, on-the-fly error will be calculated 50 times.</p></li>
<li><p><strong>WellTempered</strong> (<em>binary</em><em>, </em><em>optional</em>) – Is the simulation well tempered?. Defaults to 1.</p></li>
<li><p><strong>nhills</strong> (<em>binary</em><em>, </em><em>optional</em>) – Number of HILLS to be analysed. When set to -1, all HILLS will be analysed. Defaults to -1.</p></li>
<li><p><strong>periodic</strong> (<em>binary</em><em>, </em><em>optional</em>) – Is the CV space periodic? 1 for yes. Defaults to 0.</p></li>
<li><p><strong>hp_centre</strong> (<em>float</em><em>, </em><em>optional</em>) – position of harmonic potential. Defaults to 0.0.</p></li>
<li><p><strong>hp_kappa</strong> (<em>flaot</em><em>, </em><em>optional</em>) – force_constant of harmonic potential. Defaults to 0.</p></li>
<li><p><strong>lw_centre</strong> (<em>float</em><em>, </em><em>optional</em>) – position of lower wall potential. Defaults to 0.0.</p></li>
<li><p><strong>lw_kappa</strong> (<em>flaot</em><em>, </em><em>optional</em>) – force_constant of lower wall potential. Defaults to 0.</p></li>
<li><p><strong>uw_centre</strong> (<em>float</em><em>, </em><em>optional</em>) – position of upper wall potential. Defaults to 0.0.</p></li>
<li><p><strong>uw_kappa</strong> (<em>flaot</em><em>, </em><em>optional</em>) – force_constant of upper wall potential. Defaults to 0.</p></li>
<li><p><strong>F_static</strong> (<em>array</em><em>, </em><em>optional</em>) – Option to provide a starting bias potential that remains constant through the algorithm. This could be a harmonic potential, an previously used MetaD potential or any other bias potential defined on the grid. Defaults to np.zeros(1), which will automatically set F_static to a zero-array with length=nbins.</p></li>
<li><p><strong>Ftot_den_limit</strong> (<em>float</em><em>, </em><em>optional</em>) – Probability density limit below which data will be set to zero (this is done for numerical stability reasons. For default Ftot_den_limit, numerical difference is negligable). Defaults to 1E-10.</p></li>
<li><p><strong>FES_cutoff</strong> (<em>float</em><em>, </em><em>optional</em>) – Cutoff applied to FES and error calculation for FES values over the FES_cutoff. All FES values above the FES_cutoff won’t contribuite towards the error. Useful when high FES values have no physical meaning. When FES_cutoff = 0, no cufoff is applied.Defaults to 0.</p></li>
<li><p><strong>Ftot_den_cutoff</strong> (<em>flaot</em><em>, </em><em>optional</em>) – Cutoff applied to FES and error calculation for Ftot_den (Probability density) values below the Ftot_den_cutoff. All FES values that are excluded by the cutoff won’t contribuite towards the error. Useful when low Probability density values have little statistical significance or no physical meaning. When Ftot_den_cutoff = 0, no cufoff is applied. Defaults to 0.
non_exploration_penalty (float, optional): Turns zero-value error to the non_exploration_penalty value. This should be used in combination with the cutoff. If some part of CV space hasn’t been explored, or has a FES value that is irrelevanlty high, the cutoff will set the error of that region to zero. If the non_exploration_penalty is larger than zero, the error of that region will take the value of the non_exploration_penalty instead of zero. Default is set to 0.</p></li>
<li><p><strong>save_intermediate_fes_error_cutoff</strong> (<em>bool</em><em>, </em><em>optional</em>) – If Ture, every time the error is calculated, the FES, variance, standard deviation and cutoff will be saved. Defaults to False.</p></li>
<li><p><strong>use_weighted_st_dev</strong> (<em>bool</em><em>, </em><em>optional</em>) – When set to True, the calculated error will be the weighted standard deviation ( var^0.5 ). When set to False, the calculated error will be the standard error ( (var/n_sample)^0.5 ). Defaults to True. (The standard devaition is expected to converge after enough time, while the standard error is expected to decrease as more datapoints are added.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>grid, Ftot_den, Ftot_den2, Ftot, ofv_num, FES, ofv, ofe, cutoff, error_evol, fes_error_cutoff_evol</p>
<p>grid (array of size (nbins,)): CV-array.</p>
<p>Ftot_den (array of size (nbins,)): Cumulative biased probability density.</p>
<p>Ftot_den2 (array of size (nbins,): Cumulative (biased probability density squared). Used for error calculation.</p>
<p>Ftot (array of size (nbins,)): Local Mean Force. When integrated will be the FES.</p>
<p>ofv_num (array of size (nbins,)): Numerator of “on-the-fly” variance (ofv). Used for error calculation.</p>
<p>FES (array of size (nbins,)): Free Energy Surface</p>
<p>ofv (array of size (nbins,)): “on-the-fly” variance</p>
<p>ofe (array of size (nbins,)): “on-the-fly” estimate of the standard deviation of the mean force</p>
<p>cutoff (binary array of size (nbins,)): If FES_cutoff and/or Ftot_den_cutoff are specified, grid values outside the cufoff will be zero and grid values inside the cutoff will be one. If FES_cutoff and Ftot_den_cutoff not active, cutoff will be an array of ones.</p>
<p>error_evol (array of size (4, total_number_of_hills//error_pace)): Evolution of error. First array is the collection of the global (average) “on-the-fly” variance, second array is the collection of the global (average) “on-the-fly” standard deviation, third array is the percentage of values within the specified cutoff, and the fourth array are the simulation times of the latter former arrays.</p>
<p>fes_error_cutoff_evol (array of size (4, total_number_of_hills//error_pace, nbins)): First array is the collection of FES, second array is the collection of local “on-the-fly” variance, third array is the collection of local “on-the-fly” standard deviation, and the fourth is the collection of the cutoffs. The elements of the collections were calculated at the simulation times of the fourth array in error_evol.</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.bootstrap_1D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">bootstrap_1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bootstrap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_fes_minima</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.bootstrap_1D" title="Permalink to this definition"></a></dt>
<dd><p>Algorithm to determine bootstrap error</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid</strong> (<em>array of shape</em><em> (</em><em>nbins</em><em>,</em><em>)</em>) – CV grid positions</p></li>
<li><p><strong>force_array</strong> (<em>list</em>) – collection of force terms (n * [Ftot_den, Ftot]).</p></li>
<li><p><strong>n_bootstrap</strong> (<em>int</em>) – bootstrap iterations</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Average of all FES generated during the bootstrap algorithm.
sd_fes (array of shape (nbins,)): Standard deviation of all FES generated during the bootstrap algorithm.
sd_fes_prog (array of shape (n_bootstrap,)): Global average of the standard deviation after each bootstrap iteration. When this array converges, enough iterations have been performed. If it does not converge, move iterations are necessary.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>FES_avr (array of shape (nbins,))</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.bootstrap_forw_back">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">bootstrap_forw_back</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forward_force</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backward_force</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bootstrap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_fes_minima</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.bootstrap_forw_back" title="Permalink to this definition"></a></dt>
<dd><p>Algorithm to determine bootstrap error</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid</strong> (<em>array of shape</em><em> (</em><em>nbins</em><em>,</em><em>)</em>) – CV grid positions</p></li>
<li><p><strong>forward_force</strong> (<em>list</em>) – collection of force terms (n * [Ftot_den, Ftot]) from forward transition</p></li>
<li><p><strong>backward_force</strong> (<em>list</em>) – collection of force terms (n * [Ftot_den, Ftot]) from backward transition</p></li>
<li><p><strong>n_bootstrap</strong> (<em>int</em>) – bootstrap iterations</p></li>
<li><p><strong>set_fes_minima</strong> (<em>str</em><em>, </em><em>optional</em>) – USed to specify how to set the minima of the FES. When set to “first”, the first element of the fes will be set to 0, and the rest of the FES array will be shifted by the same amount. When set to None, the smalles element of the FES will be set to 0, and the rest of the FES array will be shifted by the same amount. Defauts is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>[FES_avr, sd_fes, sd_fes_prog]</p>
<p>FES_avr (array of shape (nbins,)): Average of all FES generated during the bootstrap algorithm.</p>
<p>sd_fes (array of shape (nbins,)): Standard deviation of all FES generated during the bootstrap algorithm.</p>
<p>sd_fes_prog (array of shape (n_bootstrap,)): Global average of the standard deviation after each bootstrap iteration. When this array converges, enough iterations have been performed. If it does not converge, move iterations are necessary.</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.find_hp_force">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">find_hp_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hp_centre</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.find_hp_force" title="Permalink to this definition"></a></dt>
<dd><p>Find 1D harmonic potential force equivalent to f = hp_kappa * (grid - hp_centre).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hp_centre</strong> (<em>float</em>) – position of harmonic potential</p></li>
<li><p><strong>hp_kappa</strong> (<em>float</em>) – force_constant of harmonic potential</p></li>
<li><p><strong>grid</strong> (<em>array</em>) – CV grid positions</p></li>
<li><p><strong>min_grid</strong> (<em>float</em>) – minimum value of grid</p></li>
<li><p><strong>max_grid</strong> (<em>float</em>) – maximum value of grid</p></li>
<li><p><strong>grid_space</strong> (<em>float</em>) – space between two consecutive grid values</p></li>
<li><p><strong>periodic</strong> (<em>binary</em>) – information if system is periodic. value of 0 corresponds to non-periodic system. Value of 1 corresponds to periodic system.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>harmonic force array</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.find_lw_force">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">find_lw_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lw_centre</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.find_lw_force" title="Permalink to this definition"></a></dt>
<dd><p>Find lower half of 1D harmonic potential force equivalent to f = 2 * lw_kappa * (grid - lw_centre) for grid &lt; lw_centre and f = 0 otherwise. This can change for periodic cases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lw_centre</strong> (<em>float</em>) – position of lower wall potential</p></li>
<li><p><strong>lw_kappa</strong> (<em>float</em>) – force_constant of lower wall potential</p></li>
<li><p><strong>grid</strong> (<em>array</em>) – CV grid positions</p></li>
<li><p><strong>min_grid</strong> (<em>float</em>) – minimum value of grid</p></li>
<li><p><strong>max_grid</strong> (<em>float</em>) – maximum value of grid</p></li>
<li><p><strong>grid_space</strong> (<em>float</em>) – space between two consecutive grid values</p></li>
<li><p><strong>periodic</strong> (<em>binary</em>) – information if system is periodic. value of 0 corresponds to non-periodic system. Value of 1 corresponds to periodic system.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>lower wall force array</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.find_periodic_point">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">find_periodic_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_coord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_ext</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.find_periodic_point" title="Permalink to this definition"></a></dt>
<dd><p>Finds periodic copies of input coordinates. First checks if systems is periodic. If not, returns input coordinate array. Next, it checks if each coordinate is within the boundary range (grid min/max +/- grid_ext). If it is, periodic copies will be made on the other side of the CV-domain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_coord</strong> (<em>float</em>) – CV-coordinate</p></li>
<li><p><strong>min_grid</strong> (<em>float</em>) – minimum value of grid</p></li>
<li><p><strong>max_grid</strong> (<em>float</em>) – maximum value of grid</p></li>
<li><p><strong>periodic</strong> (<em>binary</em>) – information if system is periodic. value of 0 corresponds to non-periodic system; function will only return input coordinates. Value of 1 corresponds to periodic system; function will return input coordinates with periodic copies.</p></li>
<li><p><strong>grid_ext</strong> (<em>float</em>) – how far outside the domain periodic copies are searched for. E.g. if the domain is from -2 to +2 and the grid ext(end) is set to 1, then periodic copies are only found for input_coordiante &lt; -2 + 1 or input_coordiante &gt; +2 - 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of input coord and if applicable periodic copies</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.find_periodic_point_numpy">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">find_periodic_point_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coord_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_ext</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.find_periodic_point_numpy" title="Permalink to this definition"></a></dt>
<dd><p>Finds periodic copies of input coordinates. First checks if systems is periodic. If not, returns input coordinate array. Next, it checks if each coordinate is within the boundary range (grid min/max +/- grid_ext). If it is, periodic copies will be made on the other side of the CV-domain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coord_array</strong> (<em>array</em>) – array of CV-coordinate s</p></li>
<li><p><strong>min_grid</strong> (<em>float</em>) – minimum value of grid</p></li>
<li><p><strong>max_grid</strong> (<em>float</em>) – maximum value of grid</p></li>
<li><p><strong>periodic</strong> (<em>binary</em>) – information if system is periodic. value of 0 corresponds to non-periodic system; function will only return input coordinates. Value of 1 corresponds to periodic system; function will return input coordinates with periodic copies.</p></li>
<li><p><strong>grid_ext</strong> (<em>float</em>) – how far outside the domain periodic copies are searched for. E.g. if the domain is from -2 to +2 and the grid ext(end) is set to 1, then periodic copies are only found for input_coordiante &lt; -2 + 1 or input_coordiante &gt; +2 - 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of input coord and if applicable periodic copies</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.find_uw_force">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">find_uw_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uw_centre</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.find_uw_force" title="Permalink to this definition"></a></dt>
<dd><p>Find upper half of 1D harmonic potential force equivalent to f = 2 * uw_kappa * (grid - uw_centre) for grid &gt; uw_centre and f = 0 otherwise. This can change for periodic cases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>uw_centre</strong> (<em>float</em>) – position of upper wall potential</p></li>
<li><p><strong>uw_kappa</strong> (<em>float</em>) – force_constant of upper wall potential</p></li>
<li><p><strong>grid</strong> (<em>_type_</em>) – CV grid positions</p></li>
<li><p><strong>min_grid</strong> (<em>float</em>) – minimum value of grid</p></li>
<li><p><strong>max_grid</strong> (<em>float</em>) – maximum value of grid</p></li>
<li><p><strong>grid_space</strong> (<em>float</em>) – space between two consecutive grid values</p></li>
<li><p><strong>periodic</strong> (<em>binary</em>) – information if system is periodic. value of 0 corresponds to non-periodic system. Value of 1 corresponds to periodic system.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>upper wall force array</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.get_cutoff_1D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">get_cutoff_1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ftot_den</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_den_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.get_cutoff_1D" title="Permalink to this definition"></a></dt>
<dd><p>Finds the cutoff array according to the specifications. If the “&#64;njit” is deactivated, use get_cutoff_1D_nonjit() instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Ftot_den</strong> (<em>np.array</em><em>, </em><em>optional</em>) – If a probability density (Ftot_den) cutoff should be applied, this argument in necessary. Defaults to None.</p></li>
<li><p><strong>Ftot_den_cutoff</strong> (<em>float</em><em>, </em><em>optional</em>) – Specifies the cutoff limit of the probability density. Values below the limit will be cut-off. Will only be applied if Ftot_den is provided. Defaults to 0.1.</p></li>
<li><p><strong>FES</strong> (<em>np.array</em><em>, </em><em>optional</em>) – free energy surfacee. If a free energy surface (FES) cutoff should be applied, this argument in necessary. Defaults to None.</p></li>
<li><p><strong>FES_cutoff</strong> (<em>float</em><em>, </em><em>optional</em>) – Specifies the cutoff limit of the FES. Values above the limit will be cut-off. Will only be applied if FES is provided. Defaults to 23.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>cutoff array with the shape of Ftot_den or FES. Elements that correspond to the probability density above the Ftot_den_cutoff or the FES below the FES_cutoff will be 1. Elements outside the cutoff will be 0.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.get_cutoff_1D_nonjit">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">get_cutoff_1D_nonjit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ftot_den</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_den_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">23</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.get_cutoff_1D_nonjit" title="Permalink to this definition"></a></dt>
<dd><p>Finds the cutoff array according to the specifications.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Ftot_den</strong> (<em>np.array</em><em>, </em><em>optional</em>) – If a probability density (Ftot_den) cutoff should be applied, this argument in necessary. Defaults to None.</p></li>
<li><p><strong>Ftot_den_cutoff</strong> (<em>float</em><em>, </em><em>optional</em>) – Specifies the cutoff limit of the probability density. Values below the limit will be cut-off. Will only be applied if Ftot_den is provided. Defaults to 0.1.</p></li>
<li><p><strong>FES</strong> (<em>np.array</em><em>, </em><em>optional</em>) – free energy surfacee. If a free energy surface (FES) cutoff should be applied, this argument in necessary. Defaults to None.</p></li>
<li><p><strong>FES_cutoff</strong> (<em>float</em><em>, </em><em>optional</em>) – Specifies the cutoff limit of the FES. Values above the limit will be cut-off. Will only be applied if FES is provided. Defaults to 23.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>cutoff array with the shape of Ftot_den or FES. Elements that correspond to the probability density above the Ftot_den_cutoff or the FES below the FES_cutoff will be 1. Elements outside the cutoff will be 0.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.index">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_space</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.index" title="Permalink to this definition"></a></dt>
<dd><p>Finds (approximate) index of a position in a grid. Independent of CV-type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>position</strong> (<em>float</em>) – position of interest</p></li>
<li><p><strong>min_grid</strong> (<em>float</em>) – minimum value of grid</p></li>
<li><p><strong>grid_space</strong> (<em>float</em>) – grid spacing</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>index of position</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.intg_1D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">intg_1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Force</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.intg_1D" title="Permalink to this definition"></a></dt>
<dd><p>Integration of 1D gradient using finite difference method (simpson’s method).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Force</strong> (<em>array</em>) – Mean force</p></li>
<li><p><strong>dx</strong> (<em>float</em>) – grid spacing (i.e. space between consecutive grid entries)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Free energy surface</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.load_HILLS">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">load_HILLS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hills_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'HILLS'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.load_HILLS" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Load 1-dimensional hills data (includes time, position_x, position_y, hills_parameters)</dt><dd><p>Adjustment 2 - Last hill is removed from output array, as no complete set of COLVAR data is available of that hill.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>hills_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of hills file. Defaults to “HILLS”.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Hills data with length equal to the total number of hills. Information: [time [ps], position [nm], MetaD_sigma [nm], MetaD_height [nm], MetaD_biasfactor]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.load_npy">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">load_npy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.load_npy" title="Permalink to this definition"></a></dt>
<dd><p>Loads np.array of a file with .npy format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<em>string</em>) – Name of file</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>object to be loaded. Must be a numpy array.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.load_pkl">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">load_pkl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.load_pkl" title="Permalink to this definition"></a></dt>
<dd><p>Loads list/array of a file with .pkl format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<em>string</em>) – Name of file</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>object to be loaded</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>any</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.load_position">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">load_position</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'position'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.load_position" title="Permalink to this definition"></a></dt>
<dd><p>Load 1-dimensional position (CV) data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>position_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of position file. Defaults to “position”.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>position data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.patch_forces">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">patch_forces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">force_vector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PD_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.patch_forces" title="Permalink to this definition"></a></dt>
<dd><p>Takes in a collection of force and probability density and patches them.
:param force_vector: collection of force terms (n * [Ftot_den, Ftot])
:type force_vector: list
:param PD_limit: Probability density limit below which data will be set to zero (this is done for numerical stability reasons. For default Ftot_den_limit, numerical difference is negligable). Defaults to 1E-10.
:type PD_limit: float, optional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p>[PD_patch, F_patch]</p>
<p>PD_patch (array): Patched probability density</p>
<p>F_patch (array): Patched mean force</p>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.patch_forces_ofe">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">patch_forces_ofe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">force_vector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PD_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_weighted_st_dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ofe_progression</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_den_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_exploration_penalty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.patch_forces_ofe" title="Permalink to this definition"></a></dt>
<dd><p>Takes in an array of force terms, patches them together and calculates the error. The force vector has to be in the format [Ftot_den, Ftot_den2, Ftot, ofv_num].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>force_vector</strong> (<em>array of shape</em><em> (</em><em>n</em><em>,</em><em>4</em><em>, </em><em>nbins</em><em>)</em>) – The force terms are tipically outputted from the MFI_1D functions. They should be in the format: [Ftot_den (Probability density), Ftot_den2, Ftot (Mean Force), ofv_num (numerator of on the fly variance)].</p></li>
<li><p><strong>PD_limit</strong> (<em>flaot</em><em>, </em><em>optional</em>) – Probability density values below the PD_limit will be approximated to be 0, to ensure the numerical stability of the algorithm. Defaults to 1E-10.</p></li>
<li><p><strong>ofe_non_exploration_penalty</strong> (<em>flaot</em><em>, </em><em>optional</em>) – On-the-fly error values that that are ouside of the PD_cutoff will have a error equal to the ofe_non_exploration_penalty. Absolute deviation values that that are ouside of the PD_cutoff will have a error equal to the ofe_non_exploration_penalty/10. Defaults to 100.</p></li>
<li><p><strong>use_weighted_st_dev</strong> (<em>bool</em><em>, </em><em>optional</em>) – When set to True, the calculated error will be the weighted standard deviation ( var^0.5 ). When set to False, the calculated error will be the standard error ( (var/n_sample)^0.5 ). Defaults to True. (The standard devaition is expected to converge after enough time, while the standard error is expected to decrease as more datapoints are added.).</p></li>
<li><p><strong>ofe_progression</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the error progression will be returned. If false, error progression will be an array will all elements being the final error. Default set to False.
Ftot_den_cutoff (float, optional): Specifies the cutoff limit of the probability density. Values below the limit will be cut-off. Will only be applied if Ftot_den_cutoff is larger than 0. Defaults to -1.
non_exploration_penalty (float, optional): Turns zero-value error to the non_exploration_penalty value. This should be used in combination with the cutoff. If some part of CV space hasn’t been explored, or has a FES value that is irrelevanlty high, the cutoff will set the error of that region to zero. If the non_exploration_penalty is larger than zero, the error of that region will take the value of the non_exploration_penalty instead of zero. Default is set to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>PD_patch, PD2_patch, F_patch, OFV_num_patch, OFE, Aofe_progression</p>
<p>PD_patch (array of size (nbins,)): Patched Probability density</p>
<p>PD2_patch (array of size (nbins,)): Patched (Probability density squared)</p>
<p>F_patch (array of size (nbins,)): Patched Mean Force</p>
<p>OFV_num_patch (array of size (nbins,)): Patched numerator of “on the fly” variance</p>
<p>OFE (array of size (nbins,)): On-the-fly error map. Statistical error of the mean force</p>
<p>Aofe_progression (float): List of average OFE. If ofe_progression=False, all values will be the last calcuated average OFE. If ofe_progression=True, the values correspond to the average OFE after each patch.</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.patch_forces_ofe_AD">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">patch_forces_ofe_AD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">force_vector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PD_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_weighted_st_dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_progression</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_den_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_exploration_penalty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_fes_minima</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.patch_forces_ofe_AD" title="Permalink to this definition"></a></dt>
<dd><p>Takes in an array of force terms, patches them together and calculates the error, FES and average deviation. The force vector has to be in the format [Ftot_den, Ftot_den2, Ftot, ofv_num].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>force_vector</strong> (<em>array of shape</em><em> (</em><em>n</em><em>,</em><em>4</em><em>, </em><em>nbins</em><em>)</em>) – The force terms are tipically outputted from the MFI_1D functions. They should be in the format: [Ftot_den (Probability density), Ftot_den2, Ftot (Mean Force), ofv_num (numerator of on the fly variance)].</p></li>
<li><p><strong>grid</strong> (<em>array of shape</em><em> (</em><em>nbins</em><em>, </em><em>)</em>) – Grid that CV-space is defined on.</p></li>
<li><p><strong>y</strong> (<em>array of shape</em><em> (</em><em>nbins</em><em>, </em><em>)</em>) – Reference surface that is used to calculate the absolute devaition.</p></li>
<li><p><strong>PD_limit</strong> (<em>flaot</em><em>, </em><em>optional</em>) – Probability density values below the PD_limit will be approximated to be 0, to ensure the numerical stability of the algorithm. Defaults to 1E-10.</p></li>
<li><p><strong>use_weighted_st_dev</strong> (<em>bool</em><em>, </em><em>optional</em>) – When set to True, the calculated error will be the weighted standard deviation ( var^0.5 ). When set to False, the calculated error will be the standard error ( (var/n_sample)^0.5 ). Defaults to True. (The standard devaition is expected to converge after enough time, while the standard error is expected to decrease as more datapoints are added.).</p></li>
<li><p><strong>error_progression</strong> (<em>bool</em><em>, </em><em>optional</em>) – When set to True, the error (AOFE, AAD, volume ratio) will be calculated after every patch. When set to False, all forces are patched and the error is calculated only at the end. Default set to True.
Ftot_den_cutoff (float, optional): Specifies the cutoff limit of the probability density. Values below the limit will be cut-off. Will only be applied if Ftot_den_cutoff is larger than 0. Defaults to -1.
FES_cutoff (float, optional): Specifies the cutoff limit of the FES. Values above the limit will be cut-off. Will only be applied if FES is provided. Defaults to 23.
non_exploration_penalty (float, optional): Turns zero-value error to the non_exploration_penalty value. This should be used in combination with the cutoff. If some part of CV space hasn’t been explored, or has a FES value that is irrelevanlty high, the cutoff will set the error of that region to zero. If the non_exploration_penalty is larger than zero, the error of that region will take the value of the non_exploration_penalty instead of zero. Default is set to 0.</p></li>
<li><p><strong>set_fes_minima</strong> (<em>str</em><em>, </em><em>optional</em>) – USed to specify how to set the minima of the FES. When set to “first”, the first element of the fes will be set to 0, and the rest of the FES array will be shifted by the same amount. When set to None, the smalles element of the FES will be set to 0, and the rest of the FES array will be shifted by the same amount. Defauts is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>PD_patch, PD2_patch, F_patch, OFV_num_patch, FES, AD, aad_progression, OFE, Aofe_progression, volume_progression</p>
<p>PD_patch (array of size (nbins,)): Patched Probability density</p>
<p>PD2_patch (array of size (nbins,)): Patched (Probability density squared)</p>
<p>F_patch (array of size (nbins,)): Patched Mean Force</p>
<p>OFV_num_patch (array of size (nbins,)): Patched numerator of “on the fly” variance</p>
<p>FES (array of size (nbins,)): Free Energy Surface from patched Mean Force</p>
<p>AD (array of size (nbins,)): Absulute Deviation from FES to reference surface</p>
<p>aad_progression (list): List of average AAD. If error_progression=False, all values will be the last calcuated average AAD. If error_progression=True, the values correspond to the average AAD after each patch.</p>
<p>OFE (array of size (nbins,)): On-the-fly error. Statistical error of the mean force</p>
<p>Aofe_progression (list): List of average OFE. If error_progression=False, all values will be the last calcuated average OFE. If error_progression=True, the values correspond to the average OFE after each patch.</p>
<p>volume_progression (list): List of average volume ratio (Percentage of the grid that is not cutoff, e.g. with PD&gt;0.1). If error_progression=False, all values will be the last calcuated average volume ratio. If error_progression=True, the values correspond to the average volume ratio after each patch.</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.plot_recap">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">plot_recap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_den</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ofe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ofe_history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ofe_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_log_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_axis_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'simulation</span> <span class="pre">time'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.plot_recap" title="Permalink to this definition"></a></dt>
<dd><p>Plot result of 1D MFI algorithm. 1. FES, 2. varinace_map, 3. Cumulative biased probability density, 4. Convergece of variance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array</em>) – gird</p></li>
<li><p><strong>FES</strong> (<em>array</em>) – Free energy surface</p></li>
<li><p><strong>Ftot_den</strong> (<em>array</em>) – _description_</p></li>
<li><p><strong>ofe</strong> (<em>array</em>) – Cumulative biased probability density</p></li>
<li><p><strong>ofe_history</strong> (<em>list</em>) – on the fly estimate of the local convergence</p></li>
<li><p><strong>time_history</strong> (<em>list</em>) – List of time or simulation number corresponding to error history.</p></li>
<li><p><strong>FES_lim</strong> (<em>int</em><em>, </em><em>optional</em>) – Upper energy value in FES plot. Defaults to 40.</p></li>
<li><p><strong>ofe_lim</strong> (<em>int</em><em>, </em><em>optional</em>) – Upper error value in FES plot. Defaults to 10.</p></li>
<li><p><strong>error_log_scale</strong> (<em>boolean</em><em>, </em><em>optional</em>) – Option to make error_conversion plot with a log scale. 1 for log scale. Defaults to 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.print_progress">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">print_progress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iteration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bar_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'progress</span> <span class="pre">variable'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.print_progress" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.save_npy">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">save_npy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.save_npy" title="Permalink to this definition"></a></dt>
<dd><p>Saves np.array in a file with .npy format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>object</strong> (<em>np.array</em>) – object to be saved. Must be a numpy array.</p></li>
<li><p><strong>file_name</strong> (<em>string</em>) – Name of file</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.save_pkl">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">save_pkl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.save_pkl" title="Permalink to this definition"></a></dt>
<dd><p>Saves a list/array in a file with .pkl format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>object</strong> (<em>any</em>) – object to be saved</p></li>
<li><p><strong>file_name</strong> (<em>string</em>) – Name of file</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.window_forces">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">window_forces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">periodic_positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic_hills</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_meta2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height_meta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bw2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_den_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.window_forces" title="Permalink to this definition"></a></dt>
<dd><p>Takes in two arrays of positions. The periodic_positions are collected from the COLVAR file during a period of constant bias and calculates the force component associated with the probability density. periodic_hills are also positions collected from the HILLS file and calculates the force component resulting from the metadynamics bias. In a periodic system, positions have periodic copies if applicable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>periodic_positions</strong> (<em>array of shape</em><em> (</em><em>n</em><em>,</em><em>)</em>) – This array contains the positions from the COLVAR file, that were collected during a period of constant bias. n is the number of positions including their periodic copies if applicable.</p></li>
<li><p><strong>periodic_hills</strong> (<em>array of shape</em><em> (</em><em>n</em><em>,</em><em>)</em>) – This array contains the position of the metadynamics hill (from the HILLS file), that was deposited at the beginning of the period of constant bias. If applicable the array also contains periodic copies.</p></li>
<li><p><strong>grid</strong> (<em>array of shape</em><em> (</em><em>nbins</em><em>,</em><em>)</em>) – CV-array.</p></li>
<li><p><strong>sigma_meta2</strong> (<em>float</em>) – width of metadynamics hill squared.</p></li>
<li><p><strong>height_meta</strong> (<em>float</em>) – height of metadynamics hill</p></li>
<li><p><strong>kT</strong> (<em>float</em>) – Temperature of the system.</p></li>
<li><p><strong>const</strong> (<em>float</em>) – constant factor used for the calculation of the kernel. This constant enables the patching of data with different values of bw and stride . const = (1 / (bw * np.sqrt(2 * np.pi) * stride))</p></li>
<li><p><strong>bw2</strong> (<em>float</em>) – width of kernel density estimation (for the probability density) squared.</p></li>
<li><p><strong>Ftot_den_limit</strong> (<em>float</em><em>, </em><em>optional</em>) – Probability density limit below which data will be set to zero (this is done for numerical stability reasons. For default Ftot_den_limit, numerical difference is negligable). Defaults to 1E-10.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>[pb_t, Fpbt, Fbias_window]</p>
<p>pb_t (array of shape (nbins,)): Probability density of window</p>
<p>Fpbt (array of shape (nbins,)): Force component associated with the probability density of the time-window.</p>
<p>Fbias_window (array of shape (nbins,)): Force component associated with the metadynamics hill deposited at the beginning of the time-window.</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.zero_to_nan">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">zero_to_nan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_array</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.zero_to_nan" title="Permalink to this definition"></a></dt>
<dd><p>Turns all zero elements of an array into numpy NaN (Not a Number)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_array</strong> (<em>array of size</em><em> (</em><em>x</em><em>,</em><em>)</em>) – Input array.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Input array with zero elements turned to Nan.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyMFI.run_plumed">
<span id="pymfi-run-plumed-module"></span><h2>pyMFI.run_plumed module<a class="headerlink" href="#module-pyMFI.run_plumed" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.run_plumed.find_alanine_dipeptide_input">
<span class="sig-prename descclassname"><span class="pre">pyMFI.run_plumed.</span></span><span class="sig-name descname"><span class="pre">find_alanine_dipeptide_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_position_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_position_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_extension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.run_plumed.find_alanine_dipeptide_input" title="Permalink to this definition"></a></dt>
<dd><p>Prepares the input file for a set of initial positions.
Requires traj_comp.xtc file or similar (trajecory file of a simulation that already explored specified initial positions).
1 step: Find structures that are +- 0.5nm away from intial position.
2 step: Randomly choose one of the structures.
3 step: Produce input file for alanine dipeptide simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_position_x</strong> (<em>float</em><em>, </em><em>optional</em>) – x-value of initial position of simulation. Defaults to 0.0.</p></li>
<li><p><strong>initial_position_y</strong> (<em>float</em><em>, </em><em>optional</em>) – y-value of initial position of simulation. Defaults to 0.0.</p></li>
<li><p><strong>file_extension</strong> (<em>str</em><em>, </em><em>optional</em>) – Adds an extension the the structure.gro and input.tpr file. E.g. file_extension=”_1” -&gt; structure_file=”structure_1.gro”. Defaults to “”.. Defaults to “”.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.run_plumed.make_external_bias_1D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.run_plumed.</span></span><span class="sig-name descname"><span class="pre">make_external_bias_1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_min_plumed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_max_plumed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins_plumed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name_extension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_array</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.run_plumed.make_external_bias_1D" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.run_plumed.run_2D_Invernizzi">
<span class="sig-prename descclassname"><span class="pre">pyMFI.run_plumed.</span></span><span class="sig-name descname"><span class="pre">run_2D_Invernizzi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simulation_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biasfactor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_position_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_position_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_centre_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_centre_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_centre_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_centre_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_centre_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_centre_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_extension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">external_bias_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.run_plumed.run_2D_Invernizzi" title="Permalink to this definition"></a></dt>
<dd><p>Function to run a langevin simulation (in 2D) on the Invernizzi potential. Analytical form is approx.: 1.35*x^4+1.90*x^3*y+3.93*x^2*y^2-6.44*x^2-1.90*x*y^3+5.59*x*y+1.33*x+1.35*y^4-5.56*y^2+0.90*y+18.56.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>simulation_steps</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of steps in simulation. Defaults to 100000.</p></li>
<li><p><strong>sigma</strong> (<em>float</em><em>, </em><em>optional</em>) – Gaussian width (sigma) in x-direction and y-direction of metadynamics bias. Defaults to 0.1.</p></li>
<li><p><strong>height</strong> (<em>float</em><em>, </em><em>optional</em>) – aussian height of metadynamics bias. Defaults to 0.5.</p></li>
<li><p><strong>biasfactor</strong> (<em>int</em><em>, </em><em>optional</em>) – Biasfactor of metadynamics bias. Defaults to 10.</p></li>
<li><p><strong>initial_position_x</strong> (<em>float</em><em>, </em><em>optional</em>) – x-value of initial position of simulation. Defaults to 0.0.</p></li>
<li><p><strong>initial_position_y</strong> (<em>float</em><em>, </em><em>optional</em>) – y-value of initial position of simulation. Defaults to 0.0.</p></li>
<li><p><strong>hp_centre_x</strong> (<em>float</em><em>, </em><em>optional</em>) – x-position of harmonic potential. Defaults to 0.0.</p></li>
<li><p><strong>hp_centre_y</strong> (<em>float</em><em>, </em><em>optional</em>) – y-position of harmonic potential. Defaults to 0.0.</p></li>
<li><p><strong>hp_kappa_x</strong> (<em>int</em><em>, </em><em>optional</em>) – x-force_constant of harmonic potential. Defaults to 0.</p></li>
<li><p><strong>hp_kappa_y</strong> (<em>int</em><em>, </em><em>optional</em>) – y-force_constant of harmonic potential. Defaults to 0.</p></li>
<li><p><strong>lw_centre_x</strong> (<em>float</em><em>, </em><em>optional</em>) – x-position of lower wall potential. Defaults to 0.0.</p></li>
<li><p><strong>lw_centre_y</strong> (<em>float</em><em>, </em><em>optional</em>) – y-position of lower wall potential. Defaults to 0.0.</p></li>
<li><p><strong>lw_kappa_x</strong> (<em>int</em><em>, </em><em>optional</em>) – x-force_constant of lower wall potential. Defaults to 0.</p></li>
<li><p><strong>lw_kappa_y</strong> (<em>int</em><em>, </em><em>optional</em>) – y-force_constant of lower wall potential. Defaults to 0.</p></li>
<li><p><strong>uw_centre_x</strong> (<em>float</em><em>, </em><em>optional</em>) – x-position of upper wall potential. Defaults to 0.0.</p></li>
<li><p><strong>uw_centre_y</strong> (<em>float</em><em>, </em><em>optional</em>) – y-position of upper wall potential. Defaults to 0.0.</p></li>
<li><p><strong>uw_kappa_x</strong> (<em>int</em><em>, </em><em>optional</em>) – x-force_constant of upper wall potential. Defaults to 0.</p></li>
<li><p><strong>uw_kappa_y</strong> (<em>int</em><em>, </em><em>optional</em>) – y-force_constant of upper wall potential. Defaults to 0.</p></li>
<li><p><strong>gaus_pace</strong> (<em>int</em><em>, </em><em>optional</em>) – Pace of deposition of metadynamics hills. Defaults to 500.</p></li>
<li><p><strong>position_pace</strong> (<em>int</em><em>, </em><em>optional</em>) – Pace of recording the CV in the position file. When position_pace=0, position_pace = gaus_pace/10. Defaults to 0.</p></li>
<li><p><strong>file_extension</strong> (<em>str</em><em>, </em><em>optional</em>) – Adds an extension the the position and HILLS file. E.g. file_extension=”_1” -&gt; position_file=”position_1”. Defaults to “”.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.run_plumed.run_alanine_dipeptide">
<span class="sig-prename descclassname"><span class="pre">pyMFI.run_plumed.</span></span><span class="sig-name descname"><span class="pre">run_alanine_dipeptide</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simulation_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.49</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_min_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-pi'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_max_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pi'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_min_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-pi'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_max_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pi'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_bin_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">201</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_bin_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">201</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_width_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_width_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biasfactor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_centre_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_centre_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_centre_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_centre_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_centre_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_centre_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_extension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.run_plumed.run_alanine_dipeptide" title="Permalink to this definition"></a></dt>
<dd><p>Function to run molecular simulation on alanine dipeptide. Requires a reference.pdb and input.tpr file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>simulation_steps</strong> (<em>int</em>) – Number of steps in simulation</p></li>
<li><p><strong>temperature</strong> (<em>float</em><em>, </em><em>optional</em>) – Temperature of simulation (units in kT). Defaults to 2.49.</p></li>
<li><p><strong>grid_min_x</strong> (<em>str</em><em>, </em><em>optional</em>) – phi-value of minimum value of grid where the bias is stored. Defaults to “-pi”.</p></li>
<li><p><strong>grid_max_x</strong> (<em>str</em><em>, </em><em>optional</em>) – phi-value of maximum value of grid where the bias is stored. Defaults to “pi”.</p></li>
<li><p><strong>grid_min_y</strong> (<em>str</em><em>, </em><em>optional</em>) – psi-value of minimum value of grid where the bias is stored. Defaults to “-pi”.</p></li>
<li><p><strong>grid_max_y</strong> (<em>str</em><em>, </em><em>optional</em>) – psi-value of maximum value of grid where the bias is stored. Defaults to “pi”.</p></li>
<li><p><strong>grid_bin_x</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of distinct bins in grid on phi-axis. Defaults to 201.</p></li>
<li><p><strong>grid_bin_y</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of distinct bins in grid on psi-axis. Defaults to 201.</p></li>
<li><p><strong>gaus_width_x</strong> (<em>float</em><em>, </em><em>optional</em>) – Gaussian width in phi-direction (sigma) of metadynamics bias. Defaults to 0.1.</p></li>
<li><p><strong>gaus_width_y</strong> (<em>float</em><em>, </em><em>optional</em>) – Gaussian width in psi-direction (sigma) of metadynamics bias. Defaults to 0.1.</p></li>
<li><p><strong>gaus_height</strong> (<em>int</em><em>, </em><em>optional</em>) – Gaussian height of metadynamics bias. Defaults to 1.</p></li>
<li><p><strong>biasfactor</strong> (<em>int</em><em>, </em><em>optional</em>) – Biasfactor of metadynamics bias. Defaults to 10.</p></li>
<li><p><strong>gaus_pace</strong> (<em>int</em><em>, </em><em>optional</em>) – Pace of deposition of metadynamics hills. Defaults to 100.</p></li>
<li><p><strong>position_pace</strong> (<em>int</em><em>, </em><em>optional</em>) – Pace of recording the CV in the position file. When position_pace=0, position_pace = gaus_pace/10. Defaults to 0.</p></li>
<li><p><strong>hp_centre_x</strong> (<em>float</em><em>, </em><em>optional</em>) – phi-position of harmonic potential. Defaults to 0.0.</p></li>
<li><p><strong>hp_centre_y</strong> (<em>float</em><em>, </em><em>optional</em>) – psi-position of harmonic potential. Defaults to 0.0.</p></li>
<li><p><strong>hp_kappa_x</strong> (<em>int</em><em>, </em><em>optional</em>) – phi-force_constant of harmonic potential. Defaults to 0.</p></li>
<li><p><strong>hp_kappa_y</strong> (<em>int</em><em>, </em><em>optional</em>) – psi-force_constant of harmonic potential. Defaults to 0.</p></li>
<li><p><strong>lw_centre_x</strong> (<em>float</em><em>, </em><em>optional</em>) – phi-position of lower wall potential. Defaults to 0.0.</p></li>
<li><p><strong>lw_centre_y</strong> (<em>float</em><em>, </em><em>optional</em>) – psi-position of lower wall potential. Defaults to 0.0.</p></li>
<li><p><strong>lw_kappa_x</strong> (<em>int</em><em>, </em><em>optional</em>) – phi-force_constant of lower wall potential. Defaults to 0.</p></li>
<li><p><strong>lw_kappa_y</strong> (<em>int</em><em>, </em><em>optional</em>) – psi-force_constant of lower wall potential. Defaults to 0.</p></li>
<li><p><strong>uw_centre_x</strong> (<em>float</em><em>, </em><em>optional</em>) – phi-position of upper wall potential. Defaults to 0.0.</p></li>
<li><p><strong>uw_centre_y</strong> (<em>float</em><em>, </em><em>optional</em>) – psi-position of upper wall potential. Defaults to 0.0.</p></li>
<li><p><strong>uw_kappa_x</strong> (<em>int</em><em>, </em><em>optional</em>) – phi-force_constant of upper wall potential. Defaults to 0.</p></li>
<li><p><strong>uw_kappa_y</strong> (<em>int</em><em>, </em><em>optional</em>) – psi-force_constant of upper wall potential. Defaults to 0.</p></li>
<li><p><strong>print_bias</strong> (<em>int</em><em>, </em><em>optional</em>) – When print_bias=1, the experienced bias potential and the bias force squared is printed every 100 steps in a file called “restraint”. Defaults to 0.</p></li>
<li><p><strong>file_extension</strong> (<em>str</em><em>, </em><em>optional</em>) – Adds an extension the the position and HILLS file. E.g. file_extension=”_1” -&gt; position_file=”position_1”. Defaults to “”.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.run_plumed.run_alanine_dipeptide_1D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.run_plumed.</span></span><span class="sig-name descname"><span class="pre">run_alanine_dipeptide_1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simulation_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tors_angle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'phi'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.49</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-pi'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pi'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_bin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">301</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biasfactor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_centre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_centre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_centre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_extension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.run_plumed.run_alanine_dipeptide_1D" title="Permalink to this definition"></a></dt>
<dd><p>Function to run molecular simulation on alanine dipeptide. Requires a reference.pdb and input.tpr file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>simulation_steps</strong> (<em>int</em>) – Number of steps in simulation</p></li>
<li><p><strong>temperature</strong> (<em>float</em><em>, </em><em>optional</em>) – Temperature of simulation (units in kT). Defaults to 2.49.</p></li>
<li><p><strong>grid_min_x</strong> (<em>str</em><em>, </em><em>optional</em>) – phi-value of minimum value of grid where the bias is stored. Defaults to “-pi”.</p></li>
<li><p><strong>grid_max_x</strong> (<em>str</em><em>, </em><em>optional</em>) – phi-value of maximum value of grid where the bias is stored. Defaults to “pi”.</p></li>
<li><p><strong>grid_min_y</strong> (<em>str</em><em>, </em><em>optional</em>) – psi-value of minimum value of grid where the bias is stored. Defaults to “-pi”.</p></li>
<li><p><strong>grid_max_y</strong> (<em>str</em><em>, </em><em>optional</em>) – psi-value of maximum value of grid where the bias is stored. Defaults to “pi”.</p></li>
<li><p><strong>grid_bin_x</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of distinct bins in grid on phi-axis. Defaults to 201.</p></li>
<li><p><strong>grid_bin_y</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of distinct bins in grid on psi-axis. Defaults to 201.</p></li>
<li><p><strong>gaus_width_x</strong> (<em>float</em><em>, </em><em>optional</em>) – Gaussian width in phi-direction (sigma) of metadynamics bias. Defaults to 0.1.</p></li>
<li><p><strong>gaus_width_y</strong> (<em>float</em><em>, </em><em>optional</em>) – Gaussian width in psi-direction (sigma) of metadynamics bias. Defaults to 0.1.</p></li>
<li><p><strong>gaus_height</strong> (<em>int</em><em>, </em><em>optional</em>) – Gaussian height of metadynamics bias. Defaults to 1.</p></li>
<li><p><strong>biasfactor</strong> (<em>int</em><em>, </em><em>optional</em>) – Biasfactor of metadynamics bias. Defaults to 10.</p></li>
<li><p><strong>gaus_pace</strong> (<em>int</em><em>, </em><em>optional</em>) – Pace of deposition of metadynamics hills. Defaults to 100.</p></li>
<li><p><strong>position_pace</strong> (<em>int</em><em>, </em><em>optional</em>) – Pace of recording the CV in the position file. When position_pace=0, position_pace = gaus_pace/10. Defaults to 0.</p></li>
<li><p><strong>hp_centre_x</strong> (<em>float</em><em>, </em><em>optional</em>) – phi-position of harmonic potential. Defaults to 0.0.</p></li>
<li><p><strong>hp_centre_y</strong> (<em>float</em><em>, </em><em>optional</em>) – psi-position of harmonic potential. Defaults to 0.0.</p></li>
<li><p><strong>hp_kappa_x</strong> (<em>int</em><em>, </em><em>optional</em>) – phi-force_constant of harmonic potential. Defaults to 0.</p></li>
<li><p><strong>hp_kappa_y</strong> (<em>int</em><em>, </em><em>optional</em>) – psi-force_constant of harmonic potential. Defaults to 0.</p></li>
<li><p><strong>lw_centre_x</strong> (<em>float</em><em>, </em><em>optional</em>) – phi-position of lower wall potential. Defaults to 0.0.</p></li>
<li><p><strong>lw_centre_y</strong> (<em>float</em><em>, </em><em>optional</em>) – psi-position of lower wall potential. Defaults to 0.0.</p></li>
<li><p><strong>lw_kappa_x</strong> (<em>int</em><em>, </em><em>optional</em>) – phi-force_constant of lower wall potential. Defaults to 0.</p></li>
<li><p><strong>lw_kappa_y</strong> (<em>int</em><em>, </em><em>optional</em>) – psi-force_constant of lower wall potential. Defaults to 0.</p></li>
<li><p><strong>uw_centre_x</strong> (<em>float</em><em>, </em><em>optional</em>) – phi-position of upper wall potential. Defaults to 0.0.</p></li>
<li><p><strong>uw_centre_y</strong> (<em>float</em><em>, </em><em>optional</em>) – psi-position of upper wall potential. Defaults to 0.0.</p></li>
<li><p><strong>uw_kappa_x</strong> (<em>int</em><em>, </em><em>optional</em>) – phi-force_constant of upper wall potential. Defaults to 0.</p></li>
<li><p><strong>uw_kappa_y</strong> (<em>int</em><em>, </em><em>optional</em>) – psi-force_constant of upper wall potential. Defaults to 0.</p></li>
<li><p><strong>print_bias</strong> (<em>int</em><em>, </em><em>optional</em>) – When print_bias=1, the experienced bias potential and the bias force squared is printed every 100 steps in a file called “restraint”. Defaults to 0.</p></li>
<li><p><strong>file_extension</strong> (<em>str</em><em>, </em><em>optional</em>) – Adds an extension the the position and HILLS file. E.g. file_extension=”_1” -&gt; position_file=”position_1”. Defaults to “”.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.run_plumed.run_langevin1D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.run_plumed.</span></span><span class="sig-name descname"><span class="pre">run_langevin1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simulation_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analytical_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'7*x^4-23*x^2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NO'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_bin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biasfactor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_centre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_centre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_centre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">external_bias_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_sim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.run_plumed.run_langevin1D" title="Permalink to this definition"></a></dt>
<dd><p>Function to run a langevin simulation in 1 dimension. Default analytical potential: y = 7*x^4-23*x^2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>simulation_steps</strong> (<em>int</em>) – Number of steps in simulation</p></li>
<li><p><strong>analytical_function</strong> (<em>str</em><em>, </em><em>optional</em>) – The analytical function to be analysed. Defaults to “7*x^4-23*x^2”.</p></li>
<li><p><strong>periodic</strong> (<em>str</em><em>, </em><em>optional</em>) – Information wheather boundary conditions are periodic (“ON”) or not (“NO”). Defaults to “NO”.</p></li>
<li><p><strong>initial_position</strong> (<em>float</em><em>, </em><em>optional</em>) – Initial position of simulation. Defaults to 0.0.</p></li>
<li><p><strong>temperature</strong> (<em>int</em><em>, </em><em>optional</em>) – Temperature of simulation (units in kT). Defaults to 1.</p></li>
<li><p><strong>time_step</strong> (<em>float</em><em>, </em><em>optional</em>) – Length of one time step (units in ps). Defaults to 0.005.</p></li>
<li><p><strong>grid_min</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimum value of grid where the bias is stored. Defaults to -3.0.</p></li>
<li><p><strong>grid_max</strong> (<em>float</em><em>, </em><em>optional</em>) – Maximum value of grid where the bias is stored. Defaults to 3.0.</p></li>
<li><p><strong>grid_bin</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of distinct bins in grid. Defaults to 200.</p></li>
<li><p><strong>gaus_width</strong> (<em>float</em><em>, </em><em>optional</em>) – Gaussian width (sigma) of metadynamics bias. Defaults to 0.1.</p></li>
<li><p><strong>gaus_height</strong> (<em>int</em><em>, </em><em>optional</em>) – Gaussian height of metadynamics bias. Defaults to 1.</p></li>
<li><p><strong>biasfactor</strong> (<em>int</em><em>, </em><em>optional</em>) – Biasfactor of metadynamics bias. Defaults to 10.</p></li>
<li><p><strong>gaus_pace</strong> (<em>int</em><em>, </em><em>optional</em>) – Pace of deposition of metadynamics hills. Defaults to 100.</p></li>
<li><p><strong>position_pace</strong> (<em>int</em><em>, </em><em>optional</em>) – Pace of recording the CV in the position file. When position_pace=0, position_pace = gaus_pace/10. Defaults to 0.</p></li>
<li><p><strong>hp_centre</strong> (<em>float</em><em>, </em><em>optional</em>) – position of harmonic potential. Defaults to 0.0.</p></li>
<li><p><strong>hp_kappa</strong> (<em>int</em><em>, </em><em>optional</em>) – force_constant of harmonic potential. Defaults to 0.</p></li>
<li><p><strong>lw_centre</strong> (<em>float</em><em>, </em><em>optional</em>) – position of lower wall potential. Defaults to 0.0.</p></li>
<li><p><strong>lw_kappa</strong> (<em>int</em><em>, </em><em>optional</em>) – force_constant of lower wall potential. Defaults to 0.</p></li>
<li><p><strong>uw_centre</strong> (<em>float</em><em>, </em><em>optional</em>) – position of upper wall potential. Defaults to 0.0.</p></li>
<li><p><strong>uw_kappa</strong> (<em>int</em><em>, </em><em>optional</em>) – force_constant of upper wall potential. Defaults to 0.</p></li>
<li><p><strong>external_bias_file</strong> (<em>str</em><em>, </em><em>optional</em>) – File name or file path of external bias. Default is “”, so no file will be loaded.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.run_plumed.run_langevin1D_plumed_fes">
<span class="sig-prename descclassname"><span class="pre">pyMFI.run_plumed.</span></span><span class="sig-name descname"><span class="pre">run_langevin1D_plumed_fes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simulation_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analytical_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'7*x^4-23*x^2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NO'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biasfactor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fes_stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_min_plumed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_max_plumed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_bin_plumed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">301</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_min_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_max_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_bin_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.run_plumed.run_langevin1D_plumed_fes" title="Permalink to this definition"></a></dt>
<dd><p>Function to run a langevin simulation in 1 dimension on analytical potential: y = 7*x^4-23*x^2, while also calculating the FES through plumed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>length</strong> (<em>int</em>) – Number of steps in simulation</p></li>
<li><p><strong>sigma</strong> (<em>float</em><em>, </em><em>optional</em>) – Gaussian width of metadynamics bias. Defaults to 0.1.</p></li>
<li><p><strong>height</strong> (<em>float</em><em>, </em><em>optional</em>) – Gaussian height of metadynamics bias. Defaults to 0.1.</p></li>
<li><p><strong>biasfactor</strong> (<em>int</em><em>, </em><em>optional</em>) – Biasfactor of metadynamics bias. Defaults to 10.</p></li>
<li><p><strong>fes_stride</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of times the intermediate fes is calculated. Defaults to 0.</p></li>
<li><p><strong>grid_min</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum value of grid where the bias is stored. Defaults to -3.</p></li>
<li><p><strong>grid_max</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum value of grid where the bias is stored. Defaults to 3.</p></li>
<li><p><strong>grid_bin</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of distinct bins in grid. Defaults to 301.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.run_plumed.run_langevin2D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.run_plumed.</span></span><span class="sig-name descname"><span class="pre">run_langevin2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simulation_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analytical_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'7*x^4-23*x^2+7*y^4-23*y^2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic_f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NO'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_position_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_position_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_min_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_max_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_min_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_max_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_bin_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_bin_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_width_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_width_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biasfactor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_centre_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_centre_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_centre_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_centre_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_centre_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_centre_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_extension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.run_plumed.run_langevin2D" title="Permalink to this definition"></a></dt>
<dd><p>Function to run a langevin simulation in 2 dimension. Default analytical potential: z = 7*x^4-23*x^2+7*y^4-23*y^2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>simulation_steps</strong> (<em>int</em>) – Number of steps in simulation</p></li>
<li><p><strong>analytical_function</strong> (<em>str</em><em>, </em><em>optional</em>) – The analytical function to be analysed. Defaults to “7*x^4-23*x^2+7*y^4-23*y^2”.</p></li>
<li><p><strong>periodic_f</strong> (<em>str</em><em>, </em><em>optional</em>) – Information wheather boundary conditions are periodic (“ON”) or not (“NO”). Defaults to “NO”.</p></li>
<li><p><strong>initial_position_x</strong> (<em>float</em><em>, </em><em>optional</em>) – x-value of initial position of simulation. Defaults to 0.0.</p></li>
<li><p><strong>initial_position_y</strong> (<em>float</em><em>, </em><em>optional</em>) – y-value of initial position of simulation. Defaults to 0.0.</p></li>
<li><p><strong>temperature</strong> (<em>int</em><em>, </em><em>optional</em>) – Temperature of simulation (units in kT). Defaults to 1.</p></li>
<li><p><strong>time_step</strong> (<em>float</em><em>, </em><em>optional</em>) – Length of one time step (units in ps). Defaults to 0.005.</p></li>
<li><p><strong>grid_min_x</strong> (<em>float</em><em>, </em><em>optional</em>) – x-value of minimum value of grid where the bias is stored. Defaults to -3.0.</p></li>
<li><p><strong>grid_max_x</strong> (<em>float</em><em>, </em><em>optional</em>) – x-value of maximum value of grid where the bias is stored. Defaults to 3.0.</p></li>
<li><p><strong>grid_min_y</strong> (<em>float</em><em>, </em><em>optional</em>) – y-value of minimum value of grid where the bias is stored. Defaults to -3.0.</p></li>
<li><p><strong>grid_max_y</strong> (<em>float</em><em>, </em><em>optional</em>) – y-value of maximum value of grid where the bias is stored. Defaults to 3.0.</p></li>
<li><p><strong>grid_bin_x</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of distinct bins in grid on x-axis. Defaults to 200.</p></li>
<li><p><strong>grid_bin_y</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of distinct bins in grid on y-axis. Defaults to 200.</p></li>
<li><p><strong>gaus_width_x</strong> (<em>float</em><em>, </em><em>optional</em>) – Gaussian width in x-direction (sigma) of metadynamics bias. Defaults to 0.1.</p></li>
<li><p><strong>gaus_width_y</strong> (<em>float</em><em>, </em><em>optional</em>) – Gaussian width in y-direction (sigma) of metadynamics bias. Defaults to 0.1.</p></li>
<li><p><strong>gaus_height</strong> (<em>int</em><em>, </em><em>optional</em>) – Gaussian height of metadynamics bias. Defaults to 1.</p></li>
<li><p><strong>biasfactor</strong> (<em>int</em><em>, </em><em>optional</em>) – Biasfactor of metadynamics bias. Defaults to 10.</p></li>
<li><p><strong>gaus_pace</strong> (<em>int</em><em>, </em><em>optional</em>) – Pace of deposition of metadynamics hills. Defaults to 100.</p></li>
<li><p><strong>hp_centre_x</strong> (<em>float</em><em>, </em><em>optional</em>) – x-position of harmonic potential. Defaults to 0.0.</p></li>
<li><p><strong>hp_centre_y</strong> (<em>float</em><em>, </em><em>optional</em>) – y-position of harmonic potential. Defaults to 0.0.</p></li>
<li><p><strong>hp_kappa_x</strong> (<em>int</em><em>, </em><em>optional</em>) – x-force_constant of harmonic potential. Defaults to 0.</p></li>
<li><p><strong>hp_kappa_y</strong> (<em>int</em><em>, </em><em>optional</em>) – y-force_constant of harmonic potential. Defaults to 0.</p></li>
<li><p><strong>lw_centre_x</strong> (<em>float</em><em>, </em><em>optional</em>) – x-position of lower wall potential. Defaults to 0.0.</p></li>
<li><p><strong>lw_centre_y</strong> (<em>float</em><em>, </em><em>optional</em>) – y-position of lower wall potential. Defaults to 0.0.</p></li>
<li><p><strong>lw_kappa_x</strong> (<em>int</em><em>, </em><em>optional</em>) – x-force_constant of lower wall potential. Defaults to 0.</p></li>
<li><p><strong>lw_kappa_y</strong> (<em>int</em><em>, </em><em>optional</em>) – y-force_constant of lower wall potential. Defaults to 0.</p></li>
<li><p><strong>uw_centre_x</strong> (<em>float</em><em>, </em><em>optional</em>) – x-position of upper wall potential. Defaults to 0.0.</p></li>
<li><p><strong>uw_centre_y</strong> (<em>float</em><em>, </em><em>optional</em>) – y-position of upper wall potential. Defaults to 0.0.</p></li>
<li><p><strong>uw_kappa_x</strong> (<em>int</em><em>, </em><em>optional</em>) – x-force_constant of upper wall potential. Defaults to 0.</p></li>
<li><p><strong>uw_kappa_y</strong> (<em>int</em><em>, </em><em>optional</em>) – y-force_constant of upper wall potential. Defaults to 0.</p></li>
<li><p><strong>position_pace</strong> (<em>int</em><em>, </em><em>optional</em>) – Pace of recording the CV in the position file. When position_pace=0, position_pace = gaus_pace/10. Defaults to 0.</p></li>
<li><p><strong>file_extension</strong> (<em>str</em><em>, </em><em>optional</em>) – Adds an extension the the position and HILLS file. E.g. file_extension=”_1” -&gt; position_file=”position_1”. Defaults to “”.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="pymfi-mfi-functions-module">
<h2>pyMFI.MFI_functions module<a class="headerlink" href="#pymfi-mfi-functions-module" title="Permalink to this heading"></a></h2>
</section>
<section id="module-pyMFI">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyMFI" title="Permalink to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="pyMFI_git" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, AB.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>