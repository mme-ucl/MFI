
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>pyMFI package &#8212; MFI documentation Sep 2023 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/classic.css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="pyMFI" href="modules.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="modules.html" title="pyMFI"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">MFI documentation Sep 2023 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="modules.html" accesskey="U">pyMFI</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">pyMFI package</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="pymfi-package">
<h1>pyMFI package<a class="headerlink" href="#pymfi-package" title="Permalink to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-pyMFI.MFI">
<span id="pymfi-mfi-module"></span><h2>pyMFI.MFI module<a class="headerlink" href="#module-pyMFI.MFI" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.FFT_intg_2D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">FFT_intg_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">FX</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([-</span> <span class="pre">3.14159265,</span> <span class="pre">-</span> <span class="pre">3.14159265])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([3.14159265,</span> <span class="pre">3.14159265])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.FFT_intg_2D" title="Permalink to this definition">¶</a></dt>
<dd><p>2D integration of force gradient (FX, FY) to find FES using Fast Fourier Transform.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>FX (array of size (nbins[0], nbins[1])): CV1 component of the Mean Force.
FY (array of size (nbins[0], nbins[1])): CV1 component of the Mean Force.
min_grid (array, optional): Lower bound of the simulation domain. Defaults to np.array((-np.pi, -np.pi)).
min_grid (array, optional): Upper bound of the simulation domain. Defaults to np.array((np.pi, np.pi)).
nbins (int, optional): number of bins in CV2,CV1. Defaults to 0. When nbins=0, nbins will take the shape of FX.</p>
</dd>
<dt>Returns:</dt><dd><p>X: array of size (nbins[0], nbins[1]) - CV1 meshgrid positions
Y: array of size (nbins[0], nbins[1]) - CV2 meshgrid positions
fes: array of size (nbins[0], nbins[1]) - Free Energy Surface</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.MFI_2D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">MFI_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">HILLS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'HILLS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'position_x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'position_y'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kT</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([-</span> <span class="pre">3.14159265,</span> <span class="pre">-</span> <span class="pre">3.14159265])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([3.14159265,</span> <span class="pre">3.14159265])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([200,</span> <span class="pre">200])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_terms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_corners</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">WellTempered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nhills</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_den_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_den_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_weighted_st_dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_centre_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_centre_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_centre_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_centre_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_centre_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_centre_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F_static_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">...,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span> <span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">...,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span> <span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">...,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span> <span class="pre">...,</span> <span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">...,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span> <span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">...,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span> <span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">...,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F_static_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">...,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span> <span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">...,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span> <span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">...,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span> <span class="pre">...,</span> <span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">...,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span> <span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">...,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span> <span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">...,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.MFI_2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a time-independent estimate of the Mean Thermodynamic Force, i.e. the free energy gradient in 2D CV spaces.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>HILLS (str): HILLS array. Defaults to “HILLS”.
position_x (str): CV1 array. Defaults to “position_x”.
position_y (str): CV2 array. Defaults to “position_y”.
bw (int, optional): Scalar, bandwidth for the construction of the KDE estimate of the biased probability density. Defaults to 1.
kT (int, optional): Scalar, kT. Defaults to 1.
min_grid (array, optional): Lower bound of the force domain. Defaults to np.array((-np.pi, -np.pi)).
max_grid (array, optional): Upper bound of the force domain. Defaults to np.array((np.pi, np.pi)).
nbins (array, optional): number of bins in CV1,CV2. Defaults to np.array((200,200)).
log_pace (int, optional): Progress and convergence are outputted every log_pace steps. Defaults to 10.
error_pace (int, optional): Pace for the calculation of the on-the-fly measure of global convergence. Defaults to 1, change it to a higher value if FES_cutoff&gt;0 is used. 
base_terms (int or list, optional): When set to 0, inactive. When activated, “on the fly” variance is calculated as a patch to base (previous) simulation. To activate, put force terms of base simulation ([Ftot_den, Ftot_den2, Ftot_x, Ftot_y, ofv_x, ofv_y]). Defaults to 0.
window_corners (list, optional): When set to [], inactive. When activated, error is ALSO calculated for mean force in the window. To activate, put the min and max values of the window ([min_x, max_x, min_y, max_y]). Defaults to [].
WellTempered (binary, optional): Is the simulation well tempered? . Defaults to 1.
nhills (int, optional): Number of HILLS to analyse, -1 for the entire HILLS array. Defaults to -1, i.e. the entire dataset.
periodic (int, optional): Is the CV space periodic? 1 for yes. Defaults to 0.
FES_cutoff (float, optional): Cutoff applied to FES and error calculation for FES values over the FES_cutoff. Defaults to -1. When FES_cutoff = 0, no cufoff is applied. Use with care, computing the fes in the loop renders the calculation extremely slow.
FFT_integration (binary, optional): Specifies if integration method. If set to 1, it will be done with the Fast Fourier Transform (FFT) algorithm. FFT integration is a fast integration algorithms, especially for higher dimensions, however it requires a sqmetric system. When set to 0, a finite difference integration algorithm will be used. Default is set to 0.
Ftot_den_limit (float, optional): Probability density limit below which data will be set to zero (this is done for numerical stability reasons. For default Ftot_den_limit, numerical difference is negligable). Defaults to 1E-10.
Ftot_den_cutoff (int, optional): Cutoff applied to FES and error calculation for Ftot_den (Probability density) values below the Ftot_den_cutoff. All FES values that are excluded by the cutoff won’t contribuite towards the error. Useful when low probability density values have little statistical significance or no physical meaning. When Ftot_den_cutoff = 0, no cufoff is applied. Defaults to 0. 
hp_centre_x (float, optional): CV1-position of harmonic potential. Defaults to 0.0.
hp_centre_y (float, optional): CV2-position of harmonic potential. Defaults to 0.0.
hp_kappa_x (int, optional): CV1-force_constant of harmonic potential. Defaults to 0.
hp_kappa_y (int, optional): CV2-force_constant of harmonic potential. Defaults to 0.
lw_centre_x (float, optional): CV1-position of lower wall potential. Defaults to 0.0.
lw_centre_y (float, optional): CV2-position of lower wall potential. Defaults to 0.0.
lw_kappa_x (int, optional): CV1-force_constant of lower wall potential. Defaults to 0.
lw_kappa_y (int, optional): CV2-force_constant of lower wall potential. Defaults to 0.
uw_centre_x (float, optional): CV1-position of upper wall potential. Defaults to 0.0.
uw_centre_y (float, optional): CV2-position of upper wall potential. Defaults to 0.0.
uw_kappa_x (int, optional): CV1-force_constant of upper wall potential. Defaults to 0.
uw_kappa_y (int, optional): CV2-force_constant of upper wall potential. Defaults to 0.</p>
</dd>
</dl>
<p>F_static_x (array, optional): Option to provide a starting bias potential force in the CV1-direction that remains constant through the algorithm. This could be a harmonic potential, an previously used MetaD potential or any other bias potential defined on the grid. Defaults to np.zeros((123,96)), which will automatically set F_static to a zero-array with shape=(123,96).
F_static_y (array, optional): Option to provide a starting bias potential force in the CV2-direction that remains constant through the algorithm. This could be a harmonic potential, an previously used MetaD potential or any other bias potential defined on the grid. Defaults to np.zeros((123,96)), which will automatically set F_static to a zero-array with shape=(123,96).
use_weighted_st_dev (bool, optional): When set to True, the calculated error will be the weighted standard deviation ( var^0.5 ). When set to False, the calculated error will be the standard error ( (var/n_sample)^0.5 ). Defaults to True. (The standard devaition is expected to converge after enough time, while the standard error is expected to decrease as more datapoints are added.)</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>X: array of size (nbins[0], nbins[1]) - CV1 grid positions
Y: array of size (nbins[0], nbins[1]) - CV2 grid positions
Ftot_den: array of size (nbins[0], nbins[1]) - Cumulative biased probability density, equivalent to an unbiased histogram of samples in CV space.
Ftot_x:  array of size (nbins[0], nbins[1]) - CV1 component of the Mean Force.
Ftot_y:  array of size (nbins[0], nbins[1]) - CV2 component of the Mean Force.
ofe:  array of size (nbins[0], nbins[1]) - on the fly estimate of the local convergence
ofe_history: array of size (1, total_number_of_hills) - running estimate of the global convergence of the mean force.
(option with window corner activated: ofe_history_window: array of size (1, total_number_of_hills) - running estimate of the “window” convergence of the mean force.)
ofe_history_time: array of size (1, total_number_of_hills) - time array of ofe_history
Ftot_den2: array of size (nbins[0], nbins[1]) - Cumulative squared biased probability density
ofv_x: array of size (nbins[0], nbins[1]) - intermediate component in the calculation of the CV1 “on the fly variance” ( sum of: pb_t * dfds_x ** 2)
ofv_y: array of size (nbins[0], nbins[1]) - intermediate component in the calculation of the CV2 “on the fly variance” ( sum of: pb_t * dfds_y ** 2)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.bootstrap_2D_new">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">bootstrap_2D_new</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bootstrap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.bootstrap_2D_new" title="Permalink to this definition">¶</a></dt>
<dd><p>Algorithm to determine bootstrap error of FES. Takes in a list of force terms, and with each bootstrap itteration random force terms are picked, patched together and the FES is determinded. Over the itterations, the a standard deviation map and the averaged st.dev. is computed. When all iterations are completed, the average of all FESs, the final averaged st.dev. map and the progression of the averaged st.dev. is returned.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>X: array of size (nbins[0], nbins[1]): CV1 grid positions
Y: array of size (nbins[0], nbins[1]): CV2 grid positions
forces_all (list): collection of force terms (n * [Ftot_den, Ftot_x, Ftot_y])
n_bootstrap (int): bootstrap iterations
FES_cutoff (float): Only st.dev. values that correspond to a FES value below the FES_cutoff will be considered, while the others will just be turned to zero. Default FES_cutoff is 0, and no cutoff is applied.        
periodic (bool): Will specify if the system is periodic (periodic=1) or non-periodic (periodic=0). This is relevant to choose the appropiate integration method. Default is set to zero (non-periodic).
log_pace (int): Specifies the pace at which the average st.dev is printed. With a value of 100, st.dev is printed is printed every 100 iterations. With a value of 0, st.dev is printed is only printed at the end. With a value of -1, it will be printed 5 times in total. Default is set to 0.</p>
</dd>
<dt>Returns:</dt><dd><p>FES_avr: array of size (nbins[0], nbins[1]) - Average of all FES calculated. The minima will be set automatically to zero.
sd_fes: array of size (nbins[0], nbins[1]) - Standard deviation map of all FES generated.
sd_fes_prog: array of size (n_bootstrap,) - Array of the average st.dev. calculated at each iteration.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.find_hp_force">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">find_hp_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hp_centre_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_centre_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.find_hp_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Find 2D harmonic potential force.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>hp_centre_x (float): CV1-position of harmonic potential
hp_centre_y (float): CV2-position of harmonic potential
hp_kappa_x (float): CV1-force_constant of harmonic potential
hp_kappa_y (float): CV2-force_constant of harmonic potential
X (array): 2D array of CV1 grid positions
Y (array): 2D array of CV2 grid positions
min_grid (list): list of CV1-minimum value of grid and CV2-minimum value of grid
max_grid (list): list of CV1-maximum value of grid and CV2-maximum value of grid
grid_space (list): list of CV1-grid spacing and CV2-grid spacing
periodic (binary): information if system is periodic. value of 0 corresponds to non-periodic system. Value of 1 corresponds to periodic system.</p>
</dd>
<dt>Returns:</dt><dd><p>F_harmonic_x (array): harmonic force in CV1 direction.
F_harmonic_y (array): harmonic force in CV2 direction.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.find_lw_force">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">find_lw_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lw_centre_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_centre_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.find_lw_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Find lower half of 2D harmonic potential force equivalent to f = 2 * lw_kappa * (grid - lw_centre) for grid &lt; lw_centre and f = 0 otherwise. This can change for periodic cases.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>lw_centre_x (float): CV1-position of lower wall potential
lw_centre_y (float): CV2-position of lower wall potential
lw_kappa_x (float): CV1-force_constant of lower wall potential
lw_kappa_y (float): CV2-force_constant of lower wall potential
X (array): 2D array of CV1 grid positions
Y (array): 2D array of CV2 grid positions
min_grid (list): list of CV1-minimum value of grid and CV2-minimum value of grid
max_grid (list): list of CV1-maximum value of grid and CV2-maximum value of grid
grid_space (list): list of CV1-grid spacing and CV2-grid spacing
periodic (binary): information if system is periodic. value of 0 corresponds to non-periodic system. Value of 1 corresponds to periodic system.</p>
</dd>
<dt>Returns:</dt><dd><p>F_wall_x (array): lower wall potential force in CV1 direction.
F_wall_y (array): lower wall potential force in CV2 direction.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.find_periodic_point">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">find_periodic_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_coord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_coord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.find_periodic_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds periodic copies of input coordinates. First checks if systems is periodic. If not, returns input coordinate array. Next, it checks if each coordinate is within the boundary range (grid min/max +/- grid_ext). If it is, periodic copies will be made on the other side of the CV-domain.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>x_coord (float): CV1-coordinate
y_coord (float): CV2-coordinate
min_grid (list): list of CV1-minimum value of grid and CV2-minimum value of grid
max_grid (list): list of CV1-maximum value of grid and CV2-maximum value of grid
periodic (binary): information if system is periodic. value of 0 corresponds to non-periodic system; function will only return input coordinates. Value of 1 corresponds to periodic system; function will return input coordinates with periodic copies.</p>
</dd>
<dt>Returns:</dt><dd><p>list: list of [x-coord, y-coord] pairs</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.find_uw_force">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">find_uw_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uw_centre_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_centre_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.find_uw_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Find upper half of 2D harmonic potential force equivalent to f = 2 * uw_kappa * (grid - uw_centre) for grid &gt; uw_centre and f = 0 otherwise. This can change for periodic cases.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>lw_centre_x (float): CV1-position of upper wall potential
lw_centre_y (float): CV2-position of upper wall potential
lw_kappa_x (float): CV1-force_constant of upper wall potential
lw_kappa_y (float): CV2-force_constant of upper wall potential
X (array): 2D array of CV1 grid positions
Y (array): 2D array of CV2 grid positions
min_grid (list): list of CV1-minimum value of grid and CV2-minimum value of grid
max_grid (list): list of CV1-maximum value of grid and CV2-maximum value of grid
grid_space (list): list of CV1-grid spacing and CV2-grid spacing
periodic (binary): information if system is periodic. value of 0 corresponds to non-periodic system. Value of 1 corresponds to periodic system.</p>
</dd>
<dt>Returns:</dt><dd><p>F_wall_x (array): upper wall potential force in CV1 direction.
F_wall_y (array): upper wall potential force in CV2 direction.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.index">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_space</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.index" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds (approximate) index of a position in a grid. Independent of CV-type.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>position (float): position of interest
min_grid (float): minimum value of grid
grid_space (float): grid spacing</p>
</dd>
<dt>Returns:</dt><dd><p>int: index of position</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.intg_2D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">intg_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">FX</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([-</span> <span class="pre">3.14159265,</span> <span class="pre">-</span> <span class="pre">3.14159265])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([3.14159265,</span> <span class="pre">3.14159265])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([200,</span> <span class="pre">200])</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.intg_2D" title="Permalink to this definition">¶</a></dt>
<dd><p>2D integration of force gradient (FX, FY) to find FES using finite difference method.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>FX (array of size (nbins[0], nbins[1])): CV1 component of the Mean Force.
FY (array of size (nbins[0], nbins[1])): CV2 component of the Mean Force.
min_grid (array, optional): Lower bound of the simulation domain. Defaults to np.array((-np.pi, -np.pi)).
min_grid (array, optional): Upper bound of the simulation domain. Defaults to np.array((np.pi, np.pi)).
nbins (array of shape (2,), optional): number of bins in CV1,CV2. Defaults to np.array((200,200)).</p>
</dd>
<dt>Returns:</dt><dd><p>X: array of size (nbins[0], nbins[1]) - CV1 grid positions
Y: array of size (nbins[0], nbins[1]) - CV2 grid positions
fes: array of size (nbins[0], nbins[1]) - Free Energy Surface</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.intg_FD8">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">intg_FD8</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">FX</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0,</span> <span class="pre">0])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([3,</span> <span class="pre">3])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([201,</span> <span class="pre">201])</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.intg_FD8" title="Permalink to this definition">¶</a></dt>
<dd><p>Alternative integrtion method. More comoputational intense finite difference method. Might be usefull when other methods don’t seem to work. 
This method is doing 8 finite difference integrations, where each of the 8 is taking a different integration path. All 8 integrals are averaged into the final integral.</p>
<blockquote>
<div><dl class="simple">
<dt>Args:</dt><dd><p>FX (array of size (nbins[0], nbins[1])): CV1 component of the Mean Force.
FY (array of size (nbins[0], nbins[1])): CV2 component of the Mean Force.
min_grid (array, optional): Lower bound of the simulation domain. Defaults to np.array((0, 0)).
min_grid (array, optional): Upper bound of the simulation domain. Defaults to np.array((3, 3)).
nbins (int, optional): number of bins in CV1,CV2. Defaults to np.array((200,200)).</p>
</dd>
<dt>Returns:</dt><dd><p>X: array of size (nbins[0], nbins[1]) - CV1 grid positions
Y: array of size (nbins[0], nbins[1]) - CV2 grid positions
FES_a: array of size (nbins[0], nbins[1]) - (Average) Free Energy Surface</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.intgrad2">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">intgrad2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ny</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intconst</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">per1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">per2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([-</span> <span class="pre">2,</span> <span class="pre">-</span> <span class="pre">2])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([2,</span> <span class="pre">2])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.intgrad2" title="Permalink to this definition">¶</a></dt>
<dd><p>This function uses the inverse of the gradient to reconstruct the free energy surface from the mean force components.
[John D’Errico (2022). Inverse (integrated) gradient (<a class="reference external" href="https://www.mathworks.com/matlabcentral/fileexchange/9734-inverse-integrated-gradient">https://www.mathworks.com/matlabcentral/fileexchange/9734-inverse-integrated-gradient</a>), MATLAB Central File Exchange. Retrieved May 17, 2022.]
[Translated from MatLab to Python by Francesco Serse (<a class="reference external" href="https://github.com/Fserse">https://github.com/Fserse</a>)]</p>
<dl class="simple">
<dt>Args:</dt><dd><p>fx (array): (ny by nx) array. X-gradient to be integrated.
fy (array): (ny by nx) array. X-gradient to be integrated.
nx (integer): nuber of datapoints in x-direction. Default to 0: will copy the shape of the input gradient.
ny (integer): nuber of datapoints in y-direction. Default to 0: will copy the shape of the input gradient.
intconst (float): Minimum value of output FES
per1 (boolean): True if x-variable is periodic. False if non-periodic.
per2 (boolean): True if y-variable is periodic. False if non-periodic
min_grid (list/array of length=2): list/array of minimum value of [x-grid, y-grid]
max_grid (list/array of length=2):  list/array of maximum value of [x-grid, y-grid]
nbins (list/array of length=2): list/array of number of data pointis of [x-grid, y-grid]. Default to 0: will copy the shape of the input gradient.</p>
</dd>
<dt>Returns:</dt><dd><p>X (ny by nx array): X-component of meshgrid
Y (ny by nx array): Y-component of meshgrid
fhat (ny by nx array): integrated free energy surface</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.load_HILLS_2D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">load_HILLS_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hills_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'HILLS'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.load_HILLS_2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Load 2-dimensional hills data (includes time, position_x, position_y, hills_parameters ).</p>
<dl class="simple">
<dt>Args:</dt><dd><p>hills_name (str, optional): Name of hills file. Defaults to “HILLS”.</p>
</dd>
<dt>Returns:</dt><dd><p>np.array: Array with hills data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.load_npy">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">load_npy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.load_npy" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads np.array of a file with .npy format</p>
<dl class="simple">
<dt>Args:</dt><dd><p>name (string): Name of file</p>
</dd>
<dt>Returns:</dt><dd><p>np.array: object to be loaded. Must be a numpy array.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.load_pkl">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">load_pkl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.load_pkl" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads list/array of a file with .pkl format</p>
<dl class="simple">
<dt>Args:</dt><dd><p>name (string): Name of file</p>
</dd>
<dt>Returns:</dt><dd><p>any: object to be loaded</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.load_position_2D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">load_position_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'position'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.load_position_2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Load 2-dimensional position/trajectory data.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>position_name (str, optional): Name of position file. Defaults to “position”.</p>
</dd>
<dt>Returns:</dt><dd><p>list: 2 * np.array with position data of each dimension ([position_x, position_y])</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.mean_force_variance">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">mean_force_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ftot_den</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_den2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ofv_num_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ofv_num_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_weighted_st_dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.mean_force_variance" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the weighted variance of the mean force and the weighted standard devaition of the mean force. First calculates the variance and st.dev. of the force in CV1 space and CV2 space seperately, then computes the modulus of the two.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>Ftot_den (array of size (nbins[0], nbins[1])): Cumulative biased probability density
25Ftot_den2 (array of size (nbins[0], nbins[1])):  Cumulative squared biased probability density
Ftot_x (array of size (nbins[0], nbins[1])): CV1 component of the Mean Force.
Ftot_y (array of size (nbins[0], nbins[1])): CV2 component of the Mean Force.
ofv_num_x (array of size (nbins[0], nbins[1])): intermediate component in the calculation of the CV1 “on the fly variance” ( sum of: pb_t * dfds_x ** 2)
ofv_num_y (array of size (nbins[0], nbins[1])): intermediate component in the calculation of the CV2 “on the fly variance” ( sum of: pb_t * dfds_y ** 2)
Ftot_den_limit (scalar): threshold in the cumulative biased probability density where data is discarded. Defaults to 0.</p>
</dd>
<dt>Returns:</dt><dd><p>ofv (array of size (nbins[0], nbins[1])): “on-the-fly” variance. Modulus of “on-the-fly variance” in CV1 space and CV2 space.
ofe (array of size (nbins[0], nbins[1])): “on-the-fly” error (standard devaition). Modulus of “on-the-fly variance” in CV1 space and CV2 space.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.patch_2D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">patch_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">master_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([200,</span> <span class="pre">200])</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.patch_2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in a collection of force terms and patches them togehter to return the patched force terms</p>
<dl class="simple">
<dt>Args:</dt><dd><p>master_array (list): collection of force terms (n * [Ftot_den, Ftot_den2, Ftot_x, Ftot_y, ofv_x, ofv_y])
nbins (array, optional): number of bins in CV1,CV2. Defaults to np.array((200,200)).</p>
</dd>
<dt>Returns:</dt><dd><p>Patched force terms (list) -&gt; ([Ftot_den, Ftot_den2, Ftot_x, Ftot_y, ofv_x, ofv_y])</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.patch_2D_simple">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">patch_2D_simple</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">master_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([200,</span> <span class="pre">200])</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.patch_2D_simple" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in a collection of force and patches only the probability density and mean forces</p>
<dl class="simple">
<dt>Args:</dt><dd><p>master_array (list): collection of force terms (n * [X, Y, Ftot_den, Ftot_x, Ftot_y])
nbins (array, optional): number of bins in CV1,CV2. Defaults to np.array((200,200)).</p>
</dd>
<dt>Returns:</dt><dd><p>Patched probability density and mean forces (list) -&gt; ([Ftot_den, Ftot_x, Ftot_y])</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.patch_to_base_variance">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">patch_to_base_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">master0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">master</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_den_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_weighted_st_dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.patch_to_base_variance" title="Permalink to this definition">¶</a></dt>
<dd><p>Patches force terms of a base simulation (alaysed prior to current simulation) with current simulation to return patched “on the fly variance”.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>master0 (list): Force terms of base simulation (alaysed prior to current simulation) [Ftot_den, Ftot_den2, Ftot_x, Ftot_y, ofv_num_x, ofv_num_y]
master (list): Force terms of current simulation [Ftot_den, Ftot_den2, Ftot_x, Ftot_y, ofv_num_x, ofv_num_y]
Ftot_den_limit (float): Truncates the probability density below Ftot_den_limit. Default set to 1E-10.</p>
</dd>
</dl>
<p>use_weighted_st_dev (bool, optional): When set to True, the calculated error will be the weighted standard deviation ( var^0.5 ). When set to False, the calculated error will be the standard error ( (var/n_sample)^0.5 ). Defaults to True. (The standard devaition is expected to converge after enough time, while the standard error is expected to decrease as more datapoints are added.)</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>OFV (array of size (nbins[0], nbins[1])): modulus of patched “on the fly variance”</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.plot_bootstrap">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">plot_bootstrap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sd_fes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sd_fes_prog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ofe_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ofe_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.plot_bootstrap" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots result of bootstrap analysis. 1. Average FES, 2. average varinace, 3. variance progression</p>
<dl class="simple">
<dt>Args:</dt><dd><p>X: array of size (nbins[0], nbins[1]) - CV1 grid positions
Y: array of size (nbins[0], nbins[1]) - CV2 grid positions
FES: array of size (nbins[0], nbins[1]) - Free Energy Surface
var_fes (array of size (nbins[0], nbins[1])): _description_
var_fes_prog (list): _description_
FES_lim (int, optional): Upper energy limit of FES plot. Defaults to 11.
ofe_map_lim (int, optional): Upper variance limit of variance plot. Defaults to 11.</p>
</dd>
<dt>Returns:</dt><dd><p>(Plot)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.plot_patch_2D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">plot_patch_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TOTAL_DENSITY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.plot_patch_2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots 1. FES, 2. Cumulative biased probability density</p>
<dl class="simple">
<dt>Args:</dt><dd><p>X: array of size (nbins[0], nbins[1]) - CV1 grid positions
Y: array of size (nbins[0], nbins[1]) - CV2 grid positions
FES: array of size (nbins[0], nbins[1]) - Free Energy Surface
TOTAL_DENSITY: array of size (nbins[0], nbins[1]) - Cumulative biased probability density</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.plot_recap_2D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">plot_recap_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TOTAL_DENSITY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CONVMAP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CONV_history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CONV_history_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ofe_map_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ofe_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.plot_recap_2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots 1. FES, 2. varinace_map, 3. Cumulative biased probability density, 4. Convergece of variance.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>X: array of size (nbins[0], nbins[1]) - CV1 grid positions
Y: array of size (nbins[0], nbins[1]) - CV2 grid positions
FES: array of size (nbins[0], nbins[1]) - Free Energy Surface
TOTAL_DENSITY: array of size (nbins[0], nbins[1]) - Cumulative biased probability density
CONVMAP (array of size (nbins[0], nbins[1])): varinace_map
CONV_history (list): Convergece of variance</p>
</dd>
<dt>Returns: </dt><dd><p>Plot 1: FES.
Plot 2: Error Map.
Plot 3: Probability density map.
Plot 4: Error progression for measure of convergence.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.reduce_to_window">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">reduce_to_window</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.reduce_to_window" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduces an 2D input array to a specified range (or a window of the CV).</p>
<dl class="simple">
<dt>Args:</dt><dd><p>input_array (array): 2D array to be reduced
min_grid (list): list of CV1-minimum value of grid and CV2-minimum value of grid
grid_space (list): list of CV1-grid spacing and CV2-grid spacing
x_min (float, optional): lower CV1-value of output array. Defaults to -0.5.
x_max (float, optional): upper CV1-value of output array. Defaults to 0.5.
y_min (float, optional): lower CV2-value of output array. Defaults to -1.5.
y_max (float, optional): upper CV2-value of output array. Defaults to 1.5.</p>
</dd>
<dt>Returns:</dt><dd><p>array: reduced array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.save_npy">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">save_npy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.save_npy" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves np.array in a file with .npy format</p>
<dl class="simple">
<dt>Args:</dt><dd><p>object (np.array): object to be saved. Must be a numpy array.
file_name (string): Name of file</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.save_pkl">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">save_pkl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.save_pkl" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves a list/array in a file with .pkl format</p>
<dl class="simple">
<dt>Args:</dt><dd><p>object (any): object to be saved
file_name (string): Name of file</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI.zero_to_nan">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI.</span></span><span class="sig-name descname"><span class="pre">zero_to_nan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_array</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI.zero_to_nan" title="Permalink to this definition">¶</a></dt>
<dd><p>Ruturns an array identical to the input array, but with all zero-values turned to np.nan. This could be useful for plotting arrays, where np.nan values won’t be shown.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>input_array (array or list (flexible shape)): This can be anything from FES to error map</p>
</dd>
<dt>Returns:</dt><dd><p>output_array (array with identical shape to input array): zero-values turned to np.nan</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyMFI.MFI1D">
<span id="pymfi-mfi1d-module"></span><h2>pyMFI.MFI1D module<a class="headerlink" href="#module-pyMFI.MFI1D" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.MFI_1D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">MFI_1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">HILLS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'HILLS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'position'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kT</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">201</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">WellTempered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nhills</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_centre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_centre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_centre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F_static</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_den_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_den_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_intermediate_fes_error_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_weighted_st_dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.MFI_1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a time-independent estimate of the Mean Thermodynamic Force, i.e. the free energy gradient in 1D CV spaces.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>HILLS (str): HILLS array. Defaults to “HILLS”.
position (str): CV/position array. Defaults to “position”.
bw (float, optional): bandwidth for the construction of the KDE estimate of the biased probability density. Defaults to 1.
kT (float, optional): kT. Defaults to 1.
min_grid (int, optional): Lower bound of the force domain. Defaults to -2.
max_grid (int, optional): Upper bound of the force domain. Defaults to 2.
nbins (int, optional): number of bins in grid. Defaults to 101.
log_pace (int, optional): Pace for outputting progress and convergence. Defaults to -1. When set to -1, progress will be outputted 5 times in total.
error_pace (int, optional): Pace for calculating the on-the-fly error for  estimating global convergence. Defaults to -1. When set to -1, on-the-fly error will be calculated 50 times.
WellTempered (binary, optional): Is the simulation well tempered?. Defaults to 1.
nhills (int, optional): Number of HILLS to be analysed. When set to -1, all HILLS will be analysed. Defaults to -1.
periodic (int, optional): Is the CV space periodic? 1 for yes. Defaults to 0.
hp_centre (float, optional): position of harmonic potential. Defaults to 0.0.
hp_kappa (int, optional): force_constant of harmonic potential. Defaults to 0.
lw_centre (float, optional): position of lower wall potential. Defaults to 0.0.
lw_kappa (int, optional): force_constant of lower wall potential. Defaults to 0.
uw_centre (float, optional): position of upper wall potential. Defaults to 0.0.
uw_kappa (int, optional): force_constant of upper wall potential. Defaults to 0.
save_intermediate_fes_error_cutoff (bool, optional): If Ture, every time the error is calculated, the FES, variance, standard deviation and cutoff will be saved. Defaults to False.
Ftot_den_limit (float, optional): Probability density limit below which data will be set to zero (this is done for numerical stability reasons. For default Ftot_den_limit, numerical difference is negligable). Defaults to 1E-10.
FES_cutoff (float, optional): Cutoff applied to FES and error calculation for FES values over the FES_cutoff. All FES values above the FES_cutoff won’t contribuite towards the error. Useful when high FES values have no physical meaning. When FES_cutoff = 0, no cufoff is applied.Defaults to 0. 
Ftot_den_cutoff (int, optional): Cutoff applied to FES and error calculation for Ftot_den (Probability density) values below the Ftot_den_cutoff. All FES values that are excluded by the cutoff won’t contribuite towards the error. Useful when low Probability density values have little statistical significance or no physical meaning. When Ftot_den_cutoff = 0, no cufoff is applied. Defaults to 0.
F_static (array, optional): Option to provide a starting bias potential that remains constant through the algorithm. This could be a harmonic potential, an previously used MetaD potential or any other bias potential defined on the grid. Defaults to np.zeros(123), which will automatically set F_static to a zero-array with length=nbins.
use_weighted_st_dev (bool, optional): When set to True, the calculated error will be the weighted standard deviation ( var^0.5 ). When set to False, the calculated error will be the standard error ( (var/n_sample)^0.5 ). Defaults to True. (The standard devaition is expected to converge after enough time, while the standard error is expected to decrease as more datapoints are added.)</p>
</dd>
<dt>Returns:</dt><dd><p>grid (array of size (nbins,)): CV-array.
Ftot_den (array of size (nbins,)): Cumulative biased probability density.
Ftot_den2 (array of size (nbins,): Cumulative (biased probability density squared). Used for error calculation.
Ftot (array of size (nbins,)): Local Mean Force. When integrated will be the FES.
ofv_num (array of size (nbins,)): Numerator of “on-the-fly” variance (ofv). Used for error calculation.
FES (array of size (nbins,)): Free Energy Surface
ofv (array of size (nbins,)): “on-the-fly” variance
ofe (array of size (nbins,)): “on-the-fly” estimate of the standard deviation of the mean force
cutoff (binary array of size (nbins,)): If FES_cutoff and/or Ftot_den_cutoff are specified, grid values outside the cufoff will be zero and grid values inside the cutoff will be one. If FES_cutoff and Ftot_den_cutoff not active, cutoff will be an array of ones.
error_evol (array of size (4, total_number_of_hills//error_pace)): Evolution of error. First array is the collection of the global (average) “on-the-fly” variance, second array is the collection of the global (average) “on-the-fly” standard deviation, third array is the percentage of values within the specified cutoff, and the fourth array are the simulation times of the latter former arrays.
fes_error_cutoff_evol (array of size (4, total_number_of_hills//error_pace, nbins)): First array is the collection of FES, second array is the collection of local “on-the-fly” variance, third array is the collection of local “on-the-fly” standard deviation, and the fourth is the collection of the cutoffs. The elements of the collections were calculated at the simulation times of the fourth array in error_evol.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.bootstrap_1D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">bootstrap_1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bootstrap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_fes_minima</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.bootstrap_1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Algorithm to determine bootstrap error</p>
<dl class="simple">
<dt>Args:</dt><dd><p>grid (array of shape (nbins,)): CV grid positions
force_array (list): collection of force terms (n * [Ftot_den, Ftot]).
n_bootstrap (int): bootstrap itterations</p>
</dd>
<dt>Returns:</dt><dd><p>FES_avr (array of shape (nbins,)): Average of all FES generated during the bootstrap algorithm.
sd_fes (array of shape (nbins,)): Standard deviation of all FES generated during the bootstrap algorithm.
sd_fes_prog (array of shape (n_bootstrap,)): Global average of the standard deviation after each bootstrap itteration. When this array converges, enough itterations have been performed. If it does not converge, move itterations are necessary.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.bootstrap_forw_back">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">bootstrap_forw_back</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forward_force</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backward_force</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bootstrap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_fes_minima</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.bootstrap_forw_back" title="Permalink to this definition">¶</a></dt>
<dd><p>Algorithm to determine bootstrap error</p>
<dl class="simple">
<dt>Args:</dt><dd><p>grid (array of shape (nbins,)): CV grid positions
forward_force (list): collection of force terms (n * [Ftot_den, Ftot]) from forward transition
backward_force (list): collection of force terms (n * [Ftot_den, Ftot]) from backward transition
n_bootstrap (int): bootstrap itterations</p>
</dd>
<dt>Returns:</dt><dd><p>FES_avr (array of shape (nbins,)): Average of all FES generated during the bootstrap algorithm.
sd_fes (array of shape (nbins,)): Standard deviation of all FES generated during the bootstrap algorithm.
sd_fes_prog (array of shape (n_bootstrap,)): Global average of the standard deviation after each bootstrap itteration. When this array converges, enough itterations have been performed. If it does not converge, move itterations are necessary.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.find_hp_force">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">find_hp_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hp_centre</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.find_hp_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Find 1D harmonic potential force equivalent to f = hp_kappa * (grid - hp_centre).</p>
<dl class="simple">
<dt>Args:</dt><dd><p>hp_centre (float): position of harmonic potential
hp_kappa (float): force_constant of harmonic potential
grid (array): CV grid positions
min_grid (float): minimum value of grid
max_grid (float): maximum value of grid
grid_space (float): space between two consecutive grid values
periodic (binary): information if system is periodic. value of 0 corresponds to non-periodic system. Value of 1 corresponds to periodic system.</p>
</dd>
<dt>Returns:</dt><dd><p>array: harmonic force array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.find_lw_force">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">find_lw_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lw_centre</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.find_lw_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Find lower half of 1D harmonic potential force equivalent to f = 2 * lw_kappa * (grid - lw_centre) for grid &lt; lw_centre and f = 0 otherwise. This can change for periodic cases.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>lw_centre (float): position of lower wall potential
lw_kappa (float): force_constant of lower wall potential
grid (array): CV grid positions
min_grid (float): minimum value of grid
max_grid (float): maximum value of grid
grid_space (float): space between two consecutive grid values
periodic (binary): information if system is periodic. value of 0 corresponds to non-periodic system. Value of 1 corresponds to periodic system.</p>
</dd>
<dt>Returns:</dt><dd><p>array: lower wall force array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.find_periodic_point">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">find_periodic_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_coord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_ext</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.find_periodic_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds periodic copies of input coordinates. First checks if systems is periodic. If not, returns input coordinate array. Next, it checks if each coordinate is within the boundary range (grid min/max +/- grid_ext). If it is, periodic copies will be made on the other side of the CV-domain.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>x_coord (float): CV-coordinate
min_grid (float): minimum value of grid
max_grid (float): maximum value of grid
periodic (binary): information if system is periodic. value of 0 corresponds to non-periodic system; function will only return input coordinates. Value of 1 corresponds to periodic system; function will return input coordinates with periodic copies.
grid_ext (float): how far outside the domain periodic copies are searched for. E.g. if the domain is from -2 to +2 and the grid ext(end) is set to 1, then periodic copies are only found for input_coordiante &lt; -2 + 1 or input_coordiante &gt; +2 - 1.</p>
</dd>
<dt>Returns:</dt><dd><p>list: list of input coord and if applicable periodic copies</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.find_periodic_point_numpy">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">find_periodic_point_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coord_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_ext</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.find_periodic_point_numpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds periodic copies of input coordinates. First checks if systems is periodic. If not, returns input coordinate array. Next, it checks if each coordinate is within the boundary range (grid min/max +/- grid_ext). If it is, periodic copies will be made on the other side of the CV-domain.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>coord_array (array): array of CV-coordinate s
min_grid (float): minimum value of grid
max_grid (float): maximum value of grid
periodic (binary): information if system is periodic. value of 0 corresponds to non-periodic system; function will only return input coordinates. Value of 1 corresponds to periodic system; function will return input coordinates with periodic copies.
grid_ext (float): how far outside the domain periodic copies are searched for. E.g. if the domain is from -2 to +2 and the grid ext(end) is set to 1, then periodic copies are only found for input_coordiante &lt; -2 + 1 or input_coordiante &gt; +2 - 1.</p>
</dd>
<dt>Returns:</dt><dd><p>list: list of input coord and if applicable periodic copies</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.find_uw_force">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">find_uw_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uw_centre</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.find_uw_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Find upper half of 1D harmonic potential force equivalent to f = 2 * uw_kappa * (grid - uw_centre) for grid &gt; uw_centre and f = 0 otherwise. This can change for periodic cases.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>uw_centre (float): position of upper wall potential
uw_kappa (float): force_constant of upper wall potential
grid (_type_): CV grid positions
min_grid (float): minimum value of grid
max_grid (float): maximum value of grid
grid_space (float): space between two consecutive grid values
periodic (binary): information if system is periodic. value of 0 corresponds to non-periodic system. Value of 1 corresponds to periodic system.</p>
</dd>
<dt>Returns:</dt><dd><p>array: upper wall force array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.index">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_space</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.index" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds (approximate) index of a position in a grid. Independent of CV-type.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>position (float): position of interest
min_grid (float): minimum value of grid
grid_space (float): grid spacing</p>
</dd>
<dt>Returns:</dt><dd><p>int: index of position</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.intg_1D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">intg_1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Force</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.intg_1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Integration of 1D gradient using finite difference method (simpson’s method).</p>
<dl class="simple">
<dt>Args:</dt><dd><p>Force (array): Mean force
dx (array): grid spacing</p>
</dd>
<dt>Returns:</dt><dd><p>FES (array): Free energy surface</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.load_HILLS">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">load_HILLS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hills_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'HILLS'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.load_HILLS" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Load 1-dimensional hills data (includes time, position_x, position_y, hills_parameters)</dt><dd><p>Adjustment 2 - Last hill is removed from output array, as no complete set of COLVAR data is available of that hill.</p>
</dd>
<dt>Args:</dt><dd><p>hills_name (str, optional): Name of hills file. Defaults to “HILLS”.</p>
</dd>
<dt>Returns:</dt><dd><p>np.array: Array with hills data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.load_npy">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">load_npy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.load_npy" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads np.array of a file with .npy format</p>
<dl class="simple">
<dt>Args:</dt><dd><p>name (string): Name of file</p>
</dd>
<dt>Returns:</dt><dd><p>np.array: object to be loaded. Must be a numpy array.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.load_pkl">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">load_pkl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.load_pkl" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads list/array of a file with .pkl format</p>
<dl class="simple">
<dt>Args:</dt><dd><p>name (string): Name of file</p>
</dd>
<dt>Returns:</dt><dd><p>any: object to be loaded</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.load_position">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">load_position</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'position'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.load_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Load 1-dimensional position/trajectory data.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>position_name (str, optional): Name of position file. Defaults to “position”.</p>
</dd>
<dt>Returns:</dt><dd><p>position (list):  np.array with position data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.patch_FES_AD_ofe">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">patch_FES_AD_ofe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">force_vector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PD_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_weighted_st_dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.patch_FES_AD_ofe" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in an array of force terms, patches them together and calculates the error, FES and average deviation. The force vector has to be in the format [Ftot_den, Ftot_den2, Ftot, ofv_num].</p>
<dl class="simple">
<dt>Args:</dt><dd><p>force_vector (array of shape (n,4, nbins)) where n is the number of independent force terms: The force terms are tipically outputted from the MFI_1D functions. They should be in the format: [Ftot_den (Probability density), Ftot_den2, Ftot (Mean Force), ofv_num (numerator of on the fly variance)]. 
grid (array of shape (nbins, )): Grid that CV-space is defined on.
y (array of shape (nbins, )): Reference surface that is used to calculate the absolute devaition.
nhills (int, optional): Number of HILLS to be analysed. When set to -1, all HILLS will be analysed. Defaults to -1.
PD_limit (flaot, optional): Probability density values below the PD_limit will be approximated to be 0, to ensure the numerical stability of the algorithm. Defaults to 1E-10.
use_weighted_st_dev (bool, optional): When set to True, the calculated error will be the weighted standard deviation ( var^0.5 ). When set to False, the calculated error will be the standard error ( (var/n_sample)^0.5 ). Defaults to True. (The standard devaition is expected to converge after enough time, while the standard error is expected to decrease as more datapoints are added.).</p>
</dd>
<dt>Returns:</dt><dd><p>grid (array of size (nbins,)): CV-array.
PD_patch (array of size (nbins,)): Patched Probability density
F_patch (array of size (nbins,)): Patched Mean Force
FES (array of size (nbins,)): Free Energy Surface from patched Mean Force
AD (array of size (nbins,)): Absulute Deviation from FES to reference surface
AAD (float): Average Absulute Deviation from FES to reference surface
OFE (array of size (nbins,)): On-the-fly error. Statistical error of the mean force
AOFE (float): Average on-the-fly error.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.patch_FES_AD_ofe_cutoff">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">patch_FES_AD_ofe_cutoff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">force_vector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PD_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PD_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ofe_non_exploration_penalty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_weighted_st_dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.patch_FES_AD_ofe_cutoff" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in an array of force terms and patches them togehter, calculates the FES, the absolute deviation to a reference surface, the statistical error (on the fly error) and a cutoff array.</p>
<p>The force vector should be in the format: [force_term_1, force_term_2, … ,force_term_n] and</p>
<dl class="simple">
<dt>Args:</dt><dd><p>force_vector (array of shape (n,4, nbins)) where n is the number of independent force terms: The force terms are tipically outputted from the MFI_1D functions. They should be in the format: [Ftot_den (Probability density), Ftot_den2, Ftot (Mean Force), ofv_num (numerator of on the fly variance)]. 
grid (array of shape (nbins, )): Grid that CV-space is defined on.
y (array of shape (nbins, )): Reference surface that is used to calculate the absolute devaition.
PD_limit (flaot, optional): Probability density values below the PD_limit will be approximated to be 0, to ensure the numerical stability of the algorithm. Defaults to 1E-10.
PD_cutoff (flaot, optional): Probability density limit used to determine the cutoff. Values below the PD_limit will be cut-off. Defaults to 0.1.
ofe_non_exploration_penalty (flaot, optional): On-the-fly error values that that are ouside of the PD_cutoff will have a error equal to the ofe_non_exploration_penalty. Absolute deviation values that that are ouside of the PD_cutoff will have a error equal to the ofe_non_exploration_penalty/10. Defaults to 100.
use_weighted_st_dev (bool, optional): When set to True, the calculated error will be the weighted standard deviation ( var^0.5 ). When set to False, the calculated error will be the standard error ( (var/n_sample)^0.5 ). Defaults to True. (The standard devaition is expected to converge after enough time, while the standard error is expected to decrease as more datapoints are added.).</p>
</dd>
<dt>Returns:</dt><dd><p>grid (array of size (nbins,)): CV-array.
PD_patch (array of size (nbins,)): Patched Probability density
F_patch (array of size (nbins,)): Patched Mean Force
FES (array of size (nbins,)): Free Energy Surface from patched Mean Force
AD (array of size (nbins,)): Absulute Deviation from FES to reference surface
AAD (float): Average Absulute Deviation from FES to reference surface
OFE (array of size (nbins,)): On-the-fly error. Statistical error of the mean force
AOFE (float): Average on-the-fly error.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.patch_FES_ofe">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">patch_FES_ofe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">force_vector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_weighted_st_dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.patch_FES_ofe" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in an array of force terms, patches them together and calculates the error and FES. The force vector has to be in the format [Ftot_den, Ftot_den2, Ftot, ofv_num].</p>
<dl class="simple">
<dt>Args:</dt><dd><p>force_vector (array of shape (n,4, nbins)) where n is the number of independent force terms: The force terms are tipically outputted from the MFI_1D functions. They should be in the format: [Ftot_den (Probability density), Ftot_den2, Ftot (Mean Force), ofv_num (numerator of on the fly variance)]. 
grid (array of shape (nbins, )): Grid that CV-space is defined on.
nhills (int, optional): Number of HILLS to be analysed. When set to -1, all HILLS will be analysed. Defaults to -1.
PD_limit (flaot, optional): Probability density values below the PD_limit will be approximated to be 0, to ensure the numerical stability of the algorithm. Defaults to 1E-10.
use_weighted_st_dev (bool, optional): When set to True, the calculated error will be the weighted standard deviation ( var^0.5 ). When set to False, the calculated error will be the standard error ( (var/n_sample)^0.5 ). Defaults to True. (The standard devaition is expected to converge after enough time, while the standard error is expected to decrease as more datapoints are added.).</p>
</dd>
<dt>Returns:</dt><dd><p>grid (array of size (nbins,)): CV-array.
PD_patch (array of size (nbins,)): Patched Probability density
F_patch (array of size (nbins,)): Patched Mean Force
FES (array of size (nbins,)): Free Energy Surface from patched Mean Force
OFE (array of size (nbins,)): On-the-fly error. Statistical error of the mean force
AOFE (float): Average on-the-fly error.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.patch_forces">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">patch_forces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">force_vector</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.patch_forces" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in a collection of force and probability density and patches them.
Args:</p>
<blockquote>
<div><p>force_vector (list): collection of force terms (n * [Ftot_den, Ftot])</p>
</div></blockquote>
<dl class="simple">
<dt>Returns:</dt><dd><p>Patched probability density and mean forces (list) -&gt; ([Ftot_den, Ftot])</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.patch_forces_ofe">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">patch_forces_ofe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">force_vector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PD_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_weighted_st_dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ofe_progression</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.patch_forces_ofe" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in an array of force terms, patches them together and calculates the error. The force vector has to be in the format [Ftot_den, Ftot_den2, Ftot, ofv_num].</p>
<dl class="simple">
<dt>Args:</dt><dd><p>force_vector (array of shape (n,4, nbins)) where n is the number of independent force terms: The force terms are tipically outputted from the MFI_1D functions. They should be in the format: [Ftot_den (Probability density), Ftot_den2, Ftot (Mean Force), ofv_num (numerator of on the fly variance)]. 
PD_limit (flaot, optional): Probability density values below the PD_limit will be approximated to be 0, to ensure the numerical stability of the algorithm. Defaults to 1E-10.
ofe_non_exploration_penalty (flaot, optional): On-the-fly error values that that are ouside of the PD_cutoff will have a error equal to the ofe_non_exploration_penalty. Absolute deviation values that that are ouside of the PD_cutoff will have a error equal to the ofe_non_exploration_penalty/10. Defaults to 100.
use_weighted_st_dev (bool, optional): When set to True, the calculated error will be the weighted standard deviation ( var^0.5 ). When set to False, the calculated error will be the standard error ( (var/n_sample)^0.5 ). Defaults to True. (The standard devaition is expected to converge after enough time, while the standard error is expected to decrease as more datapoints are added.).
ofe_progression (bool, optional): If True, the error progression will be returned. If false, error progression will be an array will all elements being the final error. Default set to False.</p>
</dd>
<dt>Returns:</dt><dd><p>grid (array of size (nbins,)): CV-array.
PD_patch (array of size (nbins,)): Patched Probability density
F_patch (array of size (nbins,)): Patched Mean Force
FES (array of size (nbins,)): Free Energy Surface from patched Mean Force
AD (array of size (nbins,)): Absulute Deviation from FES to reference surface
AAD (float): Average Absulute Deviation from FES to reference surface
OFE (array of size (nbins,)): On-the-fly error. Statistical error of the mean force
AOFE (float): Average on-the-fly error.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.plot_recap">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">plot_recap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_den</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ofe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ofe_history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ofe_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_log_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.plot_recap" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot result of 1D MFI algorithm. 1. FES, 2. varinace_map, 3. Cumulative biased probability density, 4. Convergece of variance.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>X (array): gird
FES (array): Free energy surface
Ftot_den (array): _description_
ofe (array): Cumulative biased probability density
ofe_history (list): on the fly estimate of the local convergence
time_history (list): List of time or simulation number corresponding to error history.
FES_lim (int, optional): Upper energy value in FES plot. Defaults to 40.
ofe_lim (int, optional): Upper error value in FES plot. Defaults to 10.
error_log_scale (boolean, optional): Option to make error_conversion plot with a log scale. 1 for log scale. Defaults to 1.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.save_npy">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">save_npy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.save_npy" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves np.array in a file with .npy format</p>
<dl class="simple">
<dt>Args:</dt><dd><p>object (np.array): object to be saved. Must be a numpy array.
file_name (string): Name of file</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.save_pkl">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">save_pkl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.save_pkl" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves a list/array in a file with .pkl format</p>
<dl class="simple">
<dt>Args:</dt><dd><p>object (any): object to be saved
file_name (string): Name of file</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.window_forces">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">window_forces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">periodic_positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic_hills</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_meta2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height_meta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bw2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_den_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.window_forces" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in two arrays of positions. The periodic_positions are collected from the COLVAR file during a period of constant bias and calculates the force component associated with the probability density. periodic_hills are also positions collected from the HILLS file and calculates the force component resulting from the metadynamics bias. In a periodic system, positions have periodic copies if applicable.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>periodic_positions (array of shape (n,)): This array contains the positions from the COLVAR file, that were collected during a period of constant bias. n is the number of positions including their periodic copies if applicable. 
periodic_hills (array of shape (n,)): This array contains the position of the metadynamics hill (from the HILLS file), that was deposited at the beginning of the period of constant bias. If applicable the array also contains periodic copies. 
grid (array of shape (nbins,)): CV-array.
sigma_meta2 (float): width of metadynamics hill squared.
height_meta (float): height of metadynamics hill
kT (float): Temperature of the system.
const (float): constant factor used for the calculation of the kernel. This constant enables the patching of data with different values of bw and stride . const = (1 / (bw * np.sqrt(2 * np.pi) * stride))
bw2 (float): width of kernel density estimation (for the probability density) squared.
Ftot_den_limit (float, optional): Probability density limit below which data will be set to zero (this is done for numerical stability reasons. For default Ftot_den_limit, numerical difference is negligable). Defaults to 1E-10.</p>
</dd>
<dt>Returns:</dt><dd><p>pb_t (array of shape (nbins,)): Probability density of window
Fpbt (array of shape (nbins,)): Force component associated with the probability density of the time-window. 
Fbias_window (array of shape (nbins,)): Force component associated with the metadynamics hill deposited at the beginning of the time-window.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D.zero_to_nan">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D.</span></span><span class="sig-name descname"><span class="pre">zero_to_nan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_array</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D.zero_to_nan" title="Permalink to this definition">¶</a></dt>
<dd><p>Turns all zero elements of an array into numpy NaN (Not a Number)</p>
<dl class="simple">
<dt>Args:</dt><dd><p>input_array (array of size (x,)): Input array.</p>
</dd>
<dt>Returns:</dt><dd><p>output_array (array of size (x,)): Input array with zero elements turned to Nan.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyMFI.MFI1D_temp">
<span id="pymfi-mfi1d-temp-module"></span><h2>pyMFI.MFI1D_temp module<a class="headerlink" href="#module-pyMFI.MFI1D_temp" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D_temp.MFI_1D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D_temp.</span></span><span class="sig-name descname"><span class="pre">MFI_1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">HILLS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'HILLS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'position'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kT</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">201</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">WellTempered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intermediate_fes_number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D_temp.MFI_1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a time-independent estimate of the Mean Thermodynamic Force, i.e. the free energy gradient in 1D CV spaces.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>HILLS (str): HILLS array. Defaults to “HILLS”.
position (str): CV/position array. Defaults to “position”.
bw (float, optional): bandwidth for the construction of the KDE estimate of the biased probability density. Defaults to 1.
kT (float, optional): kT. Defaults to 1.
min_grid (int, optional): Lower bound of the force domain. Defaults to -2.
max_grid (int, optional): Upper bound of the force domain. Defaults to 2.
nbins (int, optional): number of bins in grid. Defaults to 101.
log_pace (int, optional): Pace for outputting progress and convergence. Defaults to 10.
error_pace (int, optional): Pace for the calculation of the on-the-fly measure of global convergence. Defaults to 200.
WellTempered (binary, optional): Is the simulation well tempered?. Defaults to 1.
periodic (int, optional): Is the CV space periodic? 1 for yes. Defaults to 0.
hp_center (float, optional): position of harmonic potential. Defaults to 0.0.
hp_kappa (int, optional): force_constant of harmonic potential. Defaults to 0.
lw_center (float, optional): position of lower wall potential. Defaults to 0.0.
lw_kappa (int, optional): force_constant of lower wall potential. Defaults to 0.
uw_center (float, optional): position of upper wall potential. Defaults to 0.0.
uw_kappa (int, optional): force_constant of upper wall potential. Defaults to 0.</p>
</dd>
<dt>Returns:</dt><dd><p>grid (array of size (1, nbins)): CV-array
Ftot_den (array of size (1, nbins)): Cumulative biased probability density
Ftot (array of size (1, nbins)): Mean Force
ofe (array of size (1, nbins)): on the fly estimate of the variance of the mean force
ofe_history (list of size (1, error_pace)): running estimate of the global on the fly variance of the mean force</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D_temp.MFI_1D_test">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D_temp.</span></span><span class="sig-name descname"><span class="pre">MFI_1D_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">HILLS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'HILLS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'position'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kT</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">201</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">WellTempered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nhills</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intermediate_fes_number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D_temp.MFI_1D_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a time-independent estimate of the Mean Thermodynamic Force, i.e. the free energy gradient in 1D CV spaces.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>HILLS (str): HILLS array. Defaults to “HILLS”.
position (str): CV/position array. Defaults to “position”.
bw (float, optional): bandwidth for the construction of the KDE estimate of the biased probability density. Defaults to 1.
kT (float, optional): kT. Defaults to 1.
min_grid (int, optional): Lower bound of the force domain. Defaults to -2.
max_grid (int, optional): Upper bound of the force domain. Defaults to 2.
nbins (int, optional): number of bins in grid. Defaults to 101.
log_pace (int, optional): Pace for outputting progress and convergence. Defaults to 10.
error_pace (int, optional): Pace for the calculation of the on-the-fly measure of global convergence. Defaults to 200.
WellTempered (binary, optional): Is the simulation well tempered?. Defaults to 1.
periodic (int, optional): Is the CV space periodic? 1 for yes. Defaults to 0.
hp_center (float, optional): position of harmonic potential. Defaults to 0.0.
hp_kappa (int, optional): force_constant of harmonic potential. Defaults to 0.
lw_center (float, optional): position of lower wall potential. Defaults to 0.0.
lw_kappa (int, optional): force_constant of lower wall potential. Defaults to 0.
uw_center (float, optional): position of upper wall potential. Defaults to 0.0.
uw_kappa (int, optional): force_constant of upper wall potential. Defaults to 0.</p>
</dd>
<dt>Returns:</dt><dd><p>grid (array of size (1, nbins)): CV-array
Ftot_den (array of size (1, nbins)): Cumulative biased probability density
Ftot (array of size (1, nbins)): Mean Force
ofe (array of size (1, nbins)): on the fly estimate of the variance of the mean force
ofe_history (list of size (1, error_pace)): running estimate of the global on the fly variance of the mean force</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D_temp.bootstrap_forw_back">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D_temp.</span></span><span class="sig-name descname"><span class="pre">bootstrap_forw_back</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forward_force</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backward_force</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bootstrap</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D_temp.bootstrap_forw_back" title="Permalink to this definition">¶</a></dt>
<dd><p>Algorithm to determine bootstrap error</p>
<dl class="simple">
<dt>Args:</dt><dd><p>grid (array): CV grid positions
forward_force (list): collection of force terms (n * [Ftot_den, Ftot]) from forward transition
backward_force (list): collection of force terms (n * [Ftot_den, Ftot]) from backward transition
n_bootstrap (int): bootstrap itterations</p>
</dd>
<dt>Returns:</dt><dd><p>[FES_avr, sd_fes, variance_prog, stdev_prog, var_fes_prog, sd_fes_prog ]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D_temp.find_hp_force">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D_temp.</span></span><span class="sig-name descname"><span class="pre">find_hp_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hp_center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D_temp.find_hp_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Find 1D harmonic potential force.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>hp_center (float): position of harmonic potential
hp_kappa (float): force_constant of harmonic potential
grid (array): CV grid positions
min_grid (float): minimum value of grid
max_grid (float): maximum value of grid
grid_space (float): space between two consecutive grid values
periodic (binary): information if system is periodic. value of 0 corresponds to non-periodic system. Value of 1 corresponds to periodic system.</p>
</dd>
<dt>Returns:</dt><dd><p>array: harmonic force array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D_temp.find_lw_force">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D_temp.</span></span><span class="sig-name descname"><span class="pre">find_lw_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lw_center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D_temp.find_lw_force" title="Permalink to this definition">¶</a></dt>
<dd><p>_summary_</p>
<dl class="simple">
<dt>Args:</dt><dd><p>lw_center (float): position of lower wall potential
lw_kappa (float): force_constant of lower wall potential
grid (array): CV grid positions
min_grid (float): minimum value of grid
max_grid (float): maximum value of grid
grid_space (float): space between two consecutive grid values
periodic (binary): information if system is periodic. value of 0 corresponds to non-periodic system. Value of 1 corresponds to periodic system.</p>
</dd>
<dt>Returns:</dt><dd><p>array: lower wall force array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D_temp.find_periodic_point">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D_temp.</span></span><span class="sig-name descname"><span class="pre">find_periodic_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_coord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D_temp.find_periodic_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds periodic copies of input coordinate.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>x_coord (float): CV-coordinate
min_grid (float): minimum value of grid
max_grid (float): maximum value of grid
periodic (binary): information if system is periodic. value of 0 corresponds to non-periodic system; function will only return input coordinates. Value of 1 corresponds to periodic system; function will return input coordinates with periodic copies.</p>
</dd>
<dt>Returns:</dt><dd><p>list: list of input coord and possibly periodic copies</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D_temp.find_uw_force">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D_temp.</span></span><span class="sig-name descname"><span class="pre">find_uw_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uw_center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D_temp.find_uw_force" title="Permalink to this definition">¶</a></dt>
<dd><p>_summary_</p>
<dl class="simple">
<dt>Args:</dt><dd><p>uw_center (float): position of upper wall potential
uw_kappa (float): force_constant of upper wall potential
grid (_type_): CV grid positions
min_grid (float): minimum value of grid
max_grid (float): maximum value of grid
grid_space (float): space between two consecutive grid values
periodic (binary): information if system is periodic. value of 0 corresponds to non-periodic system. Value of 1 corresponds to periodic system.</p>
</dd>
<dt>Returns:</dt><dd><p>array: upper wall force array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D_temp.index">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D_temp.</span></span><span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_space</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D_temp.index" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds (approximate) index of a position in a grid. Independent of CV-type.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>position (float): position of interest
min_grid (float): minimum value of grid
grid_space (float): grid spacing</p>
</dd>
<dt>Returns:</dt><dd><p>int: index of position</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D_temp.intg_1D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D_temp.</span></span><span class="sig-name descname"><span class="pre">intg_1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D_temp.intg_1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Integration of 1D gradient using finite difference method (simpson’s method).</p>
<dl class="simple">
<dt>Args:</dt><dd><p>x (array): grid
F (array): Mean force</p>
</dd>
<dt>Returns:</dt><dd><p>FES (array): Free energy surface</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D_temp.load_HILLS">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D_temp.</span></span><span class="sig-name descname"><span class="pre">load_HILLS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hills_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'HILLS'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D_temp.load_HILLS" title="Permalink to this definition">¶</a></dt>
<dd><p>Load 1-dimensional hills data (includes time, position_x, position_y, hills_parameters</p>
<dl class="simple">
<dt>Args:</dt><dd><p>hills_name (str, optional): Name of hills file. Defaults to “HILLS”.</p>
</dd>
<dt>Returns:</dt><dd><p>np.array: Array with hills data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D_temp.load_npy">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D_temp.</span></span><span class="sig-name descname"><span class="pre">load_npy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D_temp.load_npy" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads np.array of a file with .npy format</p>
<dl class="simple">
<dt>Args:</dt><dd><p>name (string): Name of file</p>
</dd>
<dt>Returns:</dt><dd><p>np.array: object to be loaded. Must be a numpy array.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D_temp.load_pkl">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D_temp.</span></span><span class="sig-name descname"><span class="pre">load_pkl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D_temp.load_pkl" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads list/array of a file with .pkl format</p>
<dl class="simple">
<dt>Args:</dt><dd><p>name (string): Name of file</p>
</dd>
<dt>Returns:</dt><dd><p>any: object to be loaded</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D_temp.load_position">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D_temp.</span></span><span class="sig-name descname"><span class="pre">load_position</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'position'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D_temp.load_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Load 1-dimensional position/trajectory data.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>position_name (str, optional): Name of position file. Defaults to “position”.</p>
</dd>
<dt>Returns:</dt><dd><p>position (list):  np.array with position data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D_temp.patch_forces">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D_temp.</span></span><span class="sig-name descname"><span class="pre">patch_forces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">force_vector</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D_temp.patch_forces" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in a collection of force and probability density and patches them.
Args:</p>
<blockquote>
<div><p>force_vector (list): collection of force terms (n * [Ftot_den, Ftot])</p>
</div></blockquote>
<dl class="simple">
<dt>Returns:</dt><dd><p>Patched probability density and mean forces (list) -&gt; ([Ftot_den, Ftot])</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D_temp.plot_recap">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D_temp.</span></span><span class="sig-name descname"><span class="pre">plot_recap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TOTAL_DENSITY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CONVMAP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CONV_history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D_temp.plot_recap" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot result of 1D MFI algorithm. 1. FES, 2. varinace_map, 3. Cumulative biased probability density, 4. Convergece of variance.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>X (array): gird
FES (array): Free energy surface
TOTAL_DENSITY (array): _description_
CONVMAP (array): Cumulative biased probability density
CONV_history (list): on the fly estimate of the local convergence
lim (int, optional): Upper energy value in FES plot. Defaults to 40.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D_temp.save_npy">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D_temp.</span></span><span class="sig-name descname"><span class="pre">save_npy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D_temp.save_npy" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves np.array in a file with .npy format</p>
<dl class="simple">
<dt>Args:</dt><dd><p>object (np.array): object to be saved. Must be a numpy array.
file_name (string): Name of file</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI1D_temp.save_pkl">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI1D_temp.</span></span><span class="sig-name descname"><span class="pre">save_pkl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI1D_temp.save_pkl" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves a list/array in a file with .pkl format</p>
<dl class="simple">
<dt>Args:</dt><dd><p>object (any): object to be saved
file_name (string): Name of file</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyMFI.MFI_dev_x_per_x_nonper">
<span id="pymfi-mfi-dev-x-per-x-nonper-module"></span><h2>pyMFI.MFI_dev_x_per_x_nonper module<a class="headerlink" href="#module-pyMFI.MFI_dev_x_per_x_nonper" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI_dev_x_per_x_nonper.FFT_intg_2D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI_dev_x_per_x_nonper.</span></span><span class="sig-name descname"><span class="pre">FFT_intg_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">FX</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([-</span> <span class="pre">3.14159265,</span> <span class="pre">-</span> <span class="pre">3.14159265])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([3.14159265,</span> <span class="pre">3.14159265])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI_dev_x_per_x_nonper.FFT_intg_2D" title="Permalink to this definition">¶</a></dt>
<dd><p>2D integration of force gradient (FX, FY) to find FES using Fast Fourier Transform.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>FX (array of size (nbins[0], nbins[1])): CV1 component of the Mean Force.
FY (array of size (nbins[0], nbins[1])): CV1 component of the Mean Force.
min_grid (array, optional): Lower bound of the simulation domain. Defaults to np.array((-np.pi, -np.pi)).
min_grid (array, optional): Upper bound of the simulation domain. Defaults to np.array((np.pi, np.pi)).
nbins (int, optional): number of bins in CV2,CV1. Defaults to 0. When nbins=0, nbins will take the shape of FX.</p>
</dd>
<dt>Returns:</dt><dd><p>X: array of size (nbins[0], nbins[1]) - CV1 meshgrid positions
Y: array of size (nbins[0], nbins[1]) - CV2 meshgrid positions
fes: array of size (nbins[0], nbins[1]) - Free Energy Surface</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI_dev_x_per_x_nonper.MFI_2D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI_dev_x_per_x_nonper.</span></span><span class="sig-name descname"><span class="pre">MFI_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">HILLS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'HILLS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'position_x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'position_y'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kT</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([-</span> <span class="pre">3.14159265,</span> <span class="pre">-</span> <span class="pre">3.14159265])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([3.14159265,</span> <span class="pre">3.14159265])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([200,</span> <span class="pre">200])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_terms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_corners</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">WellTempered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nhills</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_den_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_den_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_weighted_st_dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_centre_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_centre_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_centre_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_centre_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_centre_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_centre_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F_static_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">...,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span> <span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">...,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span> <span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">...,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span> <span class="pre">...,</span> <span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">...,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span> <span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">...,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span> <span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">...,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F_static_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([[0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">...,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span> <span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">...,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span> <span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">...,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span> <span class="pre">...,</span> <span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">...,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span> <span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">...,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span> <span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">...,</span> <span class="pre">0.,</span> <span class="pre">0.,</span> <span class="pre">0.]])</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI_dev_x_per_x_nonper.MFI_2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a time-independent estimate of the Mean Thermodynamic Force, i.e. the free energy gradient in 2D CV spaces.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>HILLS (str): HILLS array. Defaults to “HILLS”.
position_x (str): CV1 array. Defaults to “position_x”.
position_y (str): CV2 array. Defaults to “position_y”.
bw (int, optional): Scalar, bandwidth for the construction of the KDE estimate of the biased probability density. Defaults to 1.
kT (int, optional): Scalar, kT. Defaults to 1.
min_grid (array, optional): Lower bound of the force domain. Defaults to np.array((-np.pi, -np.pi)).
max_grid (array, optional): Upper bound of the force domain. Defaults to np.array((np.pi, np.pi)).
nbins (array, optional): number of bins in CV1,CV2. Defaults to np.array((200,200)).
log_pace (int, optional): Progress and convergence are outputted every log_pace steps. Defaults to 10.
error_pace (int, optional): Pace for the calculation of the on-the-fly measure of global convergence. Defaults to 1, change it to a higher value if FES_cutoff&gt;0 is used. 
base_terms (int or list, optional): When set to 0, inactive. When activated, “on the fly” variance is calculated as a patch to base (previous) simulation. To activate, put force terms of base simulation ([Ftot_den, Ftot_den2, Ftot_x, Ftot_y, ofv_x, ofv_y]). Defaults to 0.
window_corners (list, optional): When set to [], inactive. When activated, error is ALSO calculated for mean force in the window. To activate, put the min and max values of the window ([min_x, max_x, min_y, max_y]). Defaults to [].
WellTempered (binary, optional): Is the simulation well tempered? . Defaults to 1.
nhills (int, optional): Number of HILLS to analyse, -1 for the entire HILLS array. Defaults to -1, i.e. the entire dataset.
periodic (int, optional): Is the CV space periodic? 1 for yes. Defaults to 0.
FES_cutoff (float, optional): Cutoff applied to FES and error calculation for FES values over the FES_cutoff. Defaults to -1. When FES_cutoff = 0, no cufoff is applied. Use with care, computing the fes in the loop renders the calculation extremely slow.
FFT_integration (binary, optional): Specifies if integration method. If set to 1, it will be done with the Fast Fourier Transform (FFT) algorithm. FFT integration is a fast integration algorithms, especially for higher dimensions, however it requires a sqmetric system. When set to 0, a finite difference integration algorithm will be used. Default is set to 0.
Ftot_den_limit (float, optional): Probability density limit below which data will be set to zero (this is done for numerical stability reasons. For default Ftot_den_limit, numerical difference is negligable). Defaults to 1E-10.
Ftot_den_cutoff (int, optional): Cutoff applied to FES and error calculation for Ftot_den (Probability density) values below the Ftot_den_cutoff. All FES values that are excluded by the cutoff won’t contribuite towards the error. Useful when low probability density values have little statistical significance or no physical meaning. When Ftot_den_cutoff = 0, no cufoff is applied. Defaults to 0. 
hp_centre_x (float, optional): CV1-position of harmonic potential. Defaults to 0.0.
hp_centre_y (float, optional): CV2-position of harmonic potential. Defaults to 0.0.
hp_kappa_x (int, optional): CV1-force_constant of harmonic potential. Defaults to 0.
hp_kappa_y (int, optional): CV2-force_constant of harmonic potential. Defaults to 0.
lw_centre_x (float, optional): CV1-position of lower wall potential. Defaults to 0.0.
lw_centre_y (float, optional): CV2-position of lower wall potential. Defaults to 0.0.
lw_kappa_x (int, optional): CV1-force_constant of lower wall potential. Defaults to 0.
lw_kappa_y (int, optional): CV2-force_constant of lower wall potential. Defaults to 0.
uw_centre_x (float, optional): CV1-position of upper wall potential. Defaults to 0.0.
uw_centre_y (float, optional): CV2-position of upper wall potential. Defaults to 0.0.
uw_kappa_x (int, optional): CV1-force_constant of upper wall potential. Defaults to 0.
uw_kappa_y (int, optional): CV2-force_constant of upper wall potential. Defaults to 0.</p>
</dd>
</dl>
<p>F_static_x (array, optional): Option to provide a starting bias potential force in the CV1-direction that remains constant through the algorithm. This could be a harmonic potential, an previously used MetaD potential or any other bias potential defined on the grid. Defaults to np.zeros((123,96)), which will automatically set F_static to a zero-array with shape=(123,96).
F_static_y (array, optional): Option to provide a starting bias potential force in the CV2-direction that remains constant through the algorithm. This could be a harmonic potential, an previously used MetaD potential or any other bias potential defined on the grid. Defaults to np.zeros((123,96)), which will automatically set F_static to a zero-array with shape=(123,96).
use_weighted_st_dev (bool, optional): When set to True, the calculated error will be the weighted standard deviation ( var^0.5 ). When set to False, the calculated error will be the standard error ( (var/n_sample)^0.5 ). Defaults to True. (The standard devaition is expected to converge after enough time, while the standard error is expected to decrease as more datapoints are added.)</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>X: array of size (nbins[0], nbins[1]) - CV1 grid positions
Y: array of size (nbins[0], nbins[1]) - CV2 grid positions
Ftot_den: array of size (nbins[0], nbins[1]) - Cumulative biased probability density, equivalent to an unbiased histogram of samples in CV space.
Ftot_x:  array of size (nbins[0], nbins[1]) - CV1 component of the Mean Force.
Ftot_y:  array of size (nbins[0], nbins[1]) - CV2 component of the Mean Force.
ofe:  array of size (nbins[0], nbins[1]) - on the fly estimate of the local convergence
ofe_history: array of size (1, total_number_of_hills) - running estimate of the global convergence of the mean force.
(option with window corner activated: ofe_history_window: array of size (1, total_number_of_hills) - running estimate of the “window” convergence of the mean force.)
ofe_history_time: array of size (1, total_number_of_hills) - time array of ofe_history
Ftot_den2: array of size (nbins[0], nbins[1]) - Cumulative squared biased probability density
ofv_x: array of size (nbins[0], nbins[1]) - intermediate component in the calculation of the CV1 “on the fly variance” ( sum of: pb_t * dfds_x ** 2)
ofv_y: array of size (nbins[0], nbins[1]) - intermediate component in the calculation of the CV2 “on the fly variance” ( sum of: pb_t * dfds_y ** 2)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI_dev_x_per_x_nonper.bootstrap_2D_new">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI_dev_x_per_x_nonper.</span></span><span class="sig-name descname"><span class="pre">bootstrap_2D_new</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bootstrap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI_dev_x_per_x_nonper.bootstrap_2D_new" title="Permalink to this definition">¶</a></dt>
<dd><p>Algorithm to determine bootstrap error of FES. Takes in a list of force terms, and with each bootstrap itteration random force terms are picked, patched together and the FES is determinded. Over the itterations, the a standard deviation map and the averaged st.dev. is computed. When all iterations are completed, the average of all FESs, the final averaged st.dev. map and the progression of the averaged st.dev. is returned.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>X: array of size (nbins[0], nbins[1]): CV1 grid positions
Y: array of size (nbins[0], nbins[1]): CV2 grid positions
forces_all (list): collection of force terms (n * [Ftot_den, Ftot_x, Ftot_y])
n_bootstrap (int): bootstrap iterations
FES_cutoff (float): Only st.dev. values that correspond to a FES value below the FES_cutoff will be considered, while the others will just be turned to zero. Default FES_cutoff is 0, and no cutoff is applied.        
periodic (bool): Will specify if the system is periodic (periodic=1) or non-periodic (periodic=0). This is relevant to choose the appropiate integration method. Default is set to zero (non-periodic).
log_pace (int): Specifies the pace at which the average st.dev is printed. With a value of 100, st.dev is printed is printed every 100 iterations. With a value of 0, st.dev is printed is only printed at the end. With a value of -1, it will be printed 5 times in total. Default is set to 0.</p>
</dd>
<dt>Returns:</dt><dd><p>FES_avr: array of size (nbins[0], nbins[1]) - Average of all FES calculated. The minima will be set automatically to zero.
sd_fes: array of size (nbins[0], nbins[1]) - Standard deviation map of all FES generated.
sd_fes_prog: array of size (n_bootstrap,) - Array of the average st.dev. calculated at each iteration.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI_dev_x_per_x_nonper.find_hp_force">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI_dev_x_per_x_nonper.</span></span><span class="sig-name descname"><span class="pre">find_hp_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hp_centre_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_centre_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic_y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI_dev_x_per_x_nonper.find_hp_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Find 2D harmonic potential force.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>hp_centre_x (float): CV1-position of harmonic potential
hp_centre_y (float): CV2-position of harmonic potential
hp_kappa_x (float): CV1-force_constant of harmonic potential
hp_kappa_y (float): CV2-force_constant of harmonic potential
X (array): 2D array of CV1 grid positions
Y (array): 2D array of CV2 grid positions
min_grid (list): list of CV1-minimum value of grid and CV2-minimum value of grid
max_grid (list): list of CV1-maximum value of grid and CV2-maximum value of grid
grid_space (list): list of CV1-grid spacing and CV2-grid spacing
periodic (binary): information if system is periodic. value of 0 corresponds to non-periodic system. Value of 1 corresponds to periodic system.</p>
</dd>
<dt>Returns:</dt><dd><p>F_harmonic_x (array): harmonic force in CV1 direction.
F_harmonic_y (array): harmonic force in CV2 direction.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI_dev_x_per_x_nonper.find_lw_force">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI_dev_x_per_x_nonper.</span></span><span class="sig-name descname"><span class="pre">find_lw_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lw_centre_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_centre_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic_y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI_dev_x_per_x_nonper.find_lw_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Find lower half of 2D harmonic potential force equivalent to f = 2 * lw_kappa * (grid - lw_centre) for grid &lt; lw_centre and f = 0 otherwise. This can change for periodic cases.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>lw_centre_x (float): CV1-position of lower wall potential
lw_centre_y (float): CV2-position of lower wall potential
lw_kappa_x (float): CV1-force_constant of lower wall potential
lw_kappa_y (float): CV2-force_constant of lower wall potential
X (array): 2D array of CV1 grid positions
Y (array): 2D array of CV2 grid positions
min_grid (list): list of CV1-minimum value of grid and CV2-minimum value of grid
max_grid (list): list of CV1-maximum value of grid and CV2-maximum value of grid
grid_space (list): list of CV1-grid spacing and CV2-grid spacing
periodic (binary): information if system is periodic. value of 0 corresponds to non-periodic system. Value of 1 corresponds to periodic system.</p>
</dd>
<dt>Returns:</dt><dd><p>F_wall_x (array): lower wall potential force in CV1 direction.
F_wall_y (array): lower wall potential force in CV2 direction.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI_dev_x_per_x_nonper.find_periodic_point">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI_dev_x_per_x_nonper.</span></span><span class="sig-name descname"><span class="pre">find_periodic_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_coord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_coord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic_y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI_dev_x_per_x_nonper.find_periodic_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds periodic copies of input coordinates. First checks if systems is periodic. If not, returns input coordinate array. Next, it checks if each coordinate is within the boundary range (grid min/max +/- grid_ext). If it is, periodic copies will be made on the other side of the CV-domain.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>x_coord (float): CV1-coordinate
y_coord (float): CV2-coordinate
min_grid (list): list of CV1-minimum value of grid and CV2-minimum value of grid
max_grid (list): list of CV1-maximum value of grid and CV2-maximum value of grid
periodic_x (binary): Specifies if CV1 is periodic. value of 0 corresponds to non-periodic CV1; function will only return input coordinates. Value of 1 corresponds to periodic CV1; function will return input coordinates with periodic copies if appilcable.
periodic_y (binary): Specifies if CV2 is periodic. value of 0 corresponds to non-periodic CV2; function will only return input coordinates. Value of 1 corresponds to periodic CV2; function will return input coordinates with periodic copies if appilcable.</p>
</dd>
<dt>Returns:</dt><dd><p>list: list of [x-coord, y-coord] pairs</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI_dev_x_per_x_nonper.find_uw_force">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI_dev_x_per_x_nonper.</span></span><span class="sig-name descname"><span class="pre">find_uw_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uw_centre_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_centre_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic_y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI_dev_x_per_x_nonper.find_uw_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Find upper half of 2D harmonic potential force equivalent to f = 2 * uw_kappa * (grid - uw_centre) for grid &gt; uw_centre and f = 0 otherwise. This can change for periodic cases.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>lw_centre_x (float): CV1-position of upper wall potential
lw_centre_y (float): CV2-position of upper wall potential
lw_kappa_x (float): CV1-force_constant of upper wall potential
lw_kappa_y (float): CV2-force_constant of upper wall potential
X (array): 2D array of CV1 grid positions
Y (array): 2D array of CV2 grid positions
min_grid (list): list of CV1-minimum value of grid and CV2-minimum value of grid
max_grid (list): list of CV1-maximum value of grid and CV2-maximum value of grid
grid_space (list): list of CV1-grid spacing and CV2-grid spacing
periodic (binary): information if system is periodic. value of 0 corresponds to non-periodic system. Value of 1 corresponds to periodic system.</p>
</dd>
<dt>Returns:</dt><dd><p>F_wall_x (array): upper wall potential force in CV1 direction.
F_wall_y (array): upper wall potential force in CV2 direction.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI_dev_x_per_x_nonper.index">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI_dev_x_per_x_nonper.</span></span><span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_space</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI_dev_x_per_x_nonper.index" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds (approximate) index of a position in a grid. Independent of CV-type.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>position (float): position of interest
min_grid (float): minimum value of grid
grid_space (float): grid spacing</p>
</dd>
<dt>Returns:</dt><dd><p>int: index of position</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI_dev_x_per_x_nonper.intg_2D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI_dev_x_per_x_nonper.</span></span><span class="sig-name descname"><span class="pre">intg_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">FX</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([-</span> <span class="pre">3.14159265,</span> <span class="pre">-</span> <span class="pre">3.14159265])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([3.14159265,</span> <span class="pre">3.14159265])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([200,</span> <span class="pre">200])</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI_dev_x_per_x_nonper.intg_2D" title="Permalink to this definition">¶</a></dt>
<dd><p>2D integration of force gradient (FX, FY) to find FES using finite difference method.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>FX (array of size (nbins[0], nbins[1])): CV1 component of the Mean Force.
FY (array of size (nbins[0], nbins[1])): CV2 component of the Mean Force.
min_grid (array, optional): Lower bound of the simulation domain. Defaults to np.array((-np.pi, -np.pi)).
min_grid (array, optional): Upper bound of the simulation domain. Defaults to np.array((np.pi, np.pi)).
nbins (array of shape (2,), optional): number of bins in CV1,CV2. Defaults to np.array((200,200)).</p>
</dd>
<dt>Returns:</dt><dd><p>X: array of size (nbins[0], nbins[1]) - CV1 grid positions
Y: array of size (nbins[0], nbins[1]) - CV2 grid positions
fes: array of size (nbins[0], nbins[1]) - Free Energy Surface</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI_dev_x_per_x_nonper.intg_FD8">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI_dev_x_per_x_nonper.</span></span><span class="sig-name descname"><span class="pre">intg_FD8</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">FX</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0,</span> <span class="pre">0])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([3,</span> <span class="pre">3])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([201,</span> <span class="pre">201])</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI_dev_x_per_x_nonper.intg_FD8" title="Permalink to this definition">¶</a></dt>
<dd><p>Alternative integrtion method. More comoputational intense finite difference method. Might be usefull when other methods don’t seem to work. 
This method is doing 8 finite difference integrations, where each of the 8 is taking a different integration path. All 8 integrals are averaged into the final integral.</p>
<blockquote>
<div><dl class="simple">
<dt>Args:</dt><dd><p>FX (array of size (nbins[0], nbins[1])): CV1 component of the Mean Force.
FY (array of size (nbins[0], nbins[1])): CV2 component of the Mean Force.
min_grid (array, optional): Lower bound of the simulation domain. Defaults to np.array((0, 0)).
min_grid (array, optional): Upper bound of the simulation domain. Defaults to np.array((3, 3)).
nbins (int, optional): number of bins in CV1,CV2. Defaults to np.array((200,200)).</p>
</dd>
<dt>Returns:</dt><dd><p>X: array of size (nbins[0], nbins[1]) - CV1 grid positions
Y: array of size (nbins[0], nbins[1]) - CV2 grid positions
FES_a: array of size (nbins[0], nbins[1]) - (Average) Free Energy Surface</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI_dev_x_per_x_nonper.intgrad2">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI_dev_x_per_x_nonper.</span></span><span class="sig-name descname"><span class="pre">intgrad2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ny</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intconst</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">per1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">per2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([-</span> <span class="pre">2,</span> <span class="pre">-</span> <span class="pre">2])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([2,</span> <span class="pre">2])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI_dev_x_per_x_nonper.intgrad2" title="Permalink to this definition">¶</a></dt>
<dd><p>This function uses the inverse of the gradient to reconstruct the free energy surface from the mean force components.
[John D’Errico (2022). Inverse (integrated) gradient (<a class="reference external" href="https://www.mathworks.com/matlabcentral/fileexchange/9734-inverse-integrated-gradient">https://www.mathworks.com/matlabcentral/fileexchange/9734-inverse-integrated-gradient</a>), MATLAB Central File Exchange. Retrieved May 17, 2022.]
[Translated from MatLab to Python by Francesco Serse (<a class="reference external" href="https://github.com/Fserse">https://github.com/Fserse</a>)]</p>
<dl class="simple">
<dt>Args:</dt><dd><p>fx (array): (ny by nx) array. X-gradient to be integrated.
fy (array): (ny by nx) array. X-gradient to be integrated.
nx (integer): nuber of datapoints in x-direction. Default to 0: will copy the shape of the input gradient.
ny (integer): nuber of datapoints in y-direction. Default to 0: will copy the shape of the input gradient.
intconst (float): Minimum value of output FES
per1 (boolean): True if x-variable is periodic. False if non-periodic.
per2 (boolean): True if y-variable is periodic. False if non-periodic
min_grid (list/array of length=2): list/array of minimum value of [x-grid, y-grid]
max_grid (list/array of length=2):  list/array of maximum value of [x-grid, y-grid]
nbins (list/array of length=2): list/array of number of data pointis of [x-grid, y-grid]. Default to 0: will copy the shape of the input gradient.</p>
</dd>
<dt>Returns:</dt><dd><p>X (ny by nx array): X-component of meshgrid
Y (ny by nx array): Y-component of meshgrid
fhat (ny by nx array): integrated free energy surface</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI_dev_x_per_x_nonper.load_HILLS_2D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI_dev_x_per_x_nonper.</span></span><span class="sig-name descname"><span class="pre">load_HILLS_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hills_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'HILLS'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI_dev_x_per_x_nonper.load_HILLS_2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Load 2-dimensional hills data (includes time, position_x, position_y, hills_parameters ).</p>
<dl class="simple">
<dt>Args:</dt><dd><p>hills_name (str, optional): Name of hills file. Defaults to “HILLS”.</p>
</dd>
<dt>Returns:</dt><dd><p>np.array: Array with hills data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI_dev_x_per_x_nonper.load_npy">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI_dev_x_per_x_nonper.</span></span><span class="sig-name descname"><span class="pre">load_npy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI_dev_x_per_x_nonper.load_npy" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads np.array of a file with .npy format</p>
<dl class="simple">
<dt>Args:</dt><dd><p>name (string): Name of file</p>
</dd>
<dt>Returns:</dt><dd><p>np.array: object to be loaded. Must be a numpy array.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI_dev_x_per_x_nonper.load_pkl">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI_dev_x_per_x_nonper.</span></span><span class="sig-name descname"><span class="pre">load_pkl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI_dev_x_per_x_nonper.load_pkl" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads list/array of a file with .pkl format</p>
<dl class="simple">
<dt>Args:</dt><dd><p>name (string): Name of file</p>
</dd>
<dt>Returns:</dt><dd><p>any: object to be loaded</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI_dev_x_per_x_nonper.load_position_2D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI_dev_x_per_x_nonper.</span></span><span class="sig-name descname"><span class="pre">load_position_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'position'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI_dev_x_per_x_nonper.load_position_2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Load 2-dimensional position/trajectory data.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>position_name (str, optional): Name of position file. Defaults to “position”.</p>
</dd>
<dt>Returns:</dt><dd><p>list: 2 * np.array with position data of each dimension ([position_x, position_y])</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI_dev_x_per_x_nonper.mean_force_variance">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI_dev_x_per_x_nonper.</span></span><span class="sig-name descname"><span class="pre">mean_force_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ftot_den</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_den2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ofv_num_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ofv_num_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_weighted_st_dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI_dev_x_per_x_nonper.mean_force_variance" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the weighted variance of the mean force and the weighted standard devaition of the mean force. First calculates the variance and st.dev. of the force in CV1 space and CV2 space seperately, then computes the modulus of the two.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>Ftot_den (array of size (nbins[0], nbins[1])): Cumulative biased probability density
25Ftot_den2 (array of size (nbins[0], nbins[1])):  Cumulative squared biased probability density
Ftot_x (array of size (nbins[0], nbins[1])): CV1 component of the Mean Force.
Ftot_y (array of size (nbins[0], nbins[1])): CV2 component of the Mean Force.
ofv_num_x (array of size (nbins[0], nbins[1])): intermediate component in the calculation of the CV1 “on the fly variance” ( sum of: pb_t * dfds_x ** 2)
ofv_num_y (array of size (nbins[0], nbins[1])): intermediate component in the calculation of the CV2 “on the fly variance” ( sum of: pb_t * dfds_y ** 2)
Ftot_den_limit (scalar): threshold in the cumulative biased probability density where data is discarded. Defaults to 0.</p>
</dd>
<dt>Returns:</dt><dd><p>ofv (array of size (nbins[0], nbins[1])): “on-the-fly” variance. Modulus of “on-the-fly variance” in CV1 space and CV2 space.
ofe (array of size (nbins[0], nbins[1])): “on-the-fly” error (standard devaition). Modulus of “on-the-fly variance” in CV1 space and CV2 space.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI_dev_x_per_x_nonper.patch_2D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI_dev_x_per_x_nonper.</span></span><span class="sig-name descname"><span class="pre">patch_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">master_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([200,</span> <span class="pre">200])</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI_dev_x_per_x_nonper.patch_2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in a collection of force terms and patches them togehter to return the patched force terms</p>
<dl class="simple">
<dt>Args:</dt><dd><p>master_array (list): collection of force terms (n * [Ftot_den, Ftot_den2, Ftot_x, Ftot_y, ofv_x, ofv_y])
nbins (array, optional): number of bins in CV1,CV2. Defaults to np.array((200,200)).</p>
</dd>
<dt>Returns:</dt><dd><p>Patched force terms (list) -&gt; ([Ftot_den, Ftot_den2, Ftot_x, Ftot_y, ofv_x, ofv_y])</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI_dev_x_per_x_nonper.patch_2D_simple">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI_dev_x_per_x_nonper.</span></span><span class="sig-name descname"><span class="pre">patch_2D_simple</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">master_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([200,</span> <span class="pre">200])</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI_dev_x_per_x_nonper.patch_2D_simple" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in a collection of force and patches only the probability density and mean forces</p>
<dl class="simple">
<dt>Args:</dt><dd><p>master_array (list): collection of force terms (n * [X, Y, Ftot_den, Ftot_x, Ftot_y])
nbins (array, optional): number of bins in CV1,CV2. Defaults to np.array((200,200)).</p>
</dd>
<dt>Returns:</dt><dd><p>Patched probability density and mean forces (list) -&gt; ([Ftot_den, Ftot_x, Ftot_y])</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI_dev_x_per_x_nonper.patch_to_base_variance">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI_dev_x_per_x_nonper.</span></span><span class="sig-name descname"><span class="pre">patch_to_base_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">master0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">master</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot_den_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_weighted_st_dev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI_dev_x_per_x_nonper.patch_to_base_variance" title="Permalink to this definition">¶</a></dt>
<dd><p>Patches force terms of a base simulation (alaysed prior to current simulation) with current simulation to return patched “on the fly variance”.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>master0 (list): Force terms of base simulation (alaysed prior to current simulation) [Ftot_den, Ftot_den2, Ftot_x, Ftot_y, ofv_num_x, ofv_num_y]
master (list): Force terms of current simulation [Ftot_den, Ftot_den2, Ftot_x, Ftot_y, ofv_num_x, ofv_num_y]
Ftot_den_limit (float): Truncates the probability density below Ftot_den_limit. Default set to 1E-10.</p>
</dd>
</dl>
<p>use_weighted_st_dev (bool, optional): When set to True, the calculated error will be the weighted standard deviation ( var^0.5 ). When set to False, the calculated error will be the standard error ( (var/n_sample)^0.5 ). Defaults to True. (The standard devaition is expected to converge after enough time, while the standard error is expected to decrease as more datapoints are added.)</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>OFV (array of size (nbins[0], nbins[1])): modulus of patched “on the fly variance”</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI_dev_x_per_x_nonper.plot_bootstrap">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI_dev_x_per_x_nonper.</span></span><span class="sig-name descname"><span class="pre">plot_bootstrap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sd_fes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sd_fes_prog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ofe_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ofe_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI_dev_x_per_x_nonper.plot_bootstrap" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots result of bootstrap analysis. 1. Average FES, 2. average varinace, 3. variance progression</p>
<dl class="simple">
<dt>Args:</dt><dd><p>X: array of size (nbins[0], nbins[1]) - CV1 grid positions
Y: array of size (nbins[0], nbins[1]) - CV2 grid positions
FES: array of size (nbins[0], nbins[1]) - Free Energy Surface
var_fes (array of size (nbins[0], nbins[1])): _description_
var_fes_prog (list): _description_
FES_lim (int, optional): Upper energy limit of FES plot. Defaults to 11.
ofe_map_lim (int, optional): Upper variance limit of variance plot. Defaults to 11.</p>
</dd>
<dt>Returns:</dt><dd><p>(Plot)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI_dev_x_per_x_nonper.plot_patch_2D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI_dev_x_per_x_nonper.</span></span><span class="sig-name descname"><span class="pre">plot_patch_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TOTAL_DENSITY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI_dev_x_per_x_nonper.plot_patch_2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots 1. FES, 2. Cumulative biased probability density</p>
<dl class="simple">
<dt>Args:</dt><dd><p>X: array of size (nbins[0], nbins[1]) - CV1 grid positions
Y: array of size (nbins[0], nbins[1]) - CV2 grid positions
FES: array of size (nbins[0], nbins[1]) - Free Energy Surface
TOTAL_DENSITY: array of size (nbins[0], nbins[1]) - Cumulative biased probability density</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI_dev_x_per_x_nonper.plot_recap_2D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI_dev_x_per_x_nonper.</span></span><span class="sig-name descname"><span class="pre">plot_recap_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TOTAL_DENSITY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CONVMAP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CONV_history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CONV_history_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ofe_map_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ofe_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI_dev_x_per_x_nonper.plot_recap_2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots 1. FES, 2. varinace_map, 3. Cumulative biased probability density, 4. Convergece of variance.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>X: array of size (nbins[0], nbins[1]) - CV1 grid positions
Y: array of size (nbins[0], nbins[1]) - CV2 grid positions
FES: array of size (nbins[0], nbins[1]) - Free Energy Surface
TOTAL_DENSITY: array of size (nbins[0], nbins[1]) - Cumulative biased probability density
CONVMAP (array of size (nbins[0], nbins[1])): varinace_map
CONV_history (list): Convergece of variance</p>
</dd>
<dt>Returns: </dt><dd><p>Plot 1: FES.
Plot 2: Error Map.
Plot 3: Probability density map.
Plot 4: Error progression for measure of convergence.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI_dev_x_per_x_nonper.reduce_to_window">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI_dev_x_per_x_nonper.</span></span><span class="sig-name descname"><span class="pre">reduce_to_window</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI_dev_x_per_x_nonper.reduce_to_window" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduces an 2D input array to a specified range (or a window of the CV).</p>
<dl class="simple">
<dt>Args:</dt><dd><p>input_array (array): 2D array to be reduced
min_grid (list): list of CV1-minimum value of grid and CV2-minimum value of grid
grid_space (list): list of CV1-grid spacing and CV2-grid spacing
x_min (float, optional): lower CV1-value of output array. Defaults to -0.5.
x_max (float, optional): upper CV1-value of output array. Defaults to 0.5.
y_min (float, optional): lower CV2-value of output array. Defaults to -1.5.
y_max (float, optional): upper CV2-value of output array. Defaults to 1.5.</p>
</dd>
<dt>Returns:</dt><dd><p>array: reduced array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI_dev_x_per_x_nonper.save_npy">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI_dev_x_per_x_nonper.</span></span><span class="sig-name descname"><span class="pre">save_npy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI_dev_x_per_x_nonper.save_npy" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves np.array in a file with .npy format</p>
<dl class="simple">
<dt>Args:</dt><dd><p>object (np.array): object to be saved. Must be a numpy array.
file_name (string): Name of file</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI_dev_x_per_x_nonper.save_pkl">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI_dev_x_per_x_nonper.</span></span><span class="sig-name descname"><span class="pre">save_pkl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI_dev_x_per_x_nonper.save_pkl" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves a list/array in a file with .pkl format</p>
<dl class="simple">
<dt>Args:</dt><dd><p>object (any): object to be saved
file_name (string): Name of file</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.MFI_dev_x_per_x_nonper.zero_to_nan">
<span class="sig-prename descclassname"><span class="pre">pyMFI.MFI_dev_x_per_x_nonper.</span></span><span class="sig-name descname"><span class="pre">zero_to_nan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_array</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.MFI_dev_x_per_x_nonper.zero_to_nan" title="Permalink to this definition">¶</a></dt>
<dd><p>Ruturns an array identical to the input array, but with all zero-values turned to np.nan. This could be useful for plotting arrays, where np.nan values won’t be shown.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>input_array (array or list (flexible shape)): This can be anything from FES to error map</p>
</dd>
<dt>Returns:</dt><dd><p>output_array (array with identical shape to input array): zero-values turned to np.nan</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyMFI.langevin">
<span id="pymfi-langevin-module"></span><h2>pyMFI.langevin module<a class="headerlink" href="#module-pyMFI.langevin" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.langevin.run_2D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.langevin.</span></span><span class="sig-name descname"><span class="pre">run_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biasfactor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ipos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([-</span> <span class="pre">1,</span> <span class="pre">-</span> <span class="pre">1])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.langevin.run_2D" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.langevin.run_2D_Invernizzi">
<span class="sig-prename descclassname"><span class="pre">pyMFI.langevin.</span></span><span class="sig-name descname"><span class="pre">run_2D_Invernizzi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biasfactor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ipos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([-</span> <span class="pre">1,</span> <span class="pre">-</span> <span class="pre">1])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.langevin.run_2D_Invernizzi" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-pyMFI.run_plumed">
<span id="pymfi-run-plumed-module"></span><h2>pyMFI.run_plumed module<a class="headerlink" href="#module-pyMFI.run_plumed" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.run_plumed.find_alanine_dipeptide_input">
<span class="sig-prename descclassname"><span class="pre">pyMFI.run_plumed.</span></span><span class="sig-name descname"><span class="pre">find_alanine_dipeptide_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_position_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_position_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_extension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.run_plumed.find_alanine_dipeptide_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepares the input file for a set of initial positions. 
Requires traj_comp.xtc file or similar (trajecory file of a simulation that already explored specified initial positions).
1 step: Find structures that are +- 0.5nm away from intial position.
2 step: Randomly choose one of the structures.
3 step: Produce input file for alanine dipeptide simulation.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>initial_position_x (float, optional): x-value of initial position of simulation. Defaults to 0.0.
initial_position_y (float, optional): y-value of initial position of simulation. Defaults to 0.0.
file_extension (str, optional): Adds an extension the the structure.gro and input.tpr file. E.g. file_extension=”_1” -&gt; structure_file=”structure_1.gro”. Defaults to “”.. Defaults to “”.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.run_plumed.make_external_bias_1D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.run_plumed.</span></span><span class="sig-name descname"><span class="pre">make_external_bias_1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FES</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ftot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_min_plumed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_max_plumed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins_plumed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name_extension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_array</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.run_plumed.make_external_bias_1D" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.run_plumed.run_2D_Invernizzi">
<span class="sig-prename descclassname"><span class="pre">pyMFI.run_plumed.</span></span><span class="sig-name descname"><span class="pre">run_2D_Invernizzi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simulation_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biasfactor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_position_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_position_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_centre_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_centre_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_centre_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_centre_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_centre_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_centre_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_extension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.run_plumed.run_2D_Invernizzi" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to run a langevin simulation (in 2D) on the Invernizzi potential. Analytical form is approx.: 1.35*x^4+1.90*x^3*y+3.93*x^2*y^2-6.44*x^2-1.90*x*y^3+5.59*x*y+1.33*x+1.35*y^4-5.56*y^2+0.90*y+18.56.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>simulation_steps (int, optional): Number of steps in simulation. Defaults to 100000.
sigma (float, optional): Gaussian width (sigma) in x-direction and y-direction of metadynamics bias. Defaults to 0.1.
height (float, optional): aussian height of metadynamics bias. Defaults to 0.5.
biasfactor (int, optional): Biasfactor of metadynamics bias. Defaults to 10.
initial_position_x (float, optional): x-value of initial position of simulation. Defaults to 0.0.
initial_position_y (float, optional): y-value of initial position of simulation. Defaults to 0.0.
hp_centre_x (float, optional): x-position of harmonic potential. Defaults to 0.0.
hp_centre_y (float, optional): y-position of harmonic potential. Defaults to 0.0.
hp_kappa_x (int, optional): x-force_constant of harmonic potential. Defaults to 0.
hp_kappa_y (int, optional): y-force_constant of harmonic potential. Defaults to 0.
lw_centre_x (float, optional): x-position of lower wall potential. Defaults to 0.0.
lw_centre_y (float, optional): y-position of lower wall potential. Defaults to 0.0.
lw_kappa_x (int, optional): x-force_constant of lower wall potential. Defaults to 0.
lw_kappa_y (int, optional): y-force_constant of lower wall potential. Defaults to 0.
uw_centre_x (float, optional): x-position of upper wall potential. Defaults to 0.0.
uw_centre_y (float, optional): y-position of upper wall potential. Defaults to 0.0.
uw_kappa_x (int, optional): x-force_constant of upper wall potential. Defaults to 0.
uw_kappa_y (int, optional): y-force_constant of upper wall potential. Defaults to 0.
gaus_pace (int, optional): Pace of deposition of metadynamics hills. Defaults to 500.
position_pace (int, optional): Pace of recording the CV in the position file. When position_pace=0, position_pace = gaus_pace/10. Defaults to 0.
file_extension (str, optional): Adds an extension the the position and HILLS file. E.g. file_extension=”_1” -&gt; position_file=”position_1”. Defaults to “”.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.run_plumed.run_alanine_dipeptide">
<span class="sig-prename descclassname"><span class="pre">pyMFI.run_plumed.</span></span><span class="sig-name descname"><span class="pre">run_alanine_dipeptide</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simulation_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.49</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_min_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-pi'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_max_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pi'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_min_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-pi'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_max_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pi'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_bin_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">201</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_bin_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">201</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_width_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_width_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biasfactor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_centre_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_centre_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_centre_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_centre_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_centre_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_centre_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_extension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.run_plumed.run_alanine_dipeptide" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to run molecular simulation on alanine dipeptide. Requires a reference.pdb and input.tpr file.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>simulation_steps (int): Number of steps in simulation
temperature (float, optional): Temperature of simulation (units in kT). Defaults to 2.49.
grid_min_x (str, optional): phi-value of minimum value of grid where the bias is stored. Defaults to “-pi”.
grid_max_x (str, optional): phi-value of maximum value of grid where the bias is stored. Defaults to “pi”.
grid_min_y (str, optional): psi-value of minimum value of grid where the bias is stored. Defaults to “-pi”.
grid_max_y (str, optional): psi-value of maximum value of grid where the bias is stored. Defaults to “pi”.
grid_bin_x (int, optional): Number of distinct bins in grid on phi-axis. Defaults to 201.
grid_bin_y (int, optional): Number of distinct bins in grid on psi-axis. Defaults to 201.
gaus_width_x (float, optional): Gaussian width in phi-direction (sigma) of metadynamics bias. Defaults to 0.1.
gaus_width_y (float, optional): Gaussian width in psi-direction (sigma) of metadynamics bias. Defaults to 0.1.
gaus_height (int, optional): Gaussian height of metadynamics bias. Defaults to 1.
biasfactor (int, optional): Biasfactor of metadynamics bias. Defaults to 10.
gaus_pace (int, optional): Pace of deposition of metadynamics hills. Defaults to 100.
position_pace (int, optional): Pace of recording the CV in the position file. When position_pace=0, position_pace = gaus_pace/10. Defaults to 0.
hp_centre_x (float, optional): phi-position of harmonic potential. Defaults to 0.0.
hp_centre_y (float, optional): psi-position of harmonic potential. Defaults to 0.0.
hp_kappa_x (int, optional): phi-force_constant of harmonic potential. Defaults to 0.
hp_kappa_y (int, optional): psi-force_constant of harmonic potential. Defaults to 0.
lw_centre_x (float, optional): phi-position of lower wall potential. Defaults to 0.0.
lw_centre_y (float, optional): psi-position of lower wall potential. Defaults to 0.0.
lw_kappa_x (int, optional): phi-force_constant of lower wall potential. Defaults to 0.
lw_kappa_y (int, optional): psi-force_constant of lower wall potential. Defaults to 0.
uw_centre_x (float, optional): phi-position of upper wall potential. Defaults to 0.0.
uw_centre_y (float, optional): psi-position of upper wall potential. Defaults to 0.0.
uw_kappa_x (int, optional): phi-force_constant of upper wall potential. Defaults to 0.
uw_kappa_y (int, optional): psi-force_constant of upper wall potential. Defaults to 0.
print_bias (int, optional): When print_bias=1, the experienced bias potential and the bias force squared is printed every 100 steps in a file called “restraint”. Defaults to 0.
file_extension (str, optional):Adds an extension the the position and HILLS file. E.g. file_extension=”_1” -&gt; position_file=”position_1”. Defaults to “”.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.run_plumed.run_alanine_dipeptide_1D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.run_plumed.</span></span><span class="sig-name descname"><span class="pre">run_alanine_dipeptide_1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simulation_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tors_angle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'phi'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.49</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-pi'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pi'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_bin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">301</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biasfactor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_centre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_centre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_centre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_extension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.run_plumed.run_alanine_dipeptide_1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to run molecular simulation on alanine dipeptide. Requires a reference.pdb and input.tpr file.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>simulation_steps (int): Number of steps in simulation
temperature (float, optional): Temperature of simulation (units in kT). Defaults to 2.49.
grid_min_x (str, optional): phi-value of minimum value of grid where the bias is stored. Defaults to “-pi”.
grid_max_x (str, optional): phi-value of maximum value of grid where the bias is stored. Defaults to “pi”.
grid_min_y (str, optional): psi-value of minimum value of grid where the bias is stored. Defaults to “-pi”.
grid_max_y (str, optional): psi-value of maximum value of grid where the bias is stored. Defaults to “pi”.
grid_bin_x (int, optional): Number of distinct bins in grid on phi-axis. Defaults to 201.
grid_bin_y (int, optional): Number of distinct bins in grid on psi-axis. Defaults to 201.
gaus_width_x (float, optional): Gaussian width in phi-direction (sigma) of metadynamics bias. Defaults to 0.1.
gaus_width_y (float, optional): Gaussian width in psi-direction (sigma) of metadynamics bias. Defaults to 0.1.
gaus_height (int, optional): Gaussian height of metadynamics bias. Defaults to 1.
biasfactor (int, optional): Biasfactor of metadynamics bias. Defaults to 10.
gaus_pace (int, optional): Pace of deposition of metadynamics hills. Defaults to 100.
position_pace (int, optional): Pace of recording the CV in the position file. When position_pace=0, position_pace = gaus_pace/10. Defaults to 0.
hp_centre_x (float, optional): phi-position of harmonic potential. Defaults to 0.0.
hp_centre_y (float, optional): psi-position of harmonic potential. Defaults to 0.0.
hp_kappa_x (int, optional): phi-force_constant of harmonic potential. Defaults to 0.
hp_kappa_y (int, optional): psi-force_constant of harmonic potential. Defaults to 0.
lw_centre_x (float, optional): phi-position of lower wall potential. Defaults to 0.0.
lw_centre_y (float, optional): psi-position of lower wall potential. Defaults to 0.0.
lw_kappa_x (int, optional): phi-force_constant of lower wall potential. Defaults to 0.
lw_kappa_y (int, optional): psi-force_constant of lower wall potential. Defaults to 0.
uw_centre_x (float, optional): phi-position of upper wall potential. Defaults to 0.0.
uw_centre_y (float, optional): psi-position of upper wall potential. Defaults to 0.0.
uw_kappa_x (int, optional): phi-force_constant of upper wall potential. Defaults to 0.
uw_kappa_y (int, optional): psi-force_constant of upper wall potential. Defaults to 0.
print_bias (int, optional): When print_bias=1, the experienced bias potential and the bias force squared is printed every 100 steps in a file called “restraint”. Defaults to 0.
file_extension (str, optional):Adds an extension the the position and HILLS file. E.g. file_extension=”_1” -&gt; position_file=”position_1”. Defaults to “”.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.run_plumed.run_langevin1D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.run_plumed.</span></span><span class="sig-name descname"><span class="pre">run_langevin1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simulation_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analytical_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'7*x^4-23*x^2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NO'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_bin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biasfactor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_centre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_centre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_centre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">external_bias_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.run_plumed.run_langevin1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to run a langevin simulation in 1 dimension. Default analytical potential: y = 7*x^4-23*x^2.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>simulation_steps (int): Number of steps in simulation
analytical_function (str, optional): The analytical function to be analysed. Defaults to “7*x^4-23*x^2”.
periodic_boundaries (str, optional): Information wheather boundary conditions are periodic (“ON”) or not (“NO”). Defaults to “NO”.
initial_position (float, optional): Initial position of simulation. Defaults to 0.0.
temperature (int, optional): Temperature of simulation (units in kT). Defaults to 1.
time_step (float, optional): Length of one time step (units in ps). Defaults to 0.005.
grid_min (float, optional): Minimum value of grid where the bias is stored. Defaults to -3.0.
grid_max (float, optional): Maximum value of grid where the bias is stored. Defaults to 3.0.
grid_bin (int, optional): Number of distinct bins in grid. Defaults to 200.
gaus_width (float, optional): Gaussian width (sigma) of metadynamics bias. Defaults to 0.1.
gaus_height (int, optional): Gaussian height of metadynamics bias. Defaults to 1.
biasfactor (int, optional): Biasfactor of metadynamics bias. Defaults to 10.
gaus_pace (int, optional): Pace of deposition of metadynamics hills. Defaults to 100.
position_pace (int, optional): Pace of recording the CV in the position file. When position_pace=0, position_pace = gaus_pace/10. Defaults to 0.
hp_centre (float, optional): position of harmonic potential. Defaults to 0.0.
hp_kappa (int, optional): force_constant of harmonic potential. Defaults to 0.
lw_centre (float, optional): position of lower wall potential. Defaults to 0.0.
lw_kappa (int, optional): force_constant of lower wall potential. Defaults to 0.
uw_centre (float, optional): position of upper wall potential. Defaults to 0.0.
uw_kappa (int, optional): force_constant of upper wall potential. Defaults to 0.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.run_plumed.run_langevin1D_plumed_fes">
<span class="sig-prename descclassname"><span class="pre">pyMFI.run_plumed.</span></span><span class="sig-name descname"><span class="pre">run_langevin1D_plumed_fes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simulation_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analytical_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'7*x^4-23*x^2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NO'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biasfactor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fes_stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_min_plumed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_max_plumed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_bin_plumed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">301</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_min_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_max_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_bin_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.run_plumed.run_langevin1D_plumed_fes" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to run a langevin simulation in 1 dimension on analytical potential: y = 7*x^4-23*x^2, while also calculating the FES through plumed.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>length (int): Number of steps in simulation
sigma (float, optional): Gaussian width of metadynamics bias. Defaults to 0.1.
height (float, optional): Gaussian height of metadynamics bias. Defaults to 0.1.
biasfactor (int, optional): Biasfactor of metadynamics bias. Defaults to 10.
fes_stride (int, optional): Number of times the intermediate fes is calculated. Defaults to 0.
grid_min (int, optional): Minimum value of grid where the bias is stored. Defaults to -3.
grid_max (int, optional): Maximum value of grid where the bias is stored. Defaults to 3.
grid_bin (int, optional): Number of distinct bins in grid. Defaults to 301.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyMFI.run_plumed.run_langevin2D">
<span class="sig-prename descclassname"><span class="pre">pyMFI.run_plumed.</span></span><span class="sig-name descname"><span class="pre">run_langevin2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simulation_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analytical_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'7*x^4-23*x^2+7*y^4-23*y^2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic_f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NO'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_position_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_position_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_min_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_max_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_min_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_max_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_bin_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_bin_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_width_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_width_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biasfactor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaus_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_centre_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_centre_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hp_kappa_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_centre_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_centre_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw_kappa_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_centre_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_centre_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uw_kappa_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_pace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_extension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyMFI.run_plumed.run_langevin2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to run a langevin simulation in 2 dimension. Default analytical potential: z = 7*x^4-23*x^2+7*y^4-23*y^2.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>simulation_steps (int): Number of steps in simulation
analytical_function (str, optional): The analytical function to be analysed. Defaults to “7*x^4-23*x^2+7*y^4-23*y^2”.
periodic_f (str, optional): Information wheather boundary conditions are periodic (“ON”) or not (“NO”). Defaults to “NO”.
initial_position_x (float, optional): x-value of initial position of simulation. Defaults to 0.0.
initial_position_y (float, optional): y-value of initial position of simulation. Defaults to 0.0.
temperature (int, optional): Temperature of simulation (units in kT). Defaults to 1.
time_step (float, optional): Length of one time step (units in ps). Defaults to 0.005.
grid_min_x (float, optional): x-value of minimum value of grid where the bias is stored. Defaults to -3.0.
grid_max_x (float, optional): x-value of maximum value of grid where the bias is stored. Defaults to 3.0.
grid_min_y (float, optional): y-value of minimum value of grid where the bias is stored. Defaults to -3.0.
grid_max_y (float, optional): y-value of maximum value of grid where the bias is stored. Defaults to 3.0.
grid_bin_x (int, optional): Number of distinct bins in grid on x-axis. Defaults to 200.
grid_bin_y (int, optional): Number of distinct bins in grid on y-axis. Defaults to 200.
gaus_width_x (float, optional): Gaussian width in x-direction (sigma) of metadynamics bias. Defaults to 0.1.
gaus_width_y (float, optional): Gaussian width in y-direction (sigma) of metadynamics bias. Defaults to 0.1.
gaus_height (int, optional): Gaussian height of metadynamics bias. Defaults to 1.
biasfactor (int, optional): Biasfactor of metadynamics bias. Defaults to 10.
gaus_pace (int, optional): Pace of deposition of metadynamics hills. Defaults to 100.
hp_centre_x (float, optional): x-position of harmonic potential. Defaults to 0.0.
hp_centre_y (float, optional): y-position of harmonic potential. Defaults to 0.0.
hp_kappa_x (int, optional): x-force_constant of harmonic potential. Defaults to 0.
hp_kappa_y (int, optional): y-force_constant of harmonic potential. Defaults to 0.
lw_centre_x (float, optional): x-position of lower wall potential. Defaults to 0.0.
lw_centre_y (float, optional): y-position of lower wall potential. Defaults to 0.0.
lw_kappa_x (int, optional): x-force_constant of lower wall potential. Defaults to 0.
lw_kappa_y (int, optional): y-force_constant of lower wall potential. Defaults to 0.
uw_centre_x (float, optional): x-position of upper wall potential. Defaults to 0.0.
uw_centre_y (float, optional): y-position of upper wall potential. Defaults to 0.0.
uw_kappa_x (int, optional): x-force_constant of upper wall potential. Defaults to 0.
uw_kappa_y (int, optional): y-force_constant of upper wall potential. Defaults to 0.
position_pace (int, optional): Pace of recording the CV in the position file. When position_pace=0, position_pace = gaus_pace/10. Defaults to 0.
file_extension (str, optional): Adds an extension the the position and HILLS file. E.g. file_extension=”_1” -&gt; position_file=”position_1”. Defaults to “”.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyMFI">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyMFI" title="Permalink to this heading">¶</a></h2>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">pyMFI package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-pyMFI.MFI">pyMFI.MFI module</a></li>
<li><a class="reference internal" href="#module-pyMFI.MFI1D">pyMFI.MFI1D module</a></li>
<li><a class="reference internal" href="#module-pyMFI.MFI1D_temp">pyMFI.MFI1D_temp module</a></li>
<li><a class="reference internal" href="#module-pyMFI.MFI_dev_x_per_x_nonper">pyMFI.MFI_dev_x_per_x_nonper module</a></li>
<li><a class="reference internal" href="#module-pyMFI.langevin">pyMFI.langevin module</a></li>
<li><a class="reference internal" href="#module-pyMFI.run_plumed">pyMFI.run_plumed module</a></li>
<li><a class="reference internal" href="#module-pyMFI">Module contents</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="modules.html"
                          title="previous chapter">pyMFI</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/pyMFI.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="modules.html" title="pyMFI"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">MFI documentation Sep 2023 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="modules.html" >pyMFI</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">pyMFI package</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2023, Antoniu Bjola.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.0.2.
    </div>
  </body>
</html>